/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => hackmdPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// sharer.ts
var import_obsidian = require("obsidian");
var shareNote = (key, content, permission) => {
  const data = JSON.stringify({
    "content": content,
    "writePermission": permission.writePermission,
    "commentPermission": permission.commentPermission,
    "readPermission": permission.readPermission
  });
  const requestParams = {
    method: "post",
    url: "https://api.hackmd.io/v1/notes",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + key,
      "Cookie": "locale=dev"
    },
    body: data
  };
  return (0, import_obsidian.requestUrl)(requestParams);
};
var updataNote = (key, content, id) => {
  const data = JSON.stringify({
    "content": content
  });
  const requestParams = {
    method: "patch",
    url: "https://api.hackmd.io/v1/notes/" + id,
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + key,
      "Cookie": "locale=dev"
    },
    body: data
  };
  return (0, import_obsidian.requestUrl)(requestParams);
};
var getNote = (key, id) => {
  const requestParams = {
    method: "get",
    url: "https://api.hackmd.io/v1/notes/" + id,
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + key,
      "Cookie": "locale=dev"
    }
  };
  return (0, import_obsidian.requestUrl)(requestParams);
};

// node_modules/diff/lib/index.mjs
function Diff() {
}
Diff.prototype = {
  diff: function diff(oldString, newString) {
    var _options$timeout;
    var options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    var callback = options.callback;
    if (typeof options === "function") {
      callback = options;
      options = {};
    }
    var self = this;
    function done(value) {
      value = self.postProcess(value, options);
      if (callback) {
        setTimeout(function() {
          callback(value);
        }, 0);
        return true;
      } else {
        return value;
      }
    }
    oldString = this.castInput(oldString, options);
    newString = this.castInput(newString, options);
    oldString = this.removeEmpty(this.tokenize(oldString, options));
    newString = this.removeEmpty(this.tokenize(newString, options));
    var newLen = newString.length, oldLen = oldString.length;
    var editLength = 1;
    var maxEditLength = newLen + oldLen;
    if (options.maxEditLength != null) {
      maxEditLength = Math.min(maxEditLength, options.maxEditLength);
    }
    var maxExecutionTime = (_options$timeout = options.timeout) !== null && _options$timeout !== void 0 ? _options$timeout : Infinity;
    var abortAfterTimestamp = Date.now() + maxExecutionTime;
    var bestPath = [{
      oldPos: -1,
      lastComponent: void 0
    }];
    var newPos = this.extractCommon(bestPath[0], newString, oldString, 0, options);
    if (bestPath[0].oldPos + 1 >= oldLen && newPos + 1 >= newLen) {
      return done(buildValues(self, bestPath[0].lastComponent, newString, oldString, self.useLongestToken));
    }
    var minDiagonalToConsider = -Infinity, maxDiagonalToConsider = Infinity;
    function execEditLength() {
      for (var diagonalPath = Math.max(minDiagonalToConsider, -editLength); diagonalPath <= Math.min(maxDiagonalToConsider, editLength); diagonalPath += 2) {
        var basePath = void 0;
        var removePath = bestPath[diagonalPath - 1], addPath = bestPath[diagonalPath + 1];
        if (removePath) {
          bestPath[diagonalPath - 1] = void 0;
        }
        var canAdd = false;
        if (addPath) {
          var addPathNewPos = addPath.oldPos - diagonalPath;
          canAdd = addPath && 0 <= addPathNewPos && addPathNewPos < newLen;
        }
        var canRemove = removePath && removePath.oldPos + 1 < oldLen;
        if (!canAdd && !canRemove) {
          bestPath[diagonalPath] = void 0;
          continue;
        }
        if (!canRemove || canAdd && removePath.oldPos < addPath.oldPos) {
          basePath = self.addToPath(addPath, true, false, 0, options);
        } else {
          basePath = self.addToPath(removePath, false, true, 1, options);
        }
        newPos = self.extractCommon(basePath, newString, oldString, diagonalPath, options);
        if (basePath.oldPos + 1 >= oldLen && newPos + 1 >= newLen) {
          return done(buildValues(self, basePath.lastComponent, newString, oldString, self.useLongestToken));
        } else {
          bestPath[diagonalPath] = basePath;
          if (basePath.oldPos + 1 >= oldLen) {
            maxDiagonalToConsider = Math.min(maxDiagonalToConsider, diagonalPath - 1);
          }
          if (newPos + 1 >= newLen) {
            minDiagonalToConsider = Math.max(minDiagonalToConsider, diagonalPath + 1);
          }
        }
      }
      editLength++;
    }
    if (callback) {
      (function exec() {
        setTimeout(function() {
          if (editLength > maxEditLength || Date.now() > abortAfterTimestamp) {
            return callback();
          }
          if (!execEditLength()) {
            exec();
          }
        }, 0);
      })();
    } else {
      while (editLength <= maxEditLength && Date.now() <= abortAfterTimestamp) {
        var ret = execEditLength();
        if (ret) {
          return ret;
        }
      }
    }
  },
  addToPath: function addToPath(path, added, removed, oldPosInc, options) {
    var last = path.lastComponent;
    if (last && !options.oneChangePerToken && last.added === added && last.removed === removed) {
      return {
        oldPos: path.oldPos + oldPosInc,
        lastComponent: {
          count: last.count + 1,
          added,
          removed,
          previousComponent: last.previousComponent
        }
      };
    } else {
      return {
        oldPos: path.oldPos + oldPosInc,
        lastComponent: {
          count: 1,
          added,
          removed,
          previousComponent: last
        }
      };
    }
  },
  extractCommon: function extractCommon(basePath, newString, oldString, diagonalPath, options) {
    var newLen = newString.length, oldLen = oldString.length, oldPos = basePath.oldPos, newPos = oldPos - diagonalPath, commonCount = 0;
    while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(oldString[oldPos + 1], newString[newPos + 1], options)) {
      newPos++;
      oldPos++;
      commonCount++;
      if (options.oneChangePerToken) {
        basePath.lastComponent = {
          count: 1,
          previousComponent: basePath.lastComponent,
          added: false,
          removed: false
        };
      }
    }
    if (commonCount && !options.oneChangePerToken) {
      basePath.lastComponent = {
        count: commonCount,
        previousComponent: basePath.lastComponent,
        added: false,
        removed: false
      };
    }
    basePath.oldPos = oldPos;
    return newPos;
  },
  equals: function equals(left, right, options) {
    if (options.comparator) {
      return options.comparator(left, right);
    } else {
      return left === right || options.ignoreCase && left.toLowerCase() === right.toLowerCase();
    }
  },
  removeEmpty: function removeEmpty(array) {
    var ret = [];
    for (var i = 0; i < array.length; i++) {
      if (array[i]) {
        ret.push(array[i]);
      }
    }
    return ret;
  },
  castInput: function castInput(value) {
    return value;
  },
  tokenize: function tokenize(value) {
    return Array.from(value);
  },
  join: function join(chars) {
    return chars.join("");
  },
  postProcess: function postProcess(changeObjects) {
    return changeObjects;
  }
};
function buildValues(diff2, lastComponent, newString, oldString, useLongestToken) {
  var components = [];
  var nextComponent;
  while (lastComponent) {
    components.push(lastComponent);
    nextComponent = lastComponent.previousComponent;
    delete lastComponent.previousComponent;
    lastComponent = nextComponent;
  }
  components.reverse();
  var componentPos = 0, componentLen = components.length, newPos = 0, oldPos = 0;
  for (; componentPos < componentLen; componentPos++) {
    var component = components[componentPos];
    if (!component.removed) {
      if (!component.added && useLongestToken) {
        var value = newString.slice(newPos, newPos + component.count);
        value = value.map(function(value2, i) {
          var oldValue = oldString[oldPos + i];
          return oldValue.length > value2.length ? oldValue : value2;
        });
        component.value = diff2.join(value);
      } else {
        component.value = diff2.join(newString.slice(newPos, newPos + component.count));
      }
      newPos += component.count;
      if (!component.added) {
        oldPos += component.count;
      }
    } else {
      component.value = diff2.join(oldString.slice(oldPos, oldPos + component.count));
      oldPos += component.count;
    }
  }
  return components;
}
var characterDiff = new Diff();
function longestCommonPrefix(str1, str2) {
  var i;
  for (i = 0; i < str1.length && i < str2.length; i++) {
    if (str1[i] != str2[i]) {
      return str1.slice(0, i);
    }
  }
  return str1.slice(0, i);
}
function longestCommonSuffix(str1, str2) {
  var i;
  if (!str1 || !str2 || str1[str1.length - 1] != str2[str2.length - 1]) {
    return "";
  }
  for (i = 0; i < str1.length && i < str2.length; i++) {
    if (str1[str1.length - (i + 1)] != str2[str2.length - (i + 1)]) {
      return str1.slice(-i);
    }
  }
  return str1.slice(-i);
}
function replacePrefix(string, oldPrefix, newPrefix) {
  if (string.slice(0, oldPrefix.length) != oldPrefix) {
    throw Error("string ".concat(JSON.stringify(string), " doesn't start with prefix ").concat(JSON.stringify(oldPrefix), "; this is a bug"));
  }
  return newPrefix + string.slice(oldPrefix.length);
}
function replaceSuffix(string, oldSuffix, newSuffix) {
  if (!oldSuffix) {
    return string + newSuffix;
  }
  if (string.slice(-oldSuffix.length) != oldSuffix) {
    throw Error("string ".concat(JSON.stringify(string), " doesn't end with suffix ").concat(JSON.stringify(oldSuffix), "; this is a bug"));
  }
  return string.slice(0, -oldSuffix.length) + newSuffix;
}
function removePrefix(string, oldPrefix) {
  return replacePrefix(string, oldPrefix, "");
}
function removeSuffix(string, oldSuffix) {
  return replaceSuffix(string, oldSuffix, "");
}
function maximumOverlap(string1, string2) {
  return string2.slice(0, overlapCount(string1, string2));
}
function overlapCount(a, b) {
  var startA = 0;
  if (a.length > b.length) {
    startA = a.length - b.length;
  }
  var endB = b.length;
  if (a.length < b.length) {
    endB = a.length;
  }
  var map = Array(endB);
  var k = 0;
  map[0] = 0;
  for (var j = 1; j < endB; j++) {
    if (b[j] == b[k]) {
      map[j] = map[k];
    } else {
      map[j] = k;
    }
    while (k > 0 && b[j] != b[k]) {
      k = map[k];
    }
    if (b[j] == b[k]) {
      k++;
    }
  }
  k = 0;
  for (var i = startA; i < a.length; i++) {
    while (k > 0 && a[i] != b[k]) {
      k = map[k];
    }
    if (a[i] == b[k]) {
      k++;
    }
  }
  return k;
}
var extendedWordChars = "a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}";
var tokenizeIncludingWhitespace = new RegExp("[".concat(extendedWordChars, "]+|\\s+|[^").concat(extendedWordChars, "]"), "ug");
var wordDiff = new Diff();
wordDiff.equals = function(left, right, options) {
  if (options.ignoreCase) {
    left = left.toLowerCase();
    right = right.toLowerCase();
  }
  return left.trim() === right.trim();
};
wordDiff.tokenize = function(value) {
  var options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
  var parts;
  if (options.intlSegmenter) {
    if (options.intlSegmenter.resolvedOptions().granularity != "word") {
      throw new Error('The segmenter passed must have a granularity of "word"');
    }
    parts = Array.from(options.intlSegmenter.segment(value), function(segment) {
      return segment.segment;
    });
  } else {
    parts = value.match(tokenizeIncludingWhitespace) || [];
  }
  var tokens = [];
  var prevPart = null;
  parts.forEach(function(part) {
    if (/\s/.test(part)) {
      if (prevPart == null) {
        tokens.push(part);
      } else {
        tokens.push(tokens.pop() + part);
      }
    } else if (/\s/.test(prevPart)) {
      if (tokens[tokens.length - 1] == prevPart) {
        tokens.push(tokens.pop() + part);
      } else {
        tokens.push(prevPart + part);
      }
    } else {
      tokens.push(part);
    }
    prevPart = part;
  });
  return tokens;
};
wordDiff.join = function(tokens) {
  return tokens.map(function(token, i) {
    if (i == 0) {
      return token;
    } else {
      return token.replace(/^\s+/, "");
    }
  }).join("");
};
wordDiff.postProcess = function(changes, options) {
  if (!changes || options.oneChangePerToken) {
    return changes;
  }
  var lastKeep = null;
  var insertion = null;
  var deletion = null;
  changes.forEach(function(change) {
    if (change.added) {
      insertion = change;
    } else if (change.removed) {
      deletion = change;
    } else {
      if (insertion || deletion) {
        dedupeWhitespaceInChangeObjects(lastKeep, deletion, insertion, change);
      }
      lastKeep = change;
      insertion = null;
      deletion = null;
    }
  });
  if (insertion || deletion) {
    dedupeWhitespaceInChangeObjects(lastKeep, deletion, insertion, null);
  }
  return changes;
};
function dedupeWhitespaceInChangeObjects(startKeep, deletion, insertion, endKeep) {
  if (deletion && insertion) {
    var oldWsPrefix = deletion.value.match(/^\s*/)[0];
    var oldWsSuffix = deletion.value.match(/\s*$/)[0];
    var newWsPrefix = insertion.value.match(/^\s*/)[0];
    var newWsSuffix = insertion.value.match(/\s*$/)[0];
    if (startKeep) {
      var commonWsPrefix = longestCommonPrefix(oldWsPrefix, newWsPrefix);
      startKeep.value = replaceSuffix(startKeep.value, newWsPrefix, commonWsPrefix);
      deletion.value = removePrefix(deletion.value, commonWsPrefix);
      insertion.value = removePrefix(insertion.value, commonWsPrefix);
    }
    if (endKeep) {
      var commonWsSuffix = longestCommonSuffix(oldWsSuffix, newWsSuffix);
      endKeep.value = replacePrefix(endKeep.value, newWsSuffix, commonWsSuffix);
      deletion.value = removeSuffix(deletion.value, commonWsSuffix);
      insertion.value = removeSuffix(insertion.value, commonWsSuffix);
    }
  } else if (insertion) {
    if (startKeep) {
      insertion.value = insertion.value.replace(/^\s*/, "");
    }
    if (endKeep) {
      endKeep.value = endKeep.value.replace(/^\s*/, "");
    }
  } else if (startKeep && endKeep) {
    var newWsFull = endKeep.value.match(/^\s*/)[0], delWsStart = deletion.value.match(/^\s*/)[0], delWsEnd = deletion.value.match(/\s*$/)[0];
    var newWsStart = longestCommonPrefix(newWsFull, delWsStart);
    deletion.value = removePrefix(deletion.value, newWsStart);
    var newWsEnd = longestCommonSuffix(removePrefix(newWsFull, newWsStart), delWsEnd);
    deletion.value = removeSuffix(deletion.value, newWsEnd);
    endKeep.value = replacePrefix(endKeep.value, newWsFull, newWsEnd);
    startKeep.value = replaceSuffix(startKeep.value, newWsFull, newWsFull.slice(0, newWsFull.length - newWsEnd.length));
  } else if (endKeep) {
    var endKeepWsPrefix = endKeep.value.match(/^\s*/)[0];
    var deletionWsSuffix = deletion.value.match(/\s*$/)[0];
    var overlap = maximumOverlap(deletionWsSuffix, endKeepWsPrefix);
    deletion.value = removeSuffix(deletion.value, overlap);
  } else if (startKeep) {
    var startKeepWsSuffix = startKeep.value.match(/\s*$/)[0];
    var deletionWsPrefix = deletion.value.match(/^\s*/)[0];
    var _overlap = maximumOverlap(startKeepWsSuffix, deletionWsPrefix);
    deletion.value = removePrefix(deletion.value, _overlap);
  }
}
var wordWithSpaceDiff = new Diff();
wordWithSpaceDiff.tokenize = function(value) {
  var regex = new RegExp("(\\r?\\n)|[".concat(extendedWordChars, "]+|[^\\S\\n\\r]+|[^").concat(extendedWordChars, "]"), "ug");
  return value.match(regex) || [];
};
var lineDiff = new Diff();
lineDiff.tokenize = function(value, options) {
  if (options.stripTrailingCr) {
    value = value.replace(/\r\n/g, "\n");
  }
  var retLines = [], linesAndNewlines = value.split(/(\n|\r\n)/);
  if (!linesAndNewlines[linesAndNewlines.length - 1]) {
    linesAndNewlines.pop();
  }
  for (var i = 0; i < linesAndNewlines.length; i++) {
    var line = linesAndNewlines[i];
    if (i % 2 && !options.newlineIsToken) {
      retLines[retLines.length - 1] += line;
    } else {
      retLines.push(line);
    }
  }
  return retLines;
};
lineDiff.equals = function(left, right, options) {
  if (options.ignoreWhitespace) {
    if (!options.newlineIsToken || !left.includes("\n")) {
      left = left.trim();
    }
    if (!options.newlineIsToken || !right.includes("\n")) {
      right = right.trim();
    }
  } else if (options.ignoreNewlineAtEof && !options.newlineIsToken) {
    if (left.endsWith("\n")) {
      left = left.slice(0, -1);
    }
    if (right.endsWith("\n")) {
      right = right.slice(0, -1);
    }
  }
  return Diff.prototype.equals.call(this, left, right, options);
};
function diffLines(oldStr, newStr, callback) {
  return lineDiff.diff(oldStr, newStr, callback);
}
var sentenceDiff = new Diff();
sentenceDiff.tokenize = function(value) {
  return value.split(/(\S.+?[.!?])(?=\s+|$)/);
};
var cssDiff = new Diff();
cssDiff.tokenize = function(value) {
  return value.split(/([{}:;,]|\s+)/);
};
function _typeof(o) {
  "@babel/helpers - typeof";
  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(o2) {
    return typeof o2;
  } : function(o2) {
    return o2 && "function" == typeof Symbol && o2.constructor === Symbol && o2 !== Symbol.prototype ? "symbol" : typeof o2;
  }, _typeof(o);
}
var jsonDiff = new Diff();
jsonDiff.useLongestToken = true;
jsonDiff.tokenize = lineDiff.tokenize;
jsonDiff.castInput = function(value, options) {
  var undefinedReplacement = options.undefinedReplacement, _options$stringifyRep = options.stringifyReplacer, stringifyReplacer = _options$stringifyRep === void 0 ? function(k, v) {
    return typeof v === "undefined" ? undefinedReplacement : v;
  } : _options$stringifyRep;
  return typeof value === "string" ? value : JSON.stringify(canonicalize(value, null, null, stringifyReplacer), stringifyReplacer, "  ");
};
jsonDiff.equals = function(left, right, options) {
  return Diff.prototype.equals.call(jsonDiff, left.replace(/,([\r\n])/g, "$1"), right.replace(/,([\r\n])/g, "$1"), options);
};
function canonicalize(obj, stack, replacementStack, replacer, key) {
  stack = stack || [];
  replacementStack = replacementStack || [];
  if (replacer) {
    obj = replacer(key, obj);
  }
  var i;
  for (i = 0; i < stack.length; i += 1) {
    if (stack[i] === obj) {
      return replacementStack[i];
    }
  }
  var canonicalizedObj;
  if ("[object Array]" === Object.prototype.toString.call(obj)) {
    stack.push(obj);
    canonicalizedObj = new Array(obj.length);
    replacementStack.push(canonicalizedObj);
    for (i = 0; i < obj.length; i += 1) {
      canonicalizedObj[i] = canonicalize(obj[i], stack, replacementStack, replacer, key);
    }
    stack.pop();
    replacementStack.pop();
    return canonicalizedObj;
  }
  if (obj && obj.toJSON) {
    obj = obj.toJSON();
  }
  if (_typeof(obj) === "object" && obj !== null) {
    stack.push(obj);
    canonicalizedObj = {};
    replacementStack.push(canonicalizedObj);
    var sortedKeys = [], _key;
    for (_key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, _key)) {
        sortedKeys.push(_key);
      }
    }
    sortedKeys.sort();
    for (i = 0; i < sortedKeys.length; i += 1) {
      _key = sortedKeys[i];
      canonicalizedObj[_key] = canonicalize(obj[_key], stack, replacementStack, replacer, _key);
    }
    stack.pop();
    replacementStack.pop();
  } else {
    canonicalizedObj = obj;
  }
  return canonicalizedObj;
}
var arrayDiff = new Diff();
arrayDiff.tokenize = function(value) {
  return value.slice();
};
arrayDiff.join = arrayDiff.removeEmpty = function(value) {
  return value;
};

// main.ts
function generateMergeConflictFile(text1, text2) {
  const differences = diffLines(text1, text2);
  const result = [];
  let inConflict = false;
  let conflictBlock = {
    original: [],
    modified: []
  };
  differences.forEach((part) => {
    if (part.added || part.removed) {
      if (!inConflict) {
        inConflict = true;
      }
      const lines = part.value.replace(/\n$/, "").split("\n");
      if (part.removed) {
        conflictBlock.original.push(...lines);
      } else if (part.added) {
        conflictBlock.modified.push(...lines);
      }
    } else {
      if (inConflict) {
        if (conflictBlock.original.length > 0 || conflictBlock.modified.length > 0) {
          result.push("/<<<<<<< HEAD");
          result.push(...conflictBlock.original);
          result.push("/=======");
          result.push(...conflictBlock.modified);
          result.push("/>>>>>>>");
        }
        inConflict = false;
        conflictBlock = { original: [], modified: [] };
      }
      const unchangedLines = part.value.replace(/\n$/, "").split("\n");
      result.push(...unchangedLines);
    }
  });
  if (inConflict && (conflictBlock.original.length > 0 || conflictBlock.modified.length > 0)) {
    result.push("<<<<<<< HEAD");
    result.push(...conflictBlock.original);
    result.push("=======");
    result.push(...conflictBlock.modified);
    result.push(">>>>>>>");
  }
  return result.join("\n");
}
var DEFAULT_SETTINGS = {
  apiToken: "None",
  commentPermission: "guest",
  readPermission: "guest"
};
var hackmdPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.addCommand({
      id: "share",
      name: "Share article",
      editorCallback: async (editor, view) => {
        const curContent = editor.getValue();
        const yamlRegex = /^---\n([\s\S]*?)\n---/;
        const match = curContent.match(yamlRegex);
        if (match) {
          const yamlContent = match[1];
          const yamlData = (0, import_obsidian2.parseYaml)(yamlContent);
          new PopWindows(this.app, this.settings, editor, view, yamlData).open();
          return;
        }
        new PopWindows(this.app, this.settings, editor, view, {}).open();
      }
    });
    this.addSettingTab(new SettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
function updateYamlContent(content, updates) {
  const yamlRegex = /^---\n([\s\S]*?)\n---/;
  if (yamlRegex.test(content)) {
    return content.replace(yamlRegex, (match, p1) => {
      const yamlData = (0, import_obsidian2.parseYaml)(p1) || {};
      Object.assign(yamlData, updates);
      const newYaml = (0, import_obsidian2.stringifyYaml)(yamlData).trim();
      return `---
${newYaml}
---`;
    });
  } else {
    const newYaml = (0, import_obsidian2.stringifyYaml)(updates).trim();
    return `---
${newYaml}
---

${content}`;
  }
}
function updateEditorYaml(editor, updates) {
  const content = editor.getValue();
  const newContent = updateYamlContent(content, updates);
  editor.setValue(newContent);
}
async function createRemoteVersionFile(app, folderPath, originalFileName, content, remoteInfo) {
  try {
    const fileExtension = originalFileName.split(".").pop();
    const baseName = originalFileName.replace(`.${fileExtension}`, "");
    const newFileName = `${baseName}-${remoteInfo.permission}.${fileExtension}`;
    const fullPath = `${folderPath}/${newFileName}`;
    const yamlUpdates = {
      remote_permission: remoteInfo.permission,
      pull_time: remoteInfo.pullTime
    };
    const contentWithYaml = updateYamlContent(content, yamlUpdates);
    const file = await app.vault.create(fullPath, contentWithYaml);
    return file;
  } catch (error) {
    new import_obsidian2.Notice(`Failed to create remote version file: ${error.message}`);
    return null;
  }
}
var PopWindows = class extends import_obsidian2.Modal {
  constructor(app, settings, editor, view, yamlData) {
    super(app);
    this.checkNote = async (noteId) => {
      if (noteId) {
        try {
          const response = await getNote(this.token, noteId);
          const content = response.json.content;
          this.previewArea.setText(content);
          this.previewArea.value = content;
          this.idLabel.setText(noteId);
          this.currId = noteId;
        } catch (error) {
          this.idLabel.setText("\u7121\u6548\u7684 ID");
          this.previewArea.setText("");
          this.previewArea.value = "";
          this.currId = "";
          new import_obsidian2.Notice(`\u7121\u6CD5\u7372\u53D6\u7B46\u8A18: ${error.message}`);
        }
      } else {
        this.idLabel.setText("\u7121");
        this.currId = "";
        this.previewArea.value = "";
        this.previewArea.setText("");
      }
    };
    this.createDropdown = async (dropdownContainer, labelText, defaultValue, options) => {
      const noteId = this.yamlData[`hackmd-id-owner`];
      await this.checkNote(noteId);
      const wrapper = dropdownContainer.createEl("div", { cls: "dropdown-wrapper" });
      wrapper.createEl("label", { text: labelText, cls: "dropdown-label" });
      const customSelect = wrapper.createEl("div", { cls: "custom-select" });
      const selectedDisplay = customSelect.createEl("div", {
        cls: "selected-option",
        text: defaultValue
      });
      const optionsList = customSelect.createEl("div", { cls: "options-list" });
      let selectedValue = defaultValue;
      options.forEach((option) => {
        const optionEl = optionsList.createEl("div", {
          cls: "option",
          text: option
        });
        optionEl.addEventListener("click", async () => {
          selectedDisplay.setText(option);
          optionsList.classList.remove("show");
          selectedValue = option;
          const noteId2 = this.yamlData[`hackmd-id-${option}`];
          await this.checkNote(noteId2);
        });
      });
      selectedDisplay.addEventListener("click", (e) => {
        e.stopPropagation();
        document.querySelectorAll(".options-list.show").forEach((list) => {
          if (list !== optionsList) {
            list.classList.remove("show");
          }
        });
        optionsList.classList.toggle("show");
      });
      return () => selectedValue;
    };
    this.token = settings.apiToken;
    this.editor = editor;
    this.view = view;
    this.yamlData = yamlData;
    this.settings = settings;
    this.currId = "";
  }
  async onOpen() {
    const { contentEl } = this;
    this.titleEl.setText("\u5206\u4EAB\u8A2D\u5B9A");
    const dropdownContainer = contentEl.createEl("div", { cls: "dropdown-container" });
    dropdownContainer.createEl("label", { text: "\u524D\u6B21\u5206\u4EAB id \uFF1A", cls: "id-a" });
    this.idLabel = dropdownContainer.createEl("label", {
      text: "\u7121",
      cls: "id-a id-s"
    });
    this.previewArea = dropdownContainer.createEl("textarea", { cls: "preview-area", attr: { rows: "10" } });
    const getEditValue = await this.createDropdown(dropdownContainer, "\u7DE8\u8F2F\u6B0A\u9650 \uFF1A", "owner", ["owner", "signed_in", "guest"]);
    new import_obsidian2.Setting(contentEl).setName("\u5206\u4EAB").setDesc("\u82E5\u5DF2\u7D93\u5206\u4EAB\u904E\u5247\u6703\u5F37\u5236\u8986\u84CB\u7DDA\u4E0A\u7248\u672C").addButton((btn) => btn.setButtonText("Push").setCta().onClick(async () => {
      var _a;
      const writePermission = getEditValue();
      const fileContent = this.editor.getValue();
      const title = "# " + ((_a = this.view.file) == null ? void 0 : _a.basename) + "\n";
      const contentWithoutYaml = fileContent.replace(/^---\n[\s\S]*?\n---\n/, "");
      const content = title + contentWithoutYaml;
      if (this.currId) {
        try {
          const response = await updataNote(this.token, content, this.currId);
          const message = `Note shared\uFF08Updata\uFF09 successfully!`;
          new import_obsidian2.Notice(message, 1e4).noticeEl;
        } catch (error) {
          console.log(error);
          new import_obsidian2.Notice("Push\uFF08Updata\uFF09failed: " + error.message);
        }
      } else {
        try {
          const response = await shareNote(this.token, content, { writePermission, readPermission: this.settings.readPermission, commentPermission: this.settings.commentPermission });
          const link = response.json.publishLink;
          const id = response.json.id;
          const message = `Note shared successfully!`;
          const btn2 = new import_obsidian2.Notice(message, 1e4).noticeEl;
          btn2.addEventListener("click", () => {
            window.open(link, "_blank");
          });
          await navigator.clipboard.writeText(link);
          updateEditorYaml(this.editor, {
            ["hackmd-link-" + writePermission]: link,
            ["hackmd-id-" + writePermission]: id
          });
        } catch (error) {
          console.log(error);
          new import_obsidian2.Notice("Push failed: " + error.message);
        }
      }
      this.close();
    }));
    new import_obsidian2.Setting(contentEl).setName("\u5408\u4F75").setDesc("\u900F\u904E\u4E0A\u65B9\u9810\u89BD\u6846\u4FEE\u6539\u5F8C\u6309\u4E0B Pull \u6703\u5408\u4F75\u81F3\u672C\u5730\u6587\u4EF6\u4E26\u4FDD\u7559\u5408\u4F75\u885D\u7A81").addButton((btn) => btn.setButtonText("Pull").setCta().onClick(async () => {
      if (!this.currId) {
        new import_obsidian2.Notice("No online version");
        return;
      }
      const oldContent = this.editor.getValue();
      const oldContentWithoutYaml = oldContent.replace(/^---\n[\s\S]*?\n---\n/, "");
      const match = oldContent.match(/^(---\n[\s\S]*?\n---)/);
      const yaml = match ? match[1] + "\n" : "";
      const newContent = this.previewArea.value;
      const content = generateMergeConflictFile(oldContentWithoutYaml, newContent);
      this.editor.setValue(yaml + content);
      const message = `Pull successfully`;
      new import_obsidian2.Notice(message, 1e4).noticeEl;
      this.close();
    }));
    new import_obsidian2.Setting(contentEl).setName("\u5F37\u5236\u5408\u4F75").setDesc("\u900F\u904E\u4E0A\u65B9\u9810\u89BD\u6846\u4FEE\u6539\u5F8C\u6309\u4E0B Pull \u6703\u5F37\u5236\u8986\u84CB\u672C\u5730\u6587\u4EF6").addButton((btn) => btn.setButtonText("Pull").setCta().onClick(async () => {
      if (!this.currId) {
        new import_obsidian2.Notice("No online version");
        return;
      }
      const oldContent = this.editor.getValue();
      const match = oldContent.match(/^(---\n[\s\S]*?\n---)/);
      const yaml = match ? match[1] + "\n" : "";
      const newContent = this.previewArea.value;
      this.editor.setValue(yaml + newContent);
      const message = `Pull successfully`;
      new import_obsidian2.Notice(message, 1e4).noticeEl;
      this.close();
    }));
    new import_obsidian2.Setting(contentEl).setName("\u62C9\u53D6\u5230\u65B0\u6A94\u6848").setDesc("\u900F\u904E\u4E0A\u65B9\u9810\u89BD\u6846\u4FEE\u6539\u5F8C\u6309\u4E0B Pull \u6703\u62C9\u53D6\u9060\u7AEF\u7248\u672C\u4E26\u5728\u7576\u524D\u76EE\u9304\u5EFA\u7ACB\u65B0\u6A94\u6848").addButton(
      (btn) => btn.setButtonText("Pull").setCta().onClick(async () => {
        if (!this.currId) {
          new import_obsidian2.Notice("No online version");
          return;
        }
        const writePermission = getEditValue();
        const oldContent = this.editor.getValue();
        const match = oldContent.match(/^(---\n[\s\S]*?\n---)/);
        const yaml = match ? match[1] + "\n" : "";
        const newContent = this.previewArea.value;
        const currentFile = this.app.workspace.getActiveFile();
        if (!currentFile) {
          new import_obsidian2.Notice("No active file");
          return;
        }
        const remoteInfo = {
          permission: writePermission,
          pullTime: new Date().toISOString().replace("T", " ").replace(/:/g, ".")
        };
        const newFile = await createRemoteVersionFile(
          this.app,
          currentFile.parent.path,
          currentFile.name,
          yaml + newContent,
          remoteInfo
        );
        if (newFile) {
          new import_obsidian2.Notice(`Created remote version file: ${newFile.name}`, 5e3);
        }
        this.close();
      })
    );
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var SettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("hackmd api token").setDesc("\u53BB\u641E\u4E00\u500B\u5427").addText((text) => text.setPlaceholder("Enter your secret").setValue(this.plugin.settings.apiToken).onChange(async (value) => {
      this.plugin.settings.apiToken = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("commentPermission").setDesc("\u8A55\u8AD6\u8A2D\u5B9A").addDropdown((dropdown) => dropdown.addOptions({
      "disabled": "\u95DC\u9589",
      "forbidden": "\u7981\u7528",
      "owner": "\u50C5\u64C1\u6709\u8005",
      "signed_in": "\u767B\u5165\u7528\u6236",
      "guest": "\u8A2A\u5BA2"
    }).setValue(this.plugin.settings.commentPermission || "guest").onChange(async (value) => {
      this.plugin.settings.commentPermission = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("readPermission").setDesc("\u6AA2\u8996\u8A2D\u5B9A").addDropdown((dropdown) => dropdown.addOptions({
      "owner": "\u50C5\u64C1\u6709\u8005",
      "signed_in": "\u767B\u5165\u7528\u6236",
      "guest": "\u8A2A\u5BA2"
    }).setValue(this.plugin.settings.commentPermission || "guest").onChange(async (value) => {
      this.plugin.settings.commentPermission = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzaGFyZXIudHMiLCAibm9kZV9tb2R1bGVzL2RpZmYvbGliL2luZGV4Lm1qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgcGFyc2VZYW1sLCBzdHJpbmdpZnlZYW1sLCBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBzaGFyZU5vdGUsIGdldE5vdGUsIHVwZGF0YU5vdGUgfSBmcm9tICdzaGFyZXInO1xyXG5pbXBvcnQgeyBkaWZmTGluZXMsIENoYW5nZSB9IGZyb20gJ2RpZmYnO1xyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVNZXJnZUNvbmZsaWN0RmlsZSh0ZXh0MTogc3RyaW5nLCB0ZXh0Mjogc3RyaW5nKTogc3RyaW5nIHtcclxuXHQvLyBcdTRGN0ZcdTc1MjggZGlmZkxpbmVzIFx1NzZGNFx1NjNBNVx1NkJENFx1OEYwM1x1NTE2OVx1NkJCNVx1NjU4N1x1NjcyQ1xyXG5cdGNvbnN0IGRpZmZlcmVuY2VzOiBDaGFuZ2VbXSA9IGRpZmZMaW5lcyh0ZXh0MSwgdGV4dDIpO1xyXG5cdGNvbnN0IHJlc3VsdDogc3RyaW5nW10gPSBbXTtcclxuXHJcblx0bGV0IGluQ29uZmxpY3QgPSBmYWxzZTtcclxuXHRsZXQgY29uZmxpY3RCbG9jazoge1xyXG5cdFx0b3JpZ2luYWw6IHN0cmluZ1tdO1xyXG5cdFx0bW9kaWZpZWQ6IHN0cmluZ1tdO1xyXG5cdH0gPSB7XHJcblx0XHRvcmlnaW5hbDogW10sXHJcblx0XHRtb2RpZmllZDogW11cclxuXHR9O1xyXG5cclxuXHQvLyBcdTg2NTVcdTc0MDZcdTZCQ0ZcdTRFMDBcdTUwMEJcdTVERUVcdTc1NzBcdTU4NEFcclxuXHRkaWZmZXJlbmNlcy5mb3JFYWNoKChwYXJ0OiBDaGFuZ2UpID0+IHtcclxuXHRcdGlmIChwYXJ0LmFkZGVkIHx8IHBhcnQucmVtb3ZlZCkge1xyXG5cdFx0XHRpZiAoIWluQ29uZmxpY3QpIHtcclxuXHRcdFx0XHRpbkNvbmZsaWN0ID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gXHU3OUZCXHU5NjY0XHU1QzNFXHU5MEU4XHU3Njg0XHU2M0RCXHU4ODRDXHU3QjI2XHU0Rjg2XHU5NjMyXHU2QjYyXHU1OTFBXHU5OTE4XHU3Njg0XHU3QTdBXHU4ODRDXHJcblx0XHRcdGNvbnN0IGxpbmVzOiBzdHJpbmdbXSA9IHBhcnQudmFsdWUucmVwbGFjZSgvXFxuJC8sICcnKS5zcGxpdCgnXFxuJyk7XHJcblxyXG5cdFx0XHRpZiAocGFydC5yZW1vdmVkKSB7XHJcblx0XHRcdFx0Y29uZmxpY3RCbG9jay5vcmlnaW5hbC5wdXNoKC4uLmxpbmVzKTtcclxuXHRcdFx0fSBlbHNlIGlmIChwYXJ0LmFkZGVkKSB7XHJcblx0XHRcdFx0Y29uZmxpY3RCbG9jay5tb2RpZmllZC5wdXNoKC4uLmxpbmVzKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gXHU1OTgyXHU2NzlDXHU0RTRCXHU1MjREXHU2NzA5XHU4ODVEXHU3QTgxXHU1ODRBXHVGRjBDXHU1MTQ4XHU4RjM4XHU1MUZBXHU4ODVEXHU3QTgxXHJcblx0XHRcdGlmIChpbkNvbmZsaWN0KSB7XHJcblx0XHRcdFx0aWYgKGNvbmZsaWN0QmxvY2sub3JpZ2luYWwubGVuZ3RoID4gMCB8fCBjb25mbGljdEJsb2NrLm1vZGlmaWVkLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKCcvPDw8PDw8PCBIRUFEJyk7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaCguLi5jb25mbGljdEJsb2NrLm9yaWdpbmFsKTtcclxuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKCcvPT09PT09PScpO1xyXG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goLi4uY29uZmxpY3RCbG9jay5tb2RpZmllZCk7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaCgnLz4+Pj4+Pj4nKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aW5Db25mbGljdCA9IGZhbHNlO1xyXG5cdFx0XHRcdGNvbmZsaWN0QmxvY2sgPSB7IG9yaWdpbmFsOiBbXSwgbW9kaWZpZWQ6IFtdIH07XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFx1NkRGQlx1NTJBMFx1NjcyQVx1NEZFRVx1NjUzOVx1NzY4NFx1NTE2N1x1NUJCOVxyXG5cdFx0XHRjb25zdCB1bmNoYW5nZWRMaW5lczogc3RyaW5nW10gPSBwYXJ0LnZhbHVlLnJlcGxhY2UoL1xcbiQvLCAnJykuc3BsaXQoJ1xcbicpO1xyXG5cdFx0XHRyZXN1bHQucHVzaCguLi51bmNoYW5nZWRMaW5lcyk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdC8vIFx1ODY1NVx1NzQwNlx1NjcwMFx1NUY4Q1x1NTNFRlx1ODBGRFx1NUI1OFx1NTcyOFx1NzY4NFx1ODg1RFx1N0E4MVx1NTg0QVxyXG5cdGlmIChpbkNvbmZsaWN0ICYmIChjb25mbGljdEJsb2NrLm9yaWdpbmFsLmxlbmd0aCA+IDAgfHwgY29uZmxpY3RCbG9jay5tb2RpZmllZC5sZW5ndGggPiAwKSkge1xyXG5cdFx0cmVzdWx0LnB1c2goJzw8PDw8PDwgSEVBRCcpO1xyXG5cdFx0cmVzdWx0LnB1c2goLi4uY29uZmxpY3RCbG9jay5vcmlnaW5hbCk7XHJcblx0XHRyZXN1bHQucHVzaCgnPT09PT09PScpO1xyXG5cdFx0cmVzdWx0LnB1c2goLi4uY29uZmxpY3RCbG9jay5tb2RpZmllZCk7XHJcblx0XHRyZXN1bHQucHVzaCgnPj4+Pj4+PicpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHJlc3VsdC5qb2luKCdcXG4nKTtcclxufVxyXG5cclxuaW50ZXJmYWNlIGhhY2ttZFBsdWdpblNldHRpbmdzIHtcclxuXHRhcGlUb2tlbjogc3RyaW5nO1xyXG5cdGNvbW1lbnRQZXJtaXNzaW9uOiBzdHJpbmc7XHJcblx0cmVhZFBlcm1pc3Npb246IHN0cmluZztcclxuXHJcbn1cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogaGFja21kUGx1Z2luU2V0dGluZ3MgPSB7XHJcblx0YXBpVG9rZW46ICdOb25lJyxcclxuXHRjb21tZW50UGVybWlzc2lvbjogJ2d1ZXN0JyxcclxuXHRyZWFkUGVybWlzc2lvbjogJ2d1ZXN0JyxcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgaGFja21kUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogaGFja21kUGx1Z2luU2V0dGluZ3M7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdzaGFyZScsXHJcblx0XHRcdG5hbWU6ICdTaGFyZSBhcnRpY2xlJyxcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1ckNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcclxuXHRcdFx0XHRjb25zdCB5YW1sUmVnZXggPSAvXi0tLVxcbihbXFxzXFxTXSo/KVxcbi0tLS87XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBjdXJDb250ZW50Lm1hdGNoKHlhbWxSZWdleCk7XHJcblxyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgeWFtbENvbnRlbnQgPSBtYXRjaFsxXTtcclxuXHRcdFx0XHRcdGNvbnN0IHlhbWxEYXRhID0gcGFyc2VZYW1sKHlhbWxDb250ZW50KTtcclxuXHJcblx0XHRcdFx0XHRuZXcgUG9wV2luZG93cyh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncywgZWRpdG9yLCB2aWV3LCB5YW1sRGF0YSkub3BlbigpO1xyXG5cdFx0XHRcdFx0cmV0dXJuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG5ldyBQb3BXaW5kb3dzKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCBlZGl0b3IsIHZpZXcsIHt9KS5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFx1OTAxOVx1NjcwM1x1NkRGQlx1NTJBMFx1NEUwMFx1NTAwQlx1OEEyRFx1N0Y2RVx1OTA3OFx1OTgwNVx1NTM2MVx1RkYwQ1x1NEVFNVx1NEZCRlx1NzUyOFx1NjIzNlx1NTNFRlx1NEVFNVx1OTE0RFx1N0Y2RVx1NjNEMlx1NEVGNlx1NzY4NFx1NTQwNFx1NTAwQlx1NjVCOVx1OTc2MlxyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gXHU1OTgyXHU2NzlDXHU2M0QyXHU0RUY2XHU2MzlCXHU2M0E1XHU0RTg2XHU0RUZCXHU0RjU1XHU1MTY4XHU1QzQwIERPTSBcdTRFOEJcdTRFRjZcdUZGMDhcdTU3MjhcdTYxQzlcdTc1MjhcdTdBMEJcdTVFOEZcdTRFMkRcdTRFMERcdTVDNkNcdTY1QkNcdTZCNjRcdTYzRDJcdTRFRjZcdTc2ODRcdTkwRThcdTUyMDZcdUZGMDlcclxuXHRcdC8vIFx1NEY3Rlx1NzUyOFx1NkI2NFx1NTFGRFx1NjU3OFx1NUMwN1x1NTcyOFx1NjNEMlx1NEVGNlx1ODhBQlx1Nzk4MVx1NzUyOFx1NjY0Mlx1ODFFQVx1NTJENVx1NTIyQVx1OTY2NFx1NEU4Qlx1NEVGNlx1NzZFM1x1ODA3RFx1NTY2OFx1MzAwMlxyXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XHJcblx0XHQvLyBcdGNvbnNvbGUubG9nKCdjbGlja1x1Nzk4MVx1NzUyOCcsIGV2dCk7XHJcblx0XHQvLyB9KTtcclxuXHR9XHJcblxyXG5cdG9udW5sb2FkKCkge1xyXG5cclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVZYW1sQ29udGVudChjb250ZW50OiBzdHJpbmcsIHVwZGF0ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBzdHJpbmcge1xyXG5cdGNvbnN0IHlhbWxSZWdleCA9IC9eLS0tXFxuKFtcXHNcXFNdKj8pXFxuLS0tLztcclxuXHJcblx0aWYgKHlhbWxSZWdleC50ZXN0KGNvbnRlbnQpKSB7XHJcblx0XHRyZXR1cm4gY29udGVudC5yZXBsYWNlKHlhbWxSZWdleCwgKG1hdGNoLCBwMSkgPT4ge1xyXG5cdFx0XHRjb25zdCB5YW1sRGF0YSA9IHBhcnNlWWFtbChwMSkgfHwge307XHJcblx0XHRcdE9iamVjdC5hc3NpZ24oeWFtbERhdGEsIHVwZGF0ZXMpO1xyXG5cdFx0XHRjb25zdCBuZXdZYW1sID0gc3RyaW5naWZ5WWFtbCh5YW1sRGF0YSkudHJpbSgpO1xyXG5cdFx0XHRyZXR1cm4gYC0tLVxcbiR7bmV3WWFtbH1cXG4tLS1gO1xyXG5cdFx0fSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdGNvbnN0IG5ld1lhbWwgPSBzdHJpbmdpZnlZYW1sKHVwZGF0ZXMpLnRyaW0oKTtcclxuXHRcdHJldHVybiBgLS0tXFxuJHtuZXdZYW1sfVxcbi0tLVxcblxcbiR7Y29udGVudH1gO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlRWRpdG9yWWFtbChlZGl0b3I6IEVkaXRvciwgdXBkYXRlczogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xyXG5cdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcclxuXHRjb25zdCBuZXdDb250ZW50ID0gdXBkYXRlWWFtbENvbnRlbnQoY29udGVudCwgdXBkYXRlcyk7XHJcblx0ZWRpdG9yLnNldFZhbHVlKG5ld0NvbnRlbnQpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVSZW1vdGVWZXJzaW9uRmlsZShcclxuXHRhcHA6IGFueSxcclxuXHRmb2xkZXJQYXRoOiBzdHJpbmcsXHJcblx0b3JpZ2luYWxGaWxlTmFtZTogc3RyaW5nLFxyXG5cdGNvbnRlbnQ6IHN0cmluZyxcclxuXHRyZW1vdGVJbmZvOiB7XHJcblx0XHRwZXJtaXNzaW9uOiBzdHJpbmc7XHJcblx0XHRwdWxsVGltZTogc3RyaW5nO1xyXG5cdH1cclxuKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcclxuXHR0cnkge1xyXG5cdFx0Ly8gXHU3NTFGXHU2MjEwXHU2NUIwXHU2QTk0XHU1NDBEXHVGRjBDXHU1MzA1XHU1NDJCXHU5MDYwXHU3QUVGXHU3MjQ4XHU2NzJDXHU0RkUxXHU2MDZGXHJcblx0XHRjb25zdCBmaWxlRXh0ZW5zaW9uID0gb3JpZ2luYWxGaWxlTmFtZS5zcGxpdCgnLicpLnBvcCgpO1xyXG5cdFx0Y29uc3QgYmFzZU5hbWUgPSBvcmlnaW5hbEZpbGVOYW1lLnJlcGxhY2UoYC4ke2ZpbGVFeHRlbnNpb259YCwgJycpO1xyXG5cdFx0Y29uc3QgbmV3RmlsZU5hbWUgPSBgJHtiYXNlTmFtZX0tJHtyZW1vdGVJbmZvLnBlcm1pc3Npb259LiR7ZmlsZUV4dGVuc2lvbn1gO1xyXG5cdFx0Y29uc3QgZnVsbFBhdGggPSBgJHtmb2xkZXJQYXRofS8ke25ld0ZpbGVOYW1lfWA7XHJcblxyXG5cdFx0Ly8gXHU2REZCXHU1MkEwIFlBTUwgZnJvbnQgbWF0dGVyXHJcblx0XHRjb25zdCB5YW1sVXBkYXRlcyA9IHtcclxuXHRcdFx0cmVtb3RlX3Blcm1pc3Npb246IHJlbW90ZUluZm8ucGVybWlzc2lvbixcclxuXHRcdFx0cHVsbF90aW1lOiByZW1vdGVJbmZvLnB1bGxUaW1lLFxyXG5cdFx0fTtcclxuXHRcdGNvbnN0IGNvbnRlbnRXaXRoWWFtbCA9IHVwZGF0ZVlhbWxDb250ZW50KGNvbnRlbnQsIHlhbWxVcGRhdGVzKTtcclxuXHJcblx0XHQvLyBcdTUyNzVcdTVFRkFcdTY1QjBcdTZBOTRcdTY4NDhcclxuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCBhcHAudmF1bHQuY3JlYXRlKGZ1bGxQYXRoLCBjb250ZW50V2l0aFlhbWwpO1xyXG5cdFx0cmV0dXJuIGZpbGU7XHJcblx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgcmVtb3RlIHZlcnNpb24gZmlsZTogJHtlcnJvci5tZXNzYWdlfWApO1xyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBQb3BXaW5kb3dzIGV4dGVuZHMgTW9kYWwge1xyXG5cdHRva2VuOiBzdHJpbmc7XHJcblx0Y3VycklkOiBzdHJpbmc7XHJcblx0c2V0dGluZ3M6IGhhY2ttZFBsdWdpblNldHRpbmdzO1xyXG5cdGVkaXRvcjogRWRpdG9yO1xyXG5cdHZpZXc6IE1hcmtkb3duVmlldztcclxuXHRpZExhYmVsOiBIVE1MRWxlbWVudDtcclxuXHRwcmV2aWV3QXJlYTogSFRNTFRleHRBcmVhRWxlbWVudDtcclxuXHR5YW1sRGF0YTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfTtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHNldHRpbmdzOiBoYWNrbWRQbHVnaW5TZXR0aW5ncywgZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldywgeWFtbERhdGE6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLnRva2VuID0gc2V0dGluZ3MuYXBpVG9rZW47XHJcblx0XHR0aGlzLmVkaXRvciA9IGVkaXRvcjtcclxuXHRcdHRoaXMudmlldyA9IHZpZXc7XHJcblx0XHR0aGlzLnlhbWxEYXRhID0geWFtbERhdGE7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcblx0XHR0aGlzLmN1cnJJZCA9ICcnO1xyXG5cclxuXHR9XHJcblxyXG5cdGNoZWNrTm90ZSA9IGFzeW5jIChub3RlSWQ6IHN0cmluZykgPT4ge1xyXG5cdFx0aWYgKG5vdGVJZCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0Tm90ZSh0aGlzLnRva2VuLCBub3RlSWQpO1xyXG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSByZXNwb25zZS5qc29uLmNvbnRlbnQ7XHJcblx0XHRcdFx0dGhpcy5wcmV2aWV3QXJlYS5zZXRUZXh0KGNvbnRlbnQpXHJcblx0XHRcdFx0dGhpcy5wcmV2aWV3QXJlYS52YWx1ZSA9IGNvbnRlbnRcclxuXHRcdFx0XHR0aGlzLmlkTGFiZWwuc2V0VGV4dChub3RlSWQpO1xyXG5cdFx0XHRcdHRoaXMuY3VycklkID0gbm90ZUlkO1xyXG5cclxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHR0aGlzLmlkTGFiZWwuc2V0VGV4dCgnXHU3MTIxXHU2NTQ4XHU3Njg0IElEJyk7XHJcblx0XHRcdFx0dGhpcy5wcmV2aWV3QXJlYS5zZXRUZXh0KCcnKVxyXG5cdFx0XHRcdHRoaXMucHJldmlld0FyZWEudmFsdWUgPSAnJ1xyXG5cdFx0XHRcdHRoaXMuY3VycklkID0gJyc7XHJcblxyXG5cdFx0XHRcdG5ldyBOb3RpY2UoYFx1NzEyMVx1NkNENVx1NzM3Mlx1NTNENlx1N0I0Nlx1OEExODogJHtlcnJvci5tZXNzYWdlfWApO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmlkTGFiZWwuc2V0VGV4dCgnXHU3MTIxJyk7XHJcblx0XHRcdHRoaXMuY3VycklkID0gXCJcIjtcclxuXHRcdFx0dGhpcy5wcmV2aWV3QXJlYS52YWx1ZSA9ICcnXHJcblx0XHRcdHRoaXMucHJldmlld0FyZWEuc2V0VGV4dCgnJylcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNyZWF0ZURyb3Bkb3duID0gYXN5bmMgKGRyb3Bkb3duQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgbGFiZWxUZXh0OiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogc3RyaW5nLCBvcHRpb25zOiBzdHJpbmdbXSkgPT4ge1xyXG5cdFx0Y29uc3Qgbm90ZUlkID0gdGhpcy55YW1sRGF0YVtgaGFja21kLWlkLW93bmVyYF07XHJcblx0XHRhd2FpdCB0aGlzLmNoZWNrTm90ZShub3RlSWQpXHJcblxyXG5cdFx0Y29uc3Qgd3JhcHBlciA9IGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2Ryb3Bkb3duLXdyYXBwZXInIH0pO1xyXG5cdFx0d3JhcHBlci5jcmVhdGVFbCgnbGFiZWwnLCB7IHRleHQ6IGxhYmVsVGV4dCwgY2xzOiAnZHJvcGRvd24tbGFiZWwnIH0pO1xyXG5cclxuXHRcdGNvbnN0IGN1c3RvbVNlbGVjdCA9IHdyYXBwZXIuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnY3VzdG9tLXNlbGVjdCcgfSk7XHJcblx0XHRjb25zdCBzZWxlY3RlZERpc3BsYXkgPSBjdXN0b21TZWxlY3QuY3JlYXRlRWwoJ2RpdicsIHtcclxuXHRcdFx0Y2xzOiAnc2VsZWN0ZWQtb3B0aW9uJyxcclxuXHRcdFx0dGV4dDogZGVmYXVsdFZhbHVlXHJcblx0XHR9KTtcclxuXHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gY3VzdG9tU2VsZWN0LmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ29wdGlvbnMtbGlzdCcgfSk7XHJcblxyXG5cdFx0bGV0IHNlbGVjdGVkVmFsdWUgPSBkZWZhdWx0VmFsdWU7XHJcblx0XHRvcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcclxuXHRcdFx0Y29uc3Qgb3B0aW9uRWwgPSBvcHRpb25zTGlzdC5jcmVhdGVFbCgnZGl2Jywge1xyXG5cdFx0XHRcdGNsczogJ29wdGlvbicsXHJcblx0XHRcdFx0dGV4dDogb3B0aW9uXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0b3B0aW9uRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0c2VsZWN0ZWREaXNwbGF5LnNldFRleHQob3B0aW9uKTtcclxuXHRcdFx0XHRvcHRpb25zTGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XHJcblx0XHRcdFx0c2VsZWN0ZWRWYWx1ZSA9IG9wdGlvbjtcclxuXHJcblx0XHRcdFx0Y29uc3Qgbm90ZUlkID0gdGhpcy55YW1sRGF0YVtgaGFja21kLWlkLSR7b3B0aW9ufWBdO1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuY2hlY2tOb3RlKG5vdGVJZClcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRzZWxlY3RlZERpc3BsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3B0aW9ucy1saXN0LnNob3cnKS5mb3JFYWNoKGxpc3QgPT4ge1xyXG5cdFx0XHRcdGlmIChsaXN0ICE9PSBvcHRpb25zTGlzdCkge1xyXG5cdFx0XHRcdFx0bGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0b3B0aW9uc0xpc3QuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuICgpID0+IHNlbGVjdGVkVmFsdWU7XHJcblx0fTtcclxuXHJcblx0YXN5bmMgb25PcGVuKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHR0aGlzLnRpdGxlRWwuc2V0VGV4dCgnXHU1MjA2XHU0RUFCXHU4QTJEXHU1QjlBJyk7XHJcblxyXG5cdFx0Y29uc3QgZHJvcGRvd25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnZHJvcGRvd24tY29udGFpbmVyJyB9KTtcclxuXHRcdGRyb3Bkb3duQ29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogXCJcdTUyNERcdTZCMjFcdTUyMDZcdTRFQUIgaWQgXHVGRjFBXCIsIGNsczogJ2lkLWEnIH0pO1xyXG5cdFx0dGhpcy5pZExhYmVsID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJywge1xyXG5cdFx0XHR0ZXh0OiAnXHU3MTIxJyxcclxuXHRcdFx0Y2xzOiAnaWQtYSBpZC1zJ1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLnByZXZpZXdBcmVhID0gZHJvcGRvd25Db250YWluZXIuY3JlYXRlRWwoJ3RleHRhcmVhJywgeyBjbHM6IFwicHJldmlldy1hcmVhXCIsIGF0dHI6IHsgcm93czogXCIxMFwiIH0gfSk7XHJcblxyXG5cdFx0Y29uc3QgZ2V0RWRpdFZhbHVlID0gYXdhaXQgdGhpcy5jcmVhdGVEcm9wZG93bihkcm9wZG93bkNvbnRhaW5lciwgJ1x1N0RFOFx1OEYyRlx1NkIwQVx1OTY1MCBcdUZGMUEnLCAnb3duZXInLCBbJ293bmVyJywgJ3NpZ25lZF9pbicsICdndWVzdCddKTtcclxuXHJcblx0XHQvLyBwdXNoXHJcblx0XHRuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcblx0XHRcdC5zZXROYW1lKCdcdTUyMDZcdTRFQUInKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU4MkU1XHU1REYyXHU3RDkzXHU1MjA2XHU0RUFCXHU5MDRFXHU1MjQ3XHU2NzAzXHU1RjM3XHU1MjM2XHU4OTg2XHU4NENCXHU3RERBXHU0RTBBXHU3MjQ4XHU2NzJDJylcclxuXHRcdFx0LmFkZEJ1dHRvbigoYnRuKSA9PlxyXG5cdFx0XHRcdGJ0blxyXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ1B1c2gnKVxyXG5cdFx0XHRcdFx0LnNldEN0YSgpXHJcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHdyaXRlUGVybWlzc2lvbiA9IGdldEVkaXRWYWx1ZSgpO1xyXG5cclxuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xyXG5cdFx0XHRcdFx0XHRjb25zdCB0aXRsZSA9IFwiIyBcIiArIHRoaXMudmlldy5maWxlPy5iYXNlbmFtZSArIFwiXFxuXCI7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnRXaXRob3V0WWFtbCA9IGZpbGVDb250ZW50LnJlcGxhY2UoL14tLS1cXG5bXFxzXFxTXSo/XFxuLS0tXFxuLywgJycpO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gdGl0bGUgKyBjb250ZW50V2l0aG91dFlhbWw7XHJcblxyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5jdXJySWQpIHtcclxuXHJcblx0XHRcdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXBkYXRhTm90ZSh0aGlzLnRva2VuLCBjb250ZW50LCB0aGlzLmN1cnJJZCk7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gYE5vdGUgc2hhcmVkXHVGRjA4VXBkYXRhXHVGRjA5IHN1Y2Nlc3NmdWxseSFgO1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShtZXNzYWdlLCAxMDAwMCkubm90aWNlRWw7XHJcblxyXG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKCdQdXNoXHVGRjA4VXBkYXRhXHVGRjA5ZmFpbGVkOiAnICsgZXJyb3IubWVzc2FnZSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaGFyZU5vdGUodGhpcy50b2tlbiwgY29udGVudCwgeyB3cml0ZVBlcm1pc3Npb24sIHJlYWRQZXJtaXNzaW9uOiB0aGlzLnNldHRpbmdzLnJlYWRQZXJtaXNzaW9uLCBjb21tZW50UGVybWlzc2lvbjogdGhpcy5zZXR0aW5ncy5jb21tZW50UGVybWlzc2lvbiB9KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBsaW5rID0gcmVzcG9uc2UuanNvbi5wdWJsaXNoTGluaztcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGlkID0gcmVzcG9uc2UuanNvbi5pZDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gYE5vdGUgc2hhcmVkIHN1Y2Nlc3NmdWxseSFgO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgYnRuID0gbmV3IE5vdGljZShtZXNzYWdlLCAxMDAwMCkubm90aWNlRWw7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0YnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cub3BlbihsaW5rLCAnX2JsYW5rJyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChsaW5rKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR1cGRhdGVFZGl0b3JZYW1sKHRoaXMuZWRpdG9yLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFtcImhhY2ttZC1saW5rLVwiICsgd3JpdGVQZXJtaXNzaW9uXTogbGluayxcclxuXHRcdFx0XHRcdFx0XHRcdFx0W1wiaGFja21kLWlkLVwiICsgd3JpdGVQZXJtaXNzaW9uXTogaWRcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnUHVzaCBmYWlsZWQ6ICcgKyBlcnJvci5tZXNzYWdlKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0XHRcdH0pKTtcclxuXHRcdC8vIHB1bGxcclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuXHRcdFx0LnNldE5hbWUoJ1x1NTQwOFx1NEY3NScpXHJcblx0XHRcdC5zZXREZXNjKCdcdTkwMEZcdTkwNEVcdTRFMEFcdTY1QjlcdTk4MTBcdTg5QkRcdTY4NDZcdTRGRUVcdTY1MzlcdTVGOENcdTYzMDlcdTRFMEIgUHVsbCBcdTY3MDNcdTU0MDhcdTRGNzVcdTgxRjNcdTY3MkNcdTU3MzBcdTY1ODdcdTRFRjZcdTRFMjZcdTRGRERcdTc1NTlcdTU0MDhcdTRGNzVcdTg4NURcdTdBODEnKVxyXG5cdFx0XHQuYWRkQnV0dG9uKChidG4pID0+XHJcblx0XHRcdFx0YnRuXHJcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnUHVsbCcpXHJcblx0XHRcdFx0XHQuc2V0Q3RhKClcclxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0aWYgKCF0aGlzLmN1cnJJZCkge1xyXG5cdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJObyBvbmxpbmUgdmVyc2lvblwiKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0Y29uc3Qgb2xkQ29udGVudCA9IHRoaXMuZWRpdG9yLmdldFZhbHVlKCk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IG9sZENvbnRlbnRXaXRob3V0WWFtbCA9IG9sZENvbnRlbnQucmVwbGFjZSgvXi0tLVxcbltcXHNcXFNdKj9cXG4tLS1cXG4vLCAnJyk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IG1hdGNoID0gb2xkQ29udGVudC5tYXRjaCgvXigtLS1cXG5bXFxzXFxTXSo/XFxuLS0tKS8pO1xyXG5cdFx0XHRcdFx0XHRjb25zdCB5YW1sID0gbWF0Y2ggPyBtYXRjaFsxXSArIFwiXFxuXCIgOiBcIlwiO1xyXG5cclxuXHRcdFx0XHRcdFx0Y29uc3QgbmV3Q29udGVudCA9IHRoaXMucHJldmlld0FyZWEudmFsdWU7XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gZ2VuZXJhdGVNZXJnZUNvbmZsaWN0RmlsZShvbGRDb250ZW50V2l0aG91dFlhbWwsIG5ld0NvbnRlbnQpXHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLmVkaXRvci5zZXRWYWx1ZSh5YW1sICsgY29udGVudClcclxuXHRcdFx0XHRcdFx0Y29uc3QgbWVzc2FnZSA9IGBQdWxsIHN1Y2Nlc3NmdWxseWA7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UobWVzc2FnZSwgMTAwMDApLm5vdGljZUVsO1xyXG5cclxuXHRcdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0XHRcdFx0fSkpO1xyXG5cclxuXHRcdC8vIHB1bGwtZlxyXG5cdFx0bmV3IFNldHRpbmcoY29udGVudEVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnXHU1RjM3XHU1MjM2XHU1NDA4XHU0Rjc1JylcclxuXHRcdFx0LnNldERlc2MoJ1x1OTAwRlx1OTA0RVx1NEUwQVx1NjVCOVx1OTgxMFx1ODlCRFx1Njg0Nlx1NEZFRVx1NjUzOVx1NUY4Q1x1NjMwOVx1NEUwQiBQdWxsIFx1NjcwM1x1NUYzN1x1NTIzNlx1ODk4Nlx1ODRDQlx1NjcyQ1x1NTczMFx1NjU4N1x1NEVGNicpXHJcblx0XHRcdC5hZGRCdXR0b24oKGJ0bikgPT5cclxuXHRcdFx0XHRidG5cclxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdQdWxsJylcclxuXHRcdFx0XHRcdC5zZXRDdGEoKVxyXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuY3VycklkKSB7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShcIk5vIG9ubGluZSB2ZXJzaW9uXCIpO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVyblxyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBvbGRDb250ZW50ID0gdGhpcy5lZGl0b3IuZ2V0VmFsdWUoKTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBvbGRDb250ZW50Lm1hdGNoKC9eKC0tLVxcbltcXHNcXFNdKj9cXG4tLS0pLyk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHlhbWwgPSBtYXRjaCA/IG1hdGNoWzFdICsgXCJcXG5cIiA6IFwiXCI7XHJcblx0XHRcdFx0XHRcdGNvbnN0IG5ld0NvbnRlbnQgPSB0aGlzLnByZXZpZXdBcmVhLnZhbHVlO1xyXG5cclxuXHRcdFx0XHRcdFx0dGhpcy5lZGl0b3Iuc2V0VmFsdWUoeWFtbCArIG5ld0NvbnRlbnQpXHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBtZXNzYWdlID0gYFB1bGwgc3VjY2Vzc2Z1bGx5YDtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShtZXNzYWdlLCAxMDAwMCkubm90aWNlRWw7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHRcdFx0XHR9KSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGVudEVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnXHU2MkM5XHU1M0Q2XHU1MjMwXHU2NUIwXHU2QTk0XHU2ODQ4JylcclxuXHRcdFx0LnNldERlc2MoJ1x1OTAwRlx1OTA0RVx1NEUwQVx1NjVCOVx1OTgxMFx1ODlCRFx1Njg0Nlx1NEZFRVx1NjUzOVx1NUY4Q1x1NjMwOVx1NEUwQiBQdWxsIFx1NjcwM1x1NjJDOVx1NTNENlx1OTA2MFx1N0FFRlx1NzI0OFx1NjcyQ1x1NEUyNlx1NTcyOFx1NzU3Nlx1NTI0RFx1NzZFRVx1OTMwNFx1NUVGQVx1N0FDQlx1NjVCMFx1NkE5NFx1Njg0OCcpXHJcblx0XHRcdC5hZGRCdXR0b24oKGJ0bikgPT5cclxuXHRcdFx0XHRidG5cclxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdQdWxsJylcclxuXHRcdFx0XHRcdC5zZXRDdGEoKVxyXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuY3VycklkKSB7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShcIk5vIG9ubGluZSB2ZXJzaW9uXCIpO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRjb25zdCB3cml0ZVBlcm1pc3Npb24gPSBnZXRFZGl0VmFsdWUoKTtcclxuXHJcblx0XHRcdFx0XHRcdGNvbnN0IG9sZENvbnRlbnQgPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBtYXRjaCA9IG9sZENvbnRlbnQubWF0Y2goL14oLS0tXFxuW1xcc1xcU10qP1xcbi0tLSkvKTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgeWFtbCA9IG1hdGNoID8gbWF0Y2hbMV0gKyBcIlxcblwiIDogXCJcIjtcclxuXHRcdFx0XHRcdFx0Y29uc3QgbmV3Q29udGVudCA9IHRoaXMucHJldmlld0FyZWEudmFsdWU7XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRcdFx0XHRcdGlmICghY3VycmVudEZpbGUpIHtcclxuXHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiTm8gYWN0aXZlIGZpbGVcIik7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRjb25zdCByZW1vdGVJbmZvID0ge1xyXG5cdFx0XHRcdFx0XHRcdHBlcm1pc3Npb246IHdyaXRlUGVybWlzc2lvbixcclxuXHRcdFx0XHRcdFx0XHRwdWxsVGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoXCJUXCIsIFwiIFwiKS5yZXBsYWNlKC86L2csIFwiLlwiKVxyXG5cdFx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdFx0Y29uc3QgbmV3RmlsZSA9IGF3YWl0IGNyZWF0ZVJlbW90ZVZlcnNpb25GaWxlKFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRcdFx0XHRcdGN1cnJlbnRGaWxlLnBhcmVudCEucGF0aCxcclxuXHRcdFx0XHRcdFx0XHRjdXJyZW50RmlsZS5uYW1lLFxyXG5cdFx0XHRcdFx0XHRcdHlhbWwgKyBuZXdDb250ZW50LFxyXG5cdFx0XHRcdFx0XHRcdHJlbW90ZUluZm9cclxuXHRcdFx0XHRcdFx0KTtcclxuXHJcblx0XHRcdFx0XHRcdGlmIChuZXdGaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgQ3JlYXRlZCByZW1vdGUgdmVyc2lvbiBmaWxlOiAke25ld0ZpbGUubmFtZX1gLCA1MDAwKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHR9XHJcblxyXG5cdG9uQ2xvc2UoKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogaGFja21kUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBoYWNrbWRQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdoYWNrbWQgYXBpIHRva2VuJylcclxuXHRcdFx0LnNldERlc2MoJ1x1NTNCQlx1NjQxRVx1NEUwMFx1NTAwQlx1NTQyNycpXHJcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG5cdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignRW50ZXIgeW91ciBzZWNyZXQnKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlUb2tlbilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlUb2tlbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSkpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnY29tbWVudFBlcm1pc3Npb24nKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU4QTU1XHU4QUQ2XHU4QTJEXHU1QjlBJylcclxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+XHJcblx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdC5hZGRPcHRpb25zKHtcclxuXHRcdFx0XHRcdFx0J2Rpc2FibGVkJzogJ1x1OTVEQ1x1OTU4OScsXHJcblx0XHRcdFx0XHRcdCdmb3JiaWRkZW4nOiAnXHU3OTgxXHU3NTI4JyxcclxuXHRcdFx0XHRcdFx0J293bmVyJzogJ1x1NTBDNVx1NjRDMVx1NjcwOVx1ODAwNScsXHJcblx0XHRcdFx0XHRcdCdzaWduZWRfaW4nOiAnXHU3NjdCXHU1MTY1XHU3NTI4XHU2MjM2JyxcclxuXHRcdFx0XHRcdFx0J2d1ZXN0JzogJ1x1OEEyQVx1NUJBMidcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29tbWVudFBlcm1pc3Npb24gfHwgJ2d1ZXN0JykgLy8gXHU4QTJEXHU1QjlBXHU5ODEwXHU4QTJEXHU1MDNDXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbW1lbnRQZXJtaXNzaW9uID0gdmFsdWU7IC8vIFx1NjZGNFx1NjVCMFx1OTA3OFx1OTgwNVx1NTAzQ1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgLy8gXHU1MTMyXHU1QjU4XHU4QTJEXHU1QjlBXHJcblx0XHRcdFx0XHR9KSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdyZWFkUGVybWlzc2lvbicpXHJcblx0XHRcdC5zZXREZXNjKCdcdTZBQTJcdTg5OTZcdThBMkRcdTVCOUEnKVxyXG5cdFx0XHQuYWRkRHJvcGRvd24oZHJvcGRvd24gPT5cclxuXHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0LmFkZE9wdGlvbnMoe1xyXG5cdFx0XHRcdFx0XHQnb3duZXInOiAnXHU1MEM1XHU2NEMxXHU2NzA5XHU4MDA1JyxcclxuXHRcdFx0XHRcdFx0J3NpZ25lZF9pbic6ICdcdTc2N0JcdTUxNjVcdTc1MjhcdTYyMzYnLFxyXG5cdFx0XHRcdFx0XHQnZ3Vlc3QnOiAnXHU4QTJBXHU1QkEyJ1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb21tZW50UGVybWlzc2lvbiB8fCAnZ3Vlc3QnKSAvLyBcdThBMkRcdTVCOUFcdTk4MTBcdThBMkRcdTUwM0NcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY29tbWVudFBlcm1pc3Npb24gPSB2YWx1ZTsgLy8gXHU2NkY0XHU2NUIwXHU5MDc4XHU5ODA1XHU1MDNDXHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyAvLyBcdTUxMzJcdTVCNThcdThBMkRcdTVCOUFcclxuXHRcdFx0XHRcdH0pKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwsIFJlcXVlc3RVcmxQYXJhbSB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjb25zdCBzaGFyZU5vdGUgPSAoa2V5OiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgcGVybWlzc2lvbjogeyB3cml0ZVBlcm1pc3Npb246IFN0cmluZywgcmVhZFBlcm1pc3Npb246IFN0cmluZywgY29tbWVudFBlcm1pc3Npb246IFN0cmluZyB9KSA9PiB7XHJcbiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcclxuICAgIFwiY29udGVudFwiOiBjb250ZW50LFxyXG4gICAgXCJ3cml0ZVBlcm1pc3Npb25cIjogcGVybWlzc2lvbi53cml0ZVBlcm1pc3Npb24sXHJcbiAgICBcImNvbW1lbnRQZXJtaXNzaW9uXCI6IHBlcm1pc3Npb24uY29tbWVudFBlcm1pc3Npb24sXHJcbiAgICBcInJlYWRQZXJtaXNzaW9uXCI6IHBlcm1pc3Npb24ucmVhZFBlcm1pc3Npb25cclxuICB9KTtcclxuXHJcbiAgY29uc3QgcmVxdWVzdFBhcmFtczogUmVxdWVzdFVybFBhcmFtID0ge1xyXG4gICAgbWV0aG9kOiAncG9zdCcsXHJcbiAgICB1cmw6ICdodHRwczovL2FwaS5oYWNrbWQuaW8vdjEvbm90ZXMnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAnQXV0aG9yaXphdGlvbic6IFwiQmVhcmVyIFwiICsga2V5LFxyXG4gICAgICAnQ29va2llJzogJ2xvY2FsZT1kZXYnLFxyXG4gICAgfSxcclxuICAgIGJvZHk6IGRhdGFcclxuICB9O1xyXG4gIHJldHVybiByZXF1ZXN0VXJsKHJlcXVlc3RQYXJhbXMpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGFOb3RlID0gKGtleTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIGlkOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCBkYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgXCJjb250ZW50XCI6IGNvbnRlbnQsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHJlcXVlc3RQYXJhbXM6IFJlcXVlc3RVcmxQYXJhbSA9IHtcclxuICAgIG1ldGhvZDogJ3BhdGNoJyxcclxuICAgIHVybDogJ2h0dHBzOi8vYXBpLmhhY2ttZC5pby92MS9ub3Rlcy8nICsgaWQsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICdBdXRob3JpemF0aW9uJzogXCJCZWFyZXIgXCIgKyBrZXksXHJcbiAgICAgICdDb29raWUnOiAnbG9jYWxlPWRldicsXHJcbiAgICB9LFxyXG4gICAgYm9keTogZGF0YVxyXG4gIH07XHJcbiAgcmV0dXJuIHJlcXVlc3RVcmwocmVxdWVzdFBhcmFtcylcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldE5vdGUgPSAoa2V5OiBzdHJpbmcsIGlkOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCByZXF1ZXN0UGFyYW1zOiBSZXF1ZXN0VXJsUGFyYW0gPSB7XHJcbiAgICBtZXRob2Q6ICdnZXQnLFxyXG4gICAgdXJsOiAnaHR0cHM6Ly9hcGkuaGFja21kLmlvL3YxL25vdGVzLycgKyBpZCxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgJ0F1dGhvcml6YXRpb24nOiBcIkJlYXJlciBcIiArIGtleSxcclxuICAgICAgJ0Nvb2tpZSc6ICdsb2NhbGU9ZGV2JyxcclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHJlcXVlc3RVcmwocmVxdWVzdFBhcmFtcylcclxufSIsICJmdW5jdGlvbiBEaWZmKCkge31cbkRpZmYucHJvdG90eXBlID0ge1xuICBkaWZmOiBmdW5jdGlvbiBkaWZmKG9sZFN0cmluZywgbmV3U3RyaW5nKSB7XG4gICAgdmFyIF9vcHRpb25zJHRpbWVvdXQ7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICAgIHZhciBjYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2s7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmdW5jdGlvbiBkb25lKHZhbHVlKSB7XG4gICAgICB2YWx1ZSA9IHNlbGYucG9zdFByb2Nlc3ModmFsdWUsIG9wdGlvbnMpO1xuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNhbGxiYWNrKHZhbHVlKTtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFsbG93IHN1YmNsYXNzZXMgdG8gbWFzc2FnZSB0aGUgaW5wdXQgcHJpb3IgdG8gcnVubmluZ1xuICAgIG9sZFN0cmluZyA9IHRoaXMuY2FzdElucHV0KG9sZFN0cmluZywgb3B0aW9ucyk7XG4gICAgbmV3U3RyaW5nID0gdGhpcy5jYXN0SW5wdXQobmV3U3RyaW5nLCBvcHRpb25zKTtcbiAgICBvbGRTdHJpbmcgPSB0aGlzLnJlbW92ZUVtcHR5KHRoaXMudG9rZW5pemUob2xkU3RyaW5nLCBvcHRpb25zKSk7XG4gICAgbmV3U3RyaW5nID0gdGhpcy5yZW1vdmVFbXB0eSh0aGlzLnRva2VuaXplKG5ld1N0cmluZywgb3B0aW9ucykpO1xuICAgIHZhciBuZXdMZW4gPSBuZXdTdHJpbmcubGVuZ3RoLFxuICAgICAgb2xkTGVuID0gb2xkU3RyaW5nLmxlbmd0aDtcbiAgICB2YXIgZWRpdExlbmd0aCA9IDE7XG4gICAgdmFyIG1heEVkaXRMZW5ndGggPSBuZXdMZW4gKyBvbGRMZW47XG4gICAgaWYgKG9wdGlvbnMubWF4RWRpdExlbmd0aCAhPSBudWxsKSB7XG4gICAgICBtYXhFZGl0TGVuZ3RoID0gTWF0aC5taW4obWF4RWRpdExlbmd0aCwgb3B0aW9ucy5tYXhFZGl0TGVuZ3RoKTtcbiAgICB9XG4gICAgdmFyIG1heEV4ZWN1dGlvblRpbWUgPSAoX29wdGlvbnMkdGltZW91dCA9IG9wdGlvbnMudGltZW91dCkgIT09IG51bGwgJiYgX29wdGlvbnMkdGltZW91dCAhPT0gdm9pZCAwID8gX29wdGlvbnMkdGltZW91dCA6IEluZmluaXR5O1xuICAgIHZhciBhYm9ydEFmdGVyVGltZXN0YW1wID0gRGF0ZS5ub3coKSArIG1heEV4ZWN1dGlvblRpbWU7XG4gICAgdmFyIGJlc3RQYXRoID0gW3tcbiAgICAgIG9sZFBvczogLTEsXG4gICAgICBsYXN0Q29tcG9uZW50OiB1bmRlZmluZWRcbiAgICB9XTtcblxuICAgIC8vIFNlZWQgZWRpdExlbmd0aCA9IDAsIGkuZS4gdGhlIGNvbnRlbnQgc3RhcnRzIHdpdGggdGhlIHNhbWUgdmFsdWVzXG4gICAgdmFyIG5ld1BvcyA9IHRoaXMuZXh0cmFjdENvbW1vbihiZXN0UGF0aFswXSwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIDAsIG9wdGlvbnMpO1xuICAgIGlmIChiZXN0UGF0aFswXS5vbGRQb3MgKyAxID49IG9sZExlbiAmJiBuZXdQb3MgKyAxID49IG5ld0xlbikge1xuICAgICAgLy8gSWRlbnRpdHkgcGVyIHRoZSBlcXVhbGl0eSBhbmQgdG9rZW5pemVyXG4gICAgICByZXR1cm4gZG9uZShidWlsZFZhbHVlcyhzZWxmLCBiZXN0UGF0aFswXS5sYXN0Q29tcG9uZW50LCBuZXdTdHJpbmcsIG9sZFN0cmluZywgc2VsZi51c2VMb25nZXN0VG9rZW4pKTtcbiAgICB9XG5cbiAgICAvLyBPbmNlIHdlIGhpdCB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgZWRpdCBncmFwaCBvbiBzb21lIGRpYWdvbmFsIGssIHdlIGNhblxuICAgIC8vIGRlZmluaXRlbHkgcmVhY2ggdGhlIGVuZCBvZiB0aGUgZWRpdCBncmFwaCBpbiBubyBtb3JlIHRoYW4gayBlZGl0cywgc29cbiAgICAvLyB0aGVyZSdzIG5vIHBvaW50IGluIGNvbnNpZGVyaW5nIGFueSBtb3ZlcyB0byBkaWFnb25hbCBrKzEgYW55IG1vcmUgKGZyb21cbiAgICAvLyB3aGljaCB3ZSdyZSBndWFyYW50ZWVkIHRvIG5lZWQgYXQgbGVhc3QgaysxIG1vcmUgZWRpdHMpLlxuICAgIC8vIFNpbWlsYXJseSwgb25jZSB3ZSd2ZSByZWFjaGVkIHRoZSBib3R0b20gb2YgdGhlIGVkaXQgZ3JhcGgsIHRoZXJlJ3Mgbm9cbiAgICAvLyBwb2ludCBjb25zaWRlcmluZyBtb3ZlcyB0byBsb3dlciBkaWFnb25hbHMuXG4gICAgLy8gV2UgcmVjb3JkIHRoaXMgZmFjdCBieSBzZXR0aW5nIG1pbkRpYWdvbmFsVG9Db25zaWRlciBhbmRcbiAgICAvLyBtYXhEaWFnb25hbFRvQ29uc2lkZXIgdG8gc29tZSBmaW5pdGUgdmFsdWUgb25jZSB3ZSd2ZSBoaXQgdGhlIGVkZ2Ugb2ZcbiAgICAvLyB0aGUgZWRpdCBncmFwaC5cbiAgICAvLyBUaGlzIG9wdGltaXphdGlvbiBpcyBub3QgZmFpdGhmdWwgdG8gdGhlIG9yaWdpbmFsIGFsZ29yaXRobSBwcmVzZW50ZWQgaW5cbiAgICAvLyBNeWVycydzIHBhcGVyLCB3aGljaCBpbnN0ZWFkIHBvaW50bGVzc2x5IGV4dGVuZHMgRC1wYXRocyBvZmYgdGhlIGVuZCBvZlxuICAgIC8vIHRoZSBlZGl0IGdyYXBoIC0gc2VlIHBhZ2UgNyBvZiBNeWVycydzIHBhcGVyIHdoaWNoIG5vdGVzIHRoaXMgcG9pbnRcbiAgICAvLyBleHBsaWNpdGx5IGFuZCBpbGx1c3RyYXRlcyBpdCB3aXRoIGEgZGlhZ3JhbS4gVGhpcyBoYXMgbWFqb3IgcGVyZm9ybWFuY2VcbiAgICAvLyBpbXBsaWNhdGlvbnMgZm9yIHNvbWUgY29tbW9uIHNjZW5hcmlvcy4gRm9yIGluc3RhbmNlLCB0byBjb21wdXRlIGEgZGlmZlxuICAgIC8vIHdoZXJlIHRoZSBuZXcgdGV4dCBzaW1wbHkgYXBwZW5kcyBkIGNoYXJhY3RlcnMgb24gdGhlIGVuZCBvZiB0aGVcbiAgICAvLyBvcmlnaW5hbCB0ZXh0IG9mIGxlbmd0aCBuLCB0aGUgdHJ1ZSBNeWVycyBhbGdvcml0aG0gd2lsbCB0YWtlIE8obitkXjIpXG4gICAgLy8gdGltZSB3aGlsZSB0aGlzIG9wdGltaXphdGlvbiBuZWVkcyBvbmx5IE8obitkKSB0aW1lLlxuICAgIHZhciBtaW5EaWFnb25hbFRvQ29uc2lkZXIgPSAtSW5maW5pdHksXG4gICAgICBtYXhEaWFnb25hbFRvQ29uc2lkZXIgPSBJbmZpbml0eTtcblxuICAgIC8vIE1haW4gd29ya2VyIG1ldGhvZC4gY2hlY2tzIGFsbCBwZXJtdXRhdGlvbnMgb2YgYSBnaXZlbiBlZGl0IGxlbmd0aCBmb3IgYWNjZXB0YW5jZS5cbiAgICBmdW5jdGlvbiBleGVjRWRpdExlbmd0aCgpIHtcbiAgICAgIGZvciAodmFyIGRpYWdvbmFsUGF0aCA9IE1hdGgubWF4KG1pbkRpYWdvbmFsVG9Db25zaWRlciwgLWVkaXRMZW5ndGgpOyBkaWFnb25hbFBhdGggPD0gTWF0aC5taW4obWF4RGlhZ29uYWxUb0NvbnNpZGVyLCBlZGl0TGVuZ3RoKTsgZGlhZ29uYWxQYXRoICs9IDIpIHtcbiAgICAgICAgdmFyIGJhc2VQYXRoID0gdm9pZCAwO1xuICAgICAgICB2YXIgcmVtb3ZlUGF0aCA9IGJlc3RQYXRoW2RpYWdvbmFsUGF0aCAtIDFdLFxuICAgICAgICAgIGFkZFBhdGggPSBiZXN0UGF0aFtkaWFnb25hbFBhdGggKyAxXTtcbiAgICAgICAgaWYgKHJlbW92ZVBhdGgpIHtcbiAgICAgICAgICAvLyBObyBvbmUgZWxzZSBpcyBnb2luZyB0byBhdHRlbXB0IHRvIHVzZSB0aGlzIHZhbHVlLCBjbGVhciBpdFxuICAgICAgICAgIGJlc3RQYXRoW2RpYWdvbmFsUGF0aCAtIDFdID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjYW5BZGQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGFkZFBhdGgpIHtcbiAgICAgICAgICAvLyB3aGF0IG5ld1BvcyB3aWxsIGJlIGFmdGVyIHdlIGRvIGFuIGluc2VydGlvbjpcbiAgICAgICAgICB2YXIgYWRkUGF0aE5ld1BvcyA9IGFkZFBhdGgub2xkUG9zIC0gZGlhZ29uYWxQYXRoO1xuICAgICAgICAgIGNhbkFkZCA9IGFkZFBhdGggJiYgMCA8PSBhZGRQYXRoTmV3UG9zICYmIGFkZFBhdGhOZXdQb3MgPCBuZXdMZW47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhblJlbW92ZSA9IHJlbW92ZVBhdGggJiYgcmVtb3ZlUGF0aC5vbGRQb3MgKyAxIDwgb2xkTGVuO1xuICAgICAgICBpZiAoIWNhbkFkZCAmJiAhY2FuUmVtb3ZlKSB7XG4gICAgICAgICAgLy8gSWYgdGhpcyBwYXRoIGlzIGEgdGVybWluYWwgdGhlbiBwcnVuZVxuICAgICAgICAgIGJlc3RQYXRoW2RpYWdvbmFsUGF0aF0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGRpYWdvbmFsIHRoYXQgd2Ugd2FudCB0byBicmFuY2ggZnJvbS4gV2Ugc2VsZWN0IHRoZSBwcmlvclxuICAgICAgICAvLyBwYXRoIHdob3NlIHBvc2l0aW9uIGluIHRoZSBvbGQgc3RyaW5nIGlzIHRoZSBmYXJ0aGVzdCBmcm9tIHRoZSBvcmlnaW5cbiAgICAgICAgLy8gYW5kIGRvZXMgbm90IHBhc3MgdGhlIGJvdW5kcyBvZiB0aGUgZGlmZiBncmFwaFxuICAgICAgICBpZiAoIWNhblJlbW92ZSB8fCBjYW5BZGQgJiYgcmVtb3ZlUGF0aC5vbGRQb3MgPCBhZGRQYXRoLm9sZFBvcykge1xuICAgICAgICAgIGJhc2VQYXRoID0gc2VsZi5hZGRUb1BhdGgoYWRkUGF0aCwgdHJ1ZSwgZmFsc2UsIDAsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJhc2VQYXRoID0gc2VsZi5hZGRUb1BhdGgocmVtb3ZlUGF0aCwgZmFsc2UsIHRydWUsIDEsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIG5ld1BvcyA9IHNlbGYuZXh0cmFjdENvbW1vbihiYXNlUGF0aCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIGRpYWdvbmFsUGF0aCwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChiYXNlUGF0aC5vbGRQb3MgKyAxID49IG9sZExlbiAmJiBuZXdQb3MgKyAxID49IG5ld0xlbikge1xuICAgICAgICAgIC8vIElmIHdlIGhhdmUgaGl0IHRoZSBlbmQgb2YgYm90aCBzdHJpbmdzLCB0aGVuIHdlIGFyZSBkb25lXG4gICAgICAgICAgcmV0dXJuIGRvbmUoYnVpbGRWYWx1ZXMoc2VsZiwgYmFzZVBhdGgubGFzdENvbXBvbmVudCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIHNlbGYudXNlTG9uZ2VzdFRva2VuKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmVzdFBhdGhbZGlhZ29uYWxQYXRoXSA9IGJhc2VQYXRoO1xuICAgICAgICAgIGlmIChiYXNlUGF0aC5vbGRQb3MgKyAxID49IG9sZExlbikge1xuICAgICAgICAgICAgbWF4RGlhZ29uYWxUb0NvbnNpZGVyID0gTWF0aC5taW4obWF4RGlhZ29uYWxUb0NvbnNpZGVyLCBkaWFnb25hbFBhdGggLSAxKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5ld1BvcyArIDEgPj0gbmV3TGVuKSB7XG4gICAgICAgICAgICBtaW5EaWFnb25hbFRvQ29uc2lkZXIgPSBNYXRoLm1heChtaW5EaWFnb25hbFRvQ29uc2lkZXIsIGRpYWdvbmFsUGF0aCArIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWRpdExlbmd0aCsrO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1zIHRoZSBsZW5ndGggb2YgZWRpdCBpdGVyYXRpb24uIElzIGEgYml0IGZ1Z2x5IGFzIHRoaXMgaGFzIHRvIHN1cHBvcnQgdGhlXG4gICAgLy8gc3luYyBhbmQgYXN5bmMgbW9kZSB3aGljaCBpcyBuZXZlciBmdW4uIExvb3BzIG92ZXIgZXhlY0VkaXRMZW5ndGggdW50aWwgYSB2YWx1ZVxuICAgIC8vIGlzIHByb2R1Y2VkLCBvciB1bnRpbCB0aGUgZWRpdCBsZW5ndGggZXhjZWVkcyBvcHRpb25zLm1heEVkaXRMZW5ndGggKGlmIGdpdmVuKSxcbiAgICAvLyBpbiB3aGljaCBjYXNlIGl0IHdpbGwgcmV0dXJuIHVuZGVmaW5lZC5cbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgIChmdW5jdGlvbiBleGVjKCkge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoZWRpdExlbmd0aCA+IG1heEVkaXRMZW5ndGggfHwgRGF0ZS5ub3coKSA+IGFib3J0QWZ0ZXJUaW1lc3RhbXApIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWV4ZWNFZGl0TGVuZ3RoKCkpIHtcbiAgICAgICAgICAgIGV4ZWMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDApO1xuICAgICAgfSkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGVkaXRMZW5ndGggPD0gbWF4RWRpdExlbmd0aCAmJiBEYXRlLm5vdygpIDw9IGFib3J0QWZ0ZXJUaW1lc3RhbXApIHtcbiAgICAgICAgdmFyIHJldCA9IGV4ZWNFZGl0TGVuZ3RoKCk7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhZGRUb1BhdGg6IGZ1bmN0aW9uIGFkZFRvUGF0aChwYXRoLCBhZGRlZCwgcmVtb3ZlZCwgb2xkUG9zSW5jLCBvcHRpb25zKSB7XG4gICAgdmFyIGxhc3QgPSBwYXRoLmxhc3RDb21wb25lbnQ7XG4gICAgaWYgKGxhc3QgJiYgIW9wdGlvbnMub25lQ2hhbmdlUGVyVG9rZW4gJiYgbGFzdC5hZGRlZCA9PT0gYWRkZWQgJiYgbGFzdC5yZW1vdmVkID09PSByZW1vdmVkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvbGRQb3M6IHBhdGgub2xkUG9zICsgb2xkUG9zSW5jLFxuICAgICAgICBsYXN0Q29tcG9uZW50OiB7XG4gICAgICAgICAgY291bnQ6IGxhc3QuY291bnQgKyAxLFxuICAgICAgICAgIGFkZGVkOiBhZGRlZCxcbiAgICAgICAgICByZW1vdmVkOiByZW1vdmVkLFxuICAgICAgICAgIHByZXZpb3VzQ29tcG9uZW50OiBsYXN0LnByZXZpb3VzQ29tcG9uZW50XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9sZFBvczogcGF0aC5vbGRQb3MgKyBvbGRQb3NJbmMsXG4gICAgICAgIGxhc3RDb21wb25lbnQ6IHtcbiAgICAgICAgICBjb3VudDogMSxcbiAgICAgICAgICBhZGRlZDogYWRkZWQsXG4gICAgICAgICAgcmVtb3ZlZDogcmVtb3ZlZCxcbiAgICAgICAgICBwcmV2aW91c0NvbXBvbmVudDogbGFzdFxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSxcbiAgZXh0cmFjdENvbW1vbjogZnVuY3Rpb24gZXh0cmFjdENvbW1vbihiYXNlUGF0aCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIGRpYWdvbmFsUGF0aCwgb3B0aW9ucykge1xuICAgIHZhciBuZXdMZW4gPSBuZXdTdHJpbmcubGVuZ3RoLFxuICAgICAgb2xkTGVuID0gb2xkU3RyaW5nLmxlbmd0aCxcbiAgICAgIG9sZFBvcyA9IGJhc2VQYXRoLm9sZFBvcyxcbiAgICAgIG5ld1BvcyA9IG9sZFBvcyAtIGRpYWdvbmFsUGF0aCxcbiAgICAgIGNvbW1vbkNvdW50ID0gMDtcbiAgICB3aGlsZSAobmV3UG9zICsgMSA8IG5ld0xlbiAmJiBvbGRQb3MgKyAxIDwgb2xkTGVuICYmIHRoaXMuZXF1YWxzKG9sZFN0cmluZ1tvbGRQb3MgKyAxXSwgbmV3U3RyaW5nW25ld1BvcyArIDFdLCBvcHRpb25zKSkge1xuICAgICAgbmV3UG9zKys7XG4gICAgICBvbGRQb3MrKztcbiAgICAgIGNvbW1vbkNvdW50Kys7XG4gICAgICBpZiAob3B0aW9ucy5vbmVDaGFuZ2VQZXJUb2tlbikge1xuICAgICAgICBiYXNlUGF0aC5sYXN0Q29tcG9uZW50ID0ge1xuICAgICAgICAgIGNvdW50OiAxLFxuICAgICAgICAgIHByZXZpb3VzQ29tcG9uZW50OiBiYXNlUGF0aC5sYXN0Q29tcG9uZW50LFxuICAgICAgICAgIGFkZGVkOiBmYWxzZSxcbiAgICAgICAgICByZW1vdmVkOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29tbW9uQ291bnQgJiYgIW9wdGlvbnMub25lQ2hhbmdlUGVyVG9rZW4pIHtcbiAgICAgIGJhc2VQYXRoLmxhc3RDb21wb25lbnQgPSB7XG4gICAgICAgIGNvdW50OiBjb21tb25Db3VudCxcbiAgICAgICAgcHJldmlvdXNDb21wb25lbnQ6IGJhc2VQYXRoLmxhc3RDb21wb25lbnQsXG4gICAgICAgIGFkZGVkOiBmYWxzZSxcbiAgICAgICAgcmVtb3ZlZDogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICAgIGJhc2VQYXRoLm9sZFBvcyA9IG9sZFBvcztcbiAgICByZXR1cm4gbmV3UG9zO1xuICB9LFxuICBlcXVhbHM6IGZ1bmN0aW9uIGVxdWFscyhsZWZ0LCByaWdodCwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLmNvbXBhcmF0b3IpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmNvbXBhcmF0b3IobGVmdCwgcmlnaHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbGVmdCA9PT0gcmlnaHQgfHwgb3B0aW9ucy5pZ25vcmVDYXNlICYmIGxlZnQudG9Mb3dlckNhc2UoKSA9PT0gcmlnaHQudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZUVtcHR5OiBmdW5jdGlvbiByZW1vdmVFbXB0eShhcnJheSkge1xuICAgIHZhciByZXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYXJyYXlbaV0pIHtcbiAgICAgICAgcmV0LnB1c2goYXJyYXlbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9LFxuICBjYXN0SW5wdXQ6IGZ1bmN0aW9uIGNhc3RJbnB1dCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdG9rZW5pemU6IGZ1bmN0aW9uIHRva2VuaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odmFsdWUpO1xuICB9LFxuICBqb2luOiBmdW5jdGlvbiBqb2luKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICB9LFxuICBwb3N0UHJvY2VzczogZnVuY3Rpb24gcG9zdFByb2Nlc3MoY2hhbmdlT2JqZWN0cykge1xuICAgIHJldHVybiBjaGFuZ2VPYmplY3RzO1xuICB9XG59O1xuZnVuY3Rpb24gYnVpbGRWYWx1ZXMoZGlmZiwgbGFzdENvbXBvbmVudCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIHVzZUxvbmdlc3RUb2tlbikge1xuICAvLyBGaXJzdCB3ZSBjb252ZXJ0IG91ciBsaW5rZWQgbGlzdCBvZiBjb21wb25lbnRzIGluIHJldmVyc2Ugb3JkZXIgdG8gYW5cbiAgLy8gYXJyYXkgaW4gdGhlIHJpZ2h0IG9yZGVyOlxuICB2YXIgY29tcG9uZW50cyA9IFtdO1xuICB2YXIgbmV4dENvbXBvbmVudDtcbiAgd2hpbGUgKGxhc3RDb21wb25lbnQpIHtcbiAgICBjb21wb25lbnRzLnB1c2gobGFzdENvbXBvbmVudCk7XG4gICAgbmV4dENvbXBvbmVudCA9IGxhc3RDb21wb25lbnQucHJldmlvdXNDb21wb25lbnQ7XG4gICAgZGVsZXRlIGxhc3RDb21wb25lbnQucHJldmlvdXNDb21wb25lbnQ7XG4gICAgbGFzdENvbXBvbmVudCA9IG5leHRDb21wb25lbnQ7XG4gIH1cbiAgY29tcG9uZW50cy5yZXZlcnNlKCk7XG4gIHZhciBjb21wb25lbnRQb3MgPSAwLFxuICAgIGNvbXBvbmVudExlbiA9IGNvbXBvbmVudHMubGVuZ3RoLFxuICAgIG5ld1BvcyA9IDAsXG4gICAgb2xkUG9zID0gMDtcbiAgZm9yICg7IGNvbXBvbmVudFBvcyA8IGNvbXBvbmVudExlbjsgY29tcG9uZW50UG9zKyspIHtcbiAgICB2YXIgY29tcG9uZW50ID0gY29tcG9uZW50c1tjb21wb25lbnRQb3NdO1xuICAgIGlmICghY29tcG9uZW50LnJlbW92ZWQpIHtcbiAgICAgIGlmICghY29tcG9uZW50LmFkZGVkICYmIHVzZUxvbmdlc3RUb2tlbikge1xuICAgICAgICB2YXIgdmFsdWUgPSBuZXdTdHJpbmcuc2xpY2UobmV3UG9zLCBuZXdQb3MgKyBjb21wb25lbnQuY291bnQpO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLm1hcChmdW5jdGlvbiAodmFsdWUsIGkpIHtcbiAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBvbGRTdHJpbmdbb2xkUG9zICsgaV07XG4gICAgICAgICAgcmV0dXJuIG9sZFZhbHVlLmxlbmd0aCA+IHZhbHVlLmxlbmd0aCA/IG9sZFZhbHVlIDogdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjb21wb25lbnQudmFsdWUgPSBkaWZmLmpvaW4odmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcG9uZW50LnZhbHVlID0gZGlmZi5qb2luKG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCkpO1xuICAgICAgfVxuICAgICAgbmV3UG9zICs9IGNvbXBvbmVudC5jb3VudDtcblxuICAgICAgLy8gQ29tbW9uIGNhc2VcbiAgICAgIGlmICghY29tcG9uZW50LmFkZGVkKSB7XG4gICAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbXBvbmVudC52YWx1ZSA9IGRpZmYuam9pbihvbGRTdHJpbmcuc2xpY2Uob2xkUG9zLCBvbGRQb3MgKyBjb21wb25lbnQuY291bnQpKTtcbiAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBjb21wb25lbnRzO1xufVxuXG52YXIgY2hhcmFjdGVyRGlmZiA9IG5ldyBEaWZmKCk7XG5mdW5jdGlvbiBkaWZmQ2hhcnMob2xkU3RyLCBuZXdTdHIsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNoYXJhY3RlckRpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIGxvbmdlc3RDb21tb25QcmVmaXgoc3RyMSwgc3RyMikge1xuICB2YXIgaTtcbiAgZm9yIChpID0gMDsgaSA8IHN0cjEubGVuZ3RoICYmIGkgPCBzdHIyLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHN0cjFbaV0gIT0gc3RyMltpXSkge1xuICAgICAgcmV0dXJuIHN0cjEuc2xpY2UoMCwgaSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzdHIxLnNsaWNlKDAsIGkpO1xufVxuZnVuY3Rpb24gbG9uZ2VzdENvbW1vblN1ZmZpeChzdHIxLCBzdHIyKSB7XG4gIHZhciBpO1xuXG4gIC8vIFVubGlrZSBsb25nZXN0Q29tbW9uUHJlZml4LCB3ZSBuZWVkIGEgc3BlY2lhbCBjYXNlIHRvIGhhbmRsZSBhbGwgc2NlbmFyaW9zXG4gIC8vIHdoZXJlIHdlIHJldHVybiB0aGUgZW1wdHkgc3RyaW5nIHNpbmNlIHN0cjEuc2xpY2UoLTApIHdpbGwgcmV0dXJuIHRoZVxuICAvLyBlbnRpcmUgc3RyaW5nLlxuICBpZiAoIXN0cjEgfHwgIXN0cjIgfHwgc3RyMVtzdHIxLmxlbmd0aCAtIDFdICE9IHN0cjJbc3RyMi5sZW5ndGggLSAxXSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgc3RyMS5sZW5ndGggJiYgaSA8IHN0cjIubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RyMVtzdHIxLmxlbmd0aCAtIChpICsgMSldICE9IHN0cjJbc3RyMi5sZW5ndGggLSAoaSArIDEpXSkge1xuICAgICAgcmV0dXJuIHN0cjEuc2xpY2UoLWkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc3RyMS5zbGljZSgtaSk7XG59XG5mdW5jdGlvbiByZXBsYWNlUHJlZml4KHN0cmluZywgb2xkUHJlZml4LCBuZXdQcmVmaXgpIHtcbiAgaWYgKHN0cmluZy5zbGljZSgwLCBvbGRQcmVmaXgubGVuZ3RoKSAhPSBvbGRQcmVmaXgpIHtcbiAgICB0aHJvdyBFcnJvcihcInN0cmluZyBcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkoc3RyaW5nKSwgXCIgZG9lc24ndCBzdGFydCB3aXRoIHByZWZpeCBcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KG9sZFByZWZpeCksIFwiOyB0aGlzIGlzIGEgYnVnXCIpKTtcbiAgfVxuICByZXR1cm4gbmV3UHJlZml4ICsgc3RyaW5nLnNsaWNlKG9sZFByZWZpeC5sZW5ndGgpO1xufVxuZnVuY3Rpb24gcmVwbGFjZVN1ZmZpeChzdHJpbmcsIG9sZFN1ZmZpeCwgbmV3U3VmZml4KSB7XG4gIGlmICghb2xkU3VmZml4KSB7XG4gICAgcmV0dXJuIHN0cmluZyArIG5ld1N1ZmZpeDtcbiAgfVxuICBpZiAoc3RyaW5nLnNsaWNlKC1vbGRTdWZmaXgubGVuZ3RoKSAhPSBvbGRTdWZmaXgpIHtcbiAgICB0aHJvdyBFcnJvcihcInN0cmluZyBcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkoc3RyaW5nKSwgXCIgZG9lc24ndCBlbmQgd2l0aCBzdWZmaXggXCIpLmNvbmNhdChKU09OLnN0cmluZ2lmeShvbGRTdWZmaXgpLCBcIjsgdGhpcyBpcyBhIGJ1Z1wiKSk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZy5zbGljZSgwLCAtb2xkU3VmZml4Lmxlbmd0aCkgKyBuZXdTdWZmaXg7XG59XG5mdW5jdGlvbiByZW1vdmVQcmVmaXgoc3RyaW5nLCBvbGRQcmVmaXgpIHtcbiAgcmV0dXJuIHJlcGxhY2VQcmVmaXgoc3RyaW5nLCBvbGRQcmVmaXgsICcnKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZVN1ZmZpeChzdHJpbmcsIG9sZFN1ZmZpeCkge1xuICByZXR1cm4gcmVwbGFjZVN1ZmZpeChzdHJpbmcsIG9sZFN1ZmZpeCwgJycpO1xufVxuZnVuY3Rpb24gbWF4aW11bU92ZXJsYXAoc3RyaW5nMSwgc3RyaW5nMikge1xuICByZXR1cm4gc3RyaW5nMi5zbGljZSgwLCBvdmVybGFwQ291bnQoc3RyaW5nMSwgc3RyaW5nMikpO1xufVxuXG4vLyBOaWNrZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNjA0MjI4NTMvMTcwOTU4N1xuZnVuY3Rpb24gb3ZlcmxhcENvdW50KGEsIGIpIHtcbiAgLy8gRGVhbCB3aXRoIGNhc2VzIHdoZXJlIHRoZSBzdHJpbmdzIGRpZmZlciBpbiBsZW5ndGhcbiAgdmFyIHN0YXJ0QSA9IDA7XG4gIGlmIChhLmxlbmd0aCA+IGIubGVuZ3RoKSB7XG4gICAgc3RhcnRBID0gYS5sZW5ndGggLSBiLmxlbmd0aDtcbiAgfVxuICB2YXIgZW5kQiA9IGIubGVuZ3RoO1xuICBpZiAoYS5sZW5ndGggPCBiLmxlbmd0aCkge1xuICAgIGVuZEIgPSBhLmxlbmd0aDtcbiAgfVxuICAvLyBDcmVhdGUgYSBiYWNrLXJlZmVyZW5jZSBmb3IgZWFjaCBpbmRleFxuICAvLyAgIHRoYXQgc2hvdWxkIGJlIGZvbGxvd2VkIGluIGNhc2Ugb2YgYSBtaXNtYXRjaC5cbiAgLy8gICBXZSBvbmx5IG5lZWQgQiB0byBtYWtlIHRoZXNlIHJlZmVyZW5jZXM6XG4gIHZhciBtYXAgPSBBcnJheShlbmRCKTtcbiAgdmFyIGsgPSAwOyAvLyBJbmRleCB0aGF0IGxhZ3MgYmVoaW5kIGpcbiAgbWFwWzBdID0gMDtcbiAgZm9yICh2YXIgaiA9IDE7IGogPCBlbmRCOyBqKyspIHtcbiAgICBpZiAoYltqXSA9PSBiW2tdKSB7XG4gICAgICBtYXBbal0gPSBtYXBba107IC8vIHNraXAgb3ZlciB0aGUgc2FtZSBjaGFyYWN0ZXIgKG9wdGlvbmFsIG9wdGltaXNhdGlvbilcbiAgICB9IGVsc2Uge1xuICAgICAgbWFwW2pdID0gaztcbiAgICB9XG4gICAgd2hpbGUgKGsgPiAwICYmIGJbal0gIT0gYltrXSkge1xuICAgICAgayA9IG1hcFtrXTtcbiAgICB9XG4gICAgaWYgKGJbal0gPT0gYltrXSkge1xuICAgICAgaysrO1xuICAgIH1cbiAgfVxuICAvLyBQaGFzZSAyOiB1c2UgdGhlc2UgcmVmZXJlbmNlcyB3aGlsZSBpdGVyYXRpbmcgb3ZlciBBXG4gIGsgPSAwO1xuICBmb3IgKHZhciBpID0gc3RhcnRBOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgIHdoaWxlIChrID4gMCAmJiBhW2ldICE9IGJba10pIHtcbiAgICAgIGsgPSBtYXBba107XG4gICAgfVxuICAgIGlmIChhW2ldID09IGJba10pIHtcbiAgICAgIGsrKztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGs7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY29uc2lzdGVudGx5IHVzZXMgV2luZG93cyBsaW5lIGVuZGluZ3MuXG4gKi9cbmZ1bmN0aW9uIGhhc09ubHlXaW5MaW5lRW5kaW5ncyhzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy5pbmNsdWRlcygnXFxyXFxuJykgJiYgIXN0cmluZy5zdGFydHNXaXRoKCdcXG4nKSAmJiAhc3RyaW5nLm1hdGNoKC9bXlxccl1cXG4vKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHN0cmluZyBjb25zaXN0ZW50bHkgdXNlcyBVbml4IGxpbmUgZW5kaW5ncy5cbiAqL1xuZnVuY3Rpb24gaGFzT25seVVuaXhMaW5lRW5kaW5ncyhzdHJpbmcpIHtcbiAgcmV0dXJuICFzdHJpbmcuaW5jbHVkZXMoJ1xcclxcbicpICYmIHN0cmluZy5pbmNsdWRlcygnXFxuJyk7XG59XG5cbi8vIEJhc2VkIG9uIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xhdGluX3NjcmlwdF9pbl9Vbmljb2RlXG4vL1xuLy8gUmFuZ2VzIGFuZCBleGNlcHRpb25zOlxuLy8gTGF0aW4tMSBTdXBwbGVtZW50LCAwMDgwXHUyMDEzMDBGRlxuLy8gIC0gVSswMEQ3ICBcdTAwRDcgTXVsdGlwbGljYXRpb24gc2lnblxuLy8gIC0gVSswMEY3ICBcdTAwRjcgRGl2aXNpb24gc2lnblxuLy8gTGF0aW4gRXh0ZW5kZWQtQSwgMDEwMFx1MjAxMzAxN0Zcbi8vIExhdGluIEV4dGVuZGVkLUIsIDAxODBcdTIwMTMwMjRGXG4vLyBJUEEgRXh0ZW5zaW9ucywgMDI1MFx1MjAxMzAyQUZcbi8vIFNwYWNpbmcgTW9kaWZpZXIgTGV0dGVycywgMDJCMFx1MjAxMzAyRkZcbi8vICAtIFUrMDJDNyAgXHUwMkM3ICYjNzExOyAgQ2Fyb25cbi8vICAtIFUrMDJEOCAgXHUwMkQ4ICYjNzI4OyAgQnJldmVcbi8vICAtIFUrMDJEOSAgXHUwMkQ5ICYjNzI5OyAgRG90IEFib3ZlXG4vLyAgLSBVKzAyREEgIFx1MDJEQSAmIzczMDsgIFJpbmcgQWJvdmVcbi8vICAtIFUrMDJEQiAgXHUwMkRCICYjNzMxOyAgT2dvbmVrXG4vLyAgLSBVKzAyREMgIFx1MDJEQyAmIzczMjsgIFNtYWxsIFRpbGRlXG4vLyAgLSBVKzAyREQgIFx1MDJERCAmIzczMzsgIERvdWJsZSBBY3V0ZSBBY2NlbnRcbi8vIExhdGluIEV4dGVuZGVkIEFkZGl0aW9uYWwsIDFFMDBcdTIwMTMxRUZGXG52YXIgZXh0ZW5kZWRXb3JkQ2hhcnMgPSBcImEtekEtWjAtOV9cXFxcdXtDMH0tXFxcXHV7RkZ9XFxcXHV7RDh9LVxcXFx1e0Y2fVxcXFx1e0Y4fS1cXFxcdXsyQzZ9XFxcXHV7MkM4fS1cXFxcdXsyRDd9XFxcXHV7MkRFfS1cXFxcdXsyRkZ9XFxcXHV7MUUwMH0tXFxcXHV7MUVGRn1cIjtcblxuLy8gRWFjaCB0b2tlbiBpcyBvbmUgb2YgdGhlIGZvbGxvd2luZzpcbi8vIC0gQSBwdW5jdHVhdGlvbiBtYXJrIHBsdXMgdGhlIHN1cnJvdW5kaW5nIHdoaXRlc3BhY2Vcbi8vIC0gQSB3b3JkIHBsdXMgdGhlIHN1cnJvdW5kaW5nIHdoaXRlc3BhY2Vcbi8vIC0gUHVyZSB3aGl0ZXNwYWNlIChidXQgb25seSBpbiB0aGUgc3BlY2lhbCBjYXNlIHdoZXJlIHRoaXMgdGhlIGVudGlyZSB0ZXh0XG4vLyAgIGlzIGp1c3Qgd2hpdGVzcGFjZSlcbi8vXG4vLyBXZSBoYXZlIHRvIGluY2x1ZGUgc3Vycm91bmRpbmcgd2hpdGVzcGFjZSBpbiB0aGUgdG9rZW5zIGJlY2F1c2UgdGhlIHR3b1xuLy8gYWx0ZXJuYXRpdmUgYXBwcm9hY2hlcyBwcm9kdWNlIGhvcnJpYmx5IGJyb2tlbiByZXN1bHRzOlxuLy8gKiBJZiB3ZSBqdXN0IGRpc2NhcmQgdGhlIHdoaXRlc3BhY2UsIHdlIGNhbid0IGZ1bGx5IHJlcHJvZHVjZSB0aGUgb3JpZ2luYWxcbi8vICAgdGV4dCBmcm9tIHRoZSBzZXF1ZW5jZSBvZiB0b2tlbnMgYW5kIGFueSBhdHRlbXB0IHRvIHJlbmRlciB0aGUgZGlmZiB3aWxsXG4vLyAgIGdldCB0aGUgd2hpdGVzcGFjZSB3cm9uZy5cbi8vICogSWYgd2UgaGF2ZSBzZXBhcmF0ZSB0b2tlbnMgZm9yIHdoaXRlc3BhY2UsIHRoZW4gaW4gYSB0eXBpY2FsIHRleHQgZXZlcnlcbi8vICAgc2Vjb25kIHRva2VuIHdpbGwgYmUgYSBzaW5nbGUgc3BhY2UgY2hhcmFjdGVyLiBCdXQgdGhpcyBvZnRlbiByZXN1bHRzIGluXG4vLyAgIHRoZSBvcHRpbWFsIGRpZmYgYmV0d2VlbiB0d28gdGV4dHMgYmVpbmcgYSBwZXJ2ZXJzZSBvbmUgdGhhdCBwcmVzZXJ2ZXNcbi8vICAgdGhlIHNwYWNlcyBiZXR3ZWVuIHdvcmRzIGJ1dCBkZWxldGVzIGFuZCByZWluc2VydHMgYWN0dWFsIGNvbW1vbiB3b3Jkcy5cbi8vICAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9rcGRlY2tlci9qc2RpZmYvaXNzdWVzLzE2MCNpc3N1ZWNvbW1lbnQtMTg2NjA5OTY0MFxuLy8gICBmb3IgYW4gZXhhbXBsZS5cbi8vXG4vLyBLZWVwaW5nIHRoZSBzdXJyb3VuZGluZyB3aGl0ZXNwYWNlIG9mIGNvdXJzZSBoYXMgaW1wbGljYXRpb25zIGZvciAuZXF1YWxzXG4vLyBhbmQgLmpvaW4sIG5vdCBqdXN0IC50b2tlbml6ZS5cblxuLy8gVGhpcyByZWdleCBkb2VzIE5PVCBmdWxseSBpbXBsZW1lbnQgdGhlIHRva2VuaXphdGlvbiBydWxlcyBkZXNjcmliZWQgYWJvdmUuXG4vLyBJbnN0ZWFkLCBpdCBnaXZlcyBydW5zIG9mIHdoaXRlc3BhY2UgdGhlaXIgb3duIFwidG9rZW5cIi4gVGhlIHRva2VuaXplIG1ldGhvZFxuLy8gdGhlbiBoYW5kbGVzIHN0aXRjaGluZyB3aGl0ZXNwYWNlIHRva2VucyBvbnRvIGFkamFjZW50IHdvcmQgb3IgcHVuY3R1YXRpb25cbi8vIHRva2Vucy5cbnZhciB0b2tlbml6ZUluY2x1ZGluZ1doaXRlc3BhY2UgPSBuZXcgUmVnRXhwKFwiW1wiLmNvbmNhdChleHRlbmRlZFdvcmRDaGFycywgXCJdK3xcXFxccyt8W15cIikuY29uY2F0KGV4dGVuZGVkV29yZENoYXJzLCBcIl1cIiksICd1ZycpO1xudmFyIHdvcmREaWZmID0gbmV3IERpZmYoKTtcbndvcmREaWZmLmVxdWFscyA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucy5pZ25vcmVDYXNlKSB7XG4gICAgbGVmdCA9IGxlZnQudG9Mb3dlckNhc2UoKTtcbiAgICByaWdodCA9IHJpZ2h0LnRvTG93ZXJDYXNlKCk7XG4gIH1cbiAgcmV0dXJuIGxlZnQudHJpbSgpID09PSByaWdodC50cmltKCk7XG59O1xud29yZERpZmYudG9rZW5pemUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuICB2YXIgcGFydHM7XG4gIGlmIChvcHRpb25zLmludGxTZWdtZW50ZXIpIHtcbiAgICBpZiAob3B0aW9ucy5pbnRsU2VnbWVudGVyLnJlc29sdmVkT3B0aW9ucygpLmdyYW51bGFyaXR5ICE9ICd3b3JkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc2VnbWVudGVyIHBhc3NlZCBtdXN0IGhhdmUgYSBncmFudWxhcml0eSBvZiBcIndvcmRcIicpO1xuICAgIH1cbiAgICBwYXJ0cyA9IEFycmF5LmZyb20ob3B0aW9ucy5pbnRsU2VnbWVudGVyLnNlZ21lbnQodmFsdWUpLCBmdW5jdGlvbiAoc2VnbWVudCkge1xuICAgICAgcmV0dXJuIHNlZ21lbnQuc2VnbWVudDtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBwYXJ0cyA9IHZhbHVlLm1hdGNoKHRva2VuaXplSW5jbHVkaW5nV2hpdGVzcGFjZSkgfHwgW107XG4gIH1cbiAgdmFyIHRva2VucyA9IFtdO1xuICB2YXIgcHJldlBhcnQgPSBudWxsO1xuICBwYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJ0KSB7XG4gICAgaWYgKC9cXHMvLnRlc3QocGFydCkpIHtcbiAgICAgIGlmIChwcmV2UGFydCA9PSBudWxsKSB7XG4gICAgICAgIHRva2Vucy5wdXNoKHBhcnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG9rZW5zLnB1c2godG9rZW5zLnBvcCgpICsgcGFydCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgvXFxzLy50ZXN0KHByZXZQYXJ0KSkge1xuICAgICAgaWYgKHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV0gPT0gcHJldlBhcnQpIHtcbiAgICAgICAgdG9rZW5zLnB1c2godG9rZW5zLnBvcCgpICsgcGFydCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2tlbnMucHVzaChwcmV2UGFydCArIHBhcnQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0b2tlbnMucHVzaChwYXJ0KTtcbiAgICB9XG4gICAgcHJldlBhcnQgPSBwYXJ0O1xuICB9KTtcbiAgcmV0dXJuIHRva2Vucztcbn07XG53b3JkRGlmZi5qb2luID0gZnVuY3Rpb24gKHRva2Vucykge1xuICAvLyBUb2tlbnMgYmVpbmcgam9pbmVkIGhlcmUgd2lsbCBhbHdheXMgaGF2ZSBhcHBlYXJlZCBjb25zZWN1dGl2ZWx5IGluIHRoZVxuICAvLyBzYW1lIHRleHQsIHNvIHdlIGNhbiBzaW1wbHkgc3RyaXAgb2ZmIHRoZSBsZWFkaW5nIHdoaXRlc3BhY2UgZnJvbSBhbGwgdGhlXG4gIC8vIHRva2VucyBleGNlcHQgdGhlIGZpcnN0IChhbmQgZXhjZXB0IGFueSB3aGl0ZXNwYWNlLW9ubHkgdG9rZW5zIC0gYnV0IHN1Y2hcbiAgLy8gYSB0b2tlbiB3aWxsIGFsd2F5cyBiZSB0aGUgZmlyc3QgYW5kIG9ubHkgdG9rZW4gYW55d2F5KSBhbmQgdGhlbiBqb2luIHRoZW1cbiAgLy8gYW5kIHRoZSB3aGl0ZXNwYWNlIGFyb3VuZCB3b3JkcyBhbmQgcHVuY3R1YXRpb24gd2lsbCBlbmQgdXAgY29ycmVjdC5cbiAgcmV0dXJuIHRva2Vucy5tYXAoZnVuY3Rpb24gKHRva2VuLCBpKSB7XG4gICAgaWYgKGkgPT0gMCkge1xuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdG9rZW4ucmVwbGFjZSgvXlxccysvLCAnJyk7XG4gICAgfVxuICB9KS5qb2luKCcnKTtcbn07XG53b3JkRGlmZi5wb3N0UHJvY2VzcyA9IGZ1bmN0aW9uIChjaGFuZ2VzLCBvcHRpb25zKSB7XG4gIGlmICghY2hhbmdlcyB8fCBvcHRpb25zLm9uZUNoYW5nZVBlclRva2VuKSB7XG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cbiAgdmFyIGxhc3RLZWVwID0gbnVsbDtcbiAgLy8gQ2hhbmdlIG9iamVjdHMgcmVwcmVzZW50aW5nIGFueSBpbnNlcnRpb24gb3IgZGVsZXRpb24gc2luY2UgdGhlIGxhc3RcbiAgLy8gXCJrZWVwXCIgY2hhbmdlIG9iamVjdC4gVGhlcmUgY2FuIGJlIGF0IG1vc3Qgb25lIG9mIGVhY2guXG4gIHZhciBpbnNlcnRpb24gPSBudWxsO1xuICB2YXIgZGVsZXRpb24gPSBudWxsO1xuICBjaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkge1xuICAgIGlmIChjaGFuZ2UuYWRkZWQpIHtcbiAgICAgIGluc2VydGlvbiA9IGNoYW5nZTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZS5yZW1vdmVkKSB7XG4gICAgICBkZWxldGlvbiA9IGNoYW5nZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGluc2VydGlvbiB8fCBkZWxldGlvbikge1xuICAgICAgICAvLyBNYXkgYmUgZmFsc2UgYXQgc3RhcnQgb2YgdGV4dFxuICAgICAgICBkZWR1cGVXaGl0ZXNwYWNlSW5DaGFuZ2VPYmplY3RzKGxhc3RLZWVwLCBkZWxldGlvbiwgaW5zZXJ0aW9uLCBjaGFuZ2UpO1xuICAgICAgfVxuICAgICAgbGFzdEtlZXAgPSBjaGFuZ2U7XG4gICAgICBpbnNlcnRpb24gPSBudWxsO1xuICAgICAgZGVsZXRpb24gPSBudWxsO1xuICAgIH1cbiAgfSk7XG4gIGlmIChpbnNlcnRpb24gfHwgZGVsZXRpb24pIHtcbiAgICBkZWR1cGVXaGl0ZXNwYWNlSW5DaGFuZ2VPYmplY3RzKGxhc3RLZWVwLCBkZWxldGlvbiwgaW5zZXJ0aW9uLCBudWxsKTtcbiAgfVxuICByZXR1cm4gY2hhbmdlcztcbn07XG5mdW5jdGlvbiBkaWZmV29yZHMob2xkU3RyLCBuZXdTdHIsIG9wdGlvbnMpIHtcbiAgLy8gVGhpcyBvcHRpb24gaGFzIG5ldmVyIGJlZW4gZG9jdW1lbnRlZCBhbmQgbmV2ZXIgd2lsbCBiZSAoaXQncyBjbGVhcmVyIHRvXG4gIC8vIGp1c3QgY2FsbCBgZGlmZldvcmRzV2l0aFNwYWNlYCBkaXJlY3RseSBpZiB5b3UgbmVlZCB0aGF0IGJlaGF2aW9yKSwgYnV0XG4gIC8vIGhhcyBleGlzdGVkIGluIGpzZGlmZiBmb3IgYSBsb25nIHRpbWUsIHNvIHdlIHJldGFpbiBzdXBwb3J0IGZvciBpdCBoZXJlXG4gIC8vIGZvciB0aGUgc2FrZSBvZiBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS5cbiAgaWYgKChvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaWdub3JlV2hpdGVzcGFjZSkgIT0gbnVsbCAmJiAhb3B0aW9ucy5pZ25vcmVXaGl0ZXNwYWNlKSB7XG4gICAgcmV0dXJuIGRpZmZXb3Jkc1dpdGhTcGFjZShvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucyk7XG4gIH1cbiAgcmV0dXJuIHdvcmREaWZmLmRpZmYob2xkU3RyLCBuZXdTdHIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gZGVkdXBlV2hpdGVzcGFjZUluQ2hhbmdlT2JqZWN0cyhzdGFydEtlZXAsIGRlbGV0aW9uLCBpbnNlcnRpb24sIGVuZEtlZXApIHtcbiAgLy8gQmVmb3JlIHJldHVybmluZywgd2UgdGlkeSB1cCB0aGUgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZSBvZiB0aGVcbiAgLy8gY2hhbmdlIG9iamVjdHMgdG8gZWxpbWluYXRlIGNhc2VzIHdoZXJlIHRyYWlsaW5nIHdoaXRlc3BhY2UgaW4gb25lIG9iamVjdFxuICAvLyBpcyByZXBlYXRlZCBhcyBsZWFkaW5nIHdoaXRlc3BhY2UgaW4gdGhlIG5leHQuXG4gIC8vIEJlbG93IGFyZSBleGFtcGxlcyBvZiB0aGUgb3V0Y29tZXMgd2Ugd2FudCBoZXJlIHRvIGV4cGxhaW4gdGhlIGNvZGUuXG4gIC8vIEk9aW5zZXJ0LCBLPWtlZXAsIEQ9ZGVsZXRlXG4gIC8vIDEuIGRpZmZpbmcgJ2ZvbyBiYXIgYmF6JyB2cyAnZm9vIGJheidcbiAgLy8gICAgUHJpb3IgdG8gY2xlYW51cCwgd2UgaGF2ZSBLOidmb28gJyBEOicgYmFyICcgSzonIGJheidcbiAgLy8gICAgQWZ0ZXIgY2xlYW51cCwgd2Ugd2FudDogICBLOidmb28gJyBEOidiYXIgJyBLOidiYXonXG4gIC8vXG4gIC8vIDIuIERpZmZpbmcgJ2ZvbyBiYXIgYmF6JyB2cyAnZm9vIHF1eCBiYXonXG4gIC8vICAgIFByaW9yIHRvIGNsZWFudXAsIHdlIGhhdmUgSzonZm9vICcgRDonIGJhciAnIEk6JyBxdXggJyBLOicgYmF6J1xuICAvLyAgICBBZnRlciBjbGVhbnVwLCB3ZSB3YW50IEs6J2ZvbyAnIEQ6J2JhcicgSToncXV4JyBLOicgYmF6J1xuICAvL1xuICAvLyAzLiBEaWZmaW5nICdmb29cXG5iYXIgYmF6JyB2cyAnZm9vIGJheidcbiAgLy8gICAgUHJpb3IgdG8gY2xlYW51cCwgd2UgaGF2ZSBLOidmb28gJyBEOidcXG5iYXIgJyBLOicgYmF6J1xuICAvLyAgICBBZnRlciBjbGVhbnVwLCB3ZSB3YW50IEsnZm9vJyBEOidcXG5iYXInIEs6JyBiYXonXG4gIC8vXG4gIC8vIDQuIERpZmZpbmcgJ2ZvbyBiYXonIHZzICdmb29cXG5iYXIgYmF6J1xuICAvLyAgICBQcmlvciB0byBjbGVhbnVwLCB3ZSBoYXZlIEs6J2Zvb1xcbicgSTonXFxuYmFyICcgSzonIGJheidcbiAgLy8gICAgQWZ0ZXIgY2xlYW51cCwgd2UgaWRlYWxseSB3YW50IEsnZm9vJyBJOidcXG5iYXInIEs6JyBiYXonXG4gIC8vICAgIGJ1dCBkb24ndCBhY3R1YWxseSBtYW5hZ2UgdGhpcyBjdXJyZW50bHkgKHRoZSBwcmUtY2xlYW51cCBjaGFuZ2VcbiAgLy8gICAgb2JqZWN0cyBkb24ndCBjb250YWluIGVub3VnaCBpbmZvcm1hdGlvbiB0byBtYWtlIGl0IHBvc3NpYmxlKS5cbiAgLy9cbiAgLy8gNS4gRGlmZmluZyAnZm9vICAgYmFyIGJheicgdnMgJ2ZvbyAgYmF6J1xuICAvLyAgICBQcmlvciB0byBjbGVhbnVwLCB3ZSBoYXZlIEs6J2ZvbyAgJyBEOicgICBiYXIgJyBLOicgIGJheidcbiAgLy8gICAgQWZ0ZXIgY2xlYW51cCwgd2Ugd2FudCBLOidmb28gICcgRDonIGJhciAnIEs6J2JheidcbiAgLy9cbiAgLy8gT3VyIGhhbmRsaW5nIGlzIHVuYXZvaWRhYmx5IGltcGVyZmVjdCBpbiB0aGUgY2FzZSB3aGVyZSB0aGVyZSdzIGEgc2luZ2xlXG4gIC8vIGluZGVsIGJldHdlZW4ga2VlcHMgYW5kIHRoZSB3aGl0ZXNwYWNlIGhhcyBjaGFuZ2VkLiBGb3IgaW5zdGFuY2UsIGNvbnNpZGVyXG4gIC8vIGRpZmZpbmcgJ2Zvb1xcdGJhclxcbmJheicgdnMgJ2ZvbyBiYXonLiBVbmxlc3Mgd2UgY3JlYXRlIGFuIGV4dHJhIGNoYW5nZVxuICAvLyBvYmplY3QgdG8gcmVwcmVzZW50IHRoZSBpbnNlcnRpb24gb2YgdGhlIHNwYWNlIGNoYXJhY3RlciAod2hpY2ggaXNuJ3QgZXZlblxuICAvLyBhIHRva2VuKSwgd2UgaGF2ZSBubyB3YXkgdG8gYXZvaWQgbG9zaW5nIGluZm9ybWF0aW9uIGFib3V0IHRoZSB0ZXh0cydcbiAgLy8gb3JpZ2luYWwgd2hpdGVzcGFjZSBpbiB0aGUgcmVzdWx0IHdlIHJldHVybi4gU3RpbGwsIHdlIGRvIG91ciBiZXN0IHRvXG4gIC8vIG91dHB1dCBzb21ldGhpbmcgdGhhdCB3aWxsIGxvb2sgc2Vuc2libGUgaWYgd2UgZS5nLiBwcmludCBpdCB3aXRoXG4gIC8vIGluc2VydGlvbnMgaW4gZ3JlZW4gYW5kIGRlbGV0aW9ucyBpbiByZWQuXG5cbiAgLy8gQmV0d2VlbiB0d28gXCJrZWVwXCIgY2hhbmdlIG9iamVjdHMgKG9yIGJlZm9yZSB0aGUgZmlyc3Qgb3IgYWZ0ZXIgdGhlIGxhc3RcbiAgLy8gY2hhbmdlIG9iamVjdCksIHdlIGNhbiBoYXZlIGVpdGhlcjpcbiAgLy8gKiBBIFwiZGVsZXRlXCIgZm9sbG93ZWQgYnkgYW4gXCJpbnNlcnRcIlxuICAvLyAqIEp1c3QgYW4gXCJpbnNlcnRcIlxuICAvLyAqIEp1c3QgYSBcImRlbGV0ZVwiXG4gIC8vIFdlIGhhbmRsZSB0aGUgdGhyZWUgY2FzZXMgc2VwYXJhdGVseS5cbiAgaWYgKGRlbGV0aW9uICYmIGluc2VydGlvbikge1xuICAgIHZhciBvbGRXc1ByZWZpeCA9IGRlbGV0aW9uLnZhbHVlLm1hdGNoKC9eXFxzKi8pWzBdO1xuICAgIHZhciBvbGRXc1N1ZmZpeCA9IGRlbGV0aW9uLnZhbHVlLm1hdGNoKC9cXHMqJC8pWzBdO1xuICAgIHZhciBuZXdXc1ByZWZpeCA9IGluc2VydGlvbi52YWx1ZS5tYXRjaCgvXlxccyovKVswXTtcbiAgICB2YXIgbmV3V3NTdWZmaXggPSBpbnNlcnRpb24udmFsdWUubWF0Y2goL1xccyokLylbMF07XG4gICAgaWYgKHN0YXJ0S2VlcCkge1xuICAgICAgdmFyIGNvbW1vbldzUHJlZml4ID0gbG9uZ2VzdENvbW1vblByZWZpeChvbGRXc1ByZWZpeCwgbmV3V3NQcmVmaXgpO1xuICAgICAgc3RhcnRLZWVwLnZhbHVlID0gcmVwbGFjZVN1ZmZpeChzdGFydEtlZXAudmFsdWUsIG5ld1dzUHJlZml4LCBjb21tb25Xc1ByZWZpeCk7XG4gICAgICBkZWxldGlvbi52YWx1ZSA9IHJlbW92ZVByZWZpeChkZWxldGlvbi52YWx1ZSwgY29tbW9uV3NQcmVmaXgpO1xuICAgICAgaW5zZXJ0aW9uLnZhbHVlID0gcmVtb3ZlUHJlZml4KGluc2VydGlvbi52YWx1ZSwgY29tbW9uV3NQcmVmaXgpO1xuICAgIH1cbiAgICBpZiAoZW5kS2VlcCkge1xuICAgICAgdmFyIGNvbW1vbldzU3VmZml4ID0gbG9uZ2VzdENvbW1vblN1ZmZpeChvbGRXc1N1ZmZpeCwgbmV3V3NTdWZmaXgpO1xuICAgICAgZW5kS2VlcC52YWx1ZSA9IHJlcGxhY2VQcmVmaXgoZW5kS2VlcC52YWx1ZSwgbmV3V3NTdWZmaXgsIGNvbW1vbldzU3VmZml4KTtcbiAgICAgIGRlbGV0aW9uLnZhbHVlID0gcmVtb3ZlU3VmZml4KGRlbGV0aW9uLnZhbHVlLCBjb21tb25Xc1N1ZmZpeCk7XG4gICAgICBpbnNlcnRpb24udmFsdWUgPSByZW1vdmVTdWZmaXgoaW5zZXJ0aW9uLnZhbHVlLCBjb21tb25Xc1N1ZmZpeCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGluc2VydGlvbikge1xuICAgIC8vIFRoZSB3aGl0ZXNwYWNlcyBhbGwgcmVmbGVjdCB3aGF0IHdhcyBpbiB0aGUgbmV3IHRleHQgcmF0aGVyIHRoYW5cbiAgICAvLyB0aGUgb2xkLCBzbyB3ZSBlc3NlbnRpYWxseSBoYXZlIG5vIGluZm9ybWF0aW9uIGFib3V0IHdoaXRlc3BhY2VcbiAgICAvLyBpbnNlcnRpb24gb3IgZGVsZXRpb24uIFdlIGp1c3Qgd2FudCB0byBkZWR1cGUgdGhlIHdoaXRlc3BhY2UuXG4gICAgLy8gV2UgZG8gdGhhdCBieSBoYXZpbmcgZWFjaCBjaGFuZ2Ugb2JqZWN0IGtlZXAgaXRzIHRyYWlsaW5nXG4gICAgLy8gd2hpdGVzcGFjZSBhbmQgZGVsZXRpbmcgZHVwbGljYXRlIGxlYWRpbmcgd2hpdGVzcGFjZSB3aGVyZVxuICAgIC8vIHByZXNlbnQuXG4gICAgaWYgKHN0YXJ0S2VlcCkge1xuICAgICAgaW5zZXJ0aW9uLnZhbHVlID0gaW5zZXJ0aW9uLnZhbHVlLnJlcGxhY2UoL15cXHMqLywgJycpO1xuICAgIH1cbiAgICBpZiAoZW5kS2VlcCkge1xuICAgICAgZW5kS2VlcC52YWx1ZSA9IGVuZEtlZXAudmFsdWUucmVwbGFjZSgvXlxccyovLCAnJyk7XG4gICAgfVxuICAgIC8vIG90aGVyd2lzZSB3ZSd2ZSBnb3QgYSBkZWxldGlvbiBhbmQgbm8gaW5zZXJ0aW9uXG4gIH0gZWxzZSBpZiAoc3RhcnRLZWVwICYmIGVuZEtlZXApIHtcbiAgICB2YXIgbmV3V3NGdWxsID0gZW5kS2VlcC52YWx1ZS5tYXRjaCgvXlxccyovKVswXSxcbiAgICAgIGRlbFdzU3RhcnQgPSBkZWxldGlvbi52YWx1ZS5tYXRjaCgvXlxccyovKVswXSxcbiAgICAgIGRlbFdzRW5kID0gZGVsZXRpb24udmFsdWUubWF0Y2goL1xccyokLylbMF07XG5cbiAgICAvLyBBbnkgd2hpdGVzcGFjZSB0aGF0IGNvbWVzIHN0cmFpZ2h0IGFmdGVyIHN0YXJ0S2VlcCBpbiBib3RoIHRoZSBvbGQgYW5kXG4gICAgLy8gbmV3IHRleHRzLCBhc3NpZ24gdG8gc3RhcnRLZWVwIGFuZCByZW1vdmUgZnJvbSB0aGUgZGVsZXRpb24uXG4gICAgdmFyIG5ld1dzU3RhcnQgPSBsb25nZXN0Q29tbW9uUHJlZml4KG5ld1dzRnVsbCwgZGVsV3NTdGFydCk7XG4gICAgZGVsZXRpb24udmFsdWUgPSByZW1vdmVQcmVmaXgoZGVsZXRpb24udmFsdWUsIG5ld1dzU3RhcnQpO1xuXG4gICAgLy8gQW55IHdoaXRlc3BhY2UgdGhhdCBjb21lcyBzdHJhaWdodCBiZWZvcmUgZW5kS2VlcCBpbiBib3RoIHRoZSBvbGQgYW5kXG4gICAgLy8gbmV3IHRleHRzLCBhbmQgaGFzbid0IGFscmVhZHkgYmVlbiBhc3NpZ25lZCB0byBzdGFydEtlZXAsIGFzc2lnbiB0b1xuICAgIC8vIGVuZEtlZXAgYW5kIHJlbW92ZSBmcm9tIHRoZSBkZWxldGlvbi5cbiAgICB2YXIgbmV3V3NFbmQgPSBsb25nZXN0Q29tbW9uU3VmZml4KHJlbW92ZVByZWZpeChuZXdXc0Z1bGwsIG5ld1dzU3RhcnQpLCBkZWxXc0VuZCk7XG4gICAgZGVsZXRpb24udmFsdWUgPSByZW1vdmVTdWZmaXgoZGVsZXRpb24udmFsdWUsIG5ld1dzRW5kKTtcbiAgICBlbmRLZWVwLnZhbHVlID0gcmVwbGFjZVByZWZpeChlbmRLZWVwLnZhbHVlLCBuZXdXc0Z1bGwsIG5ld1dzRW5kKTtcblxuICAgIC8vIElmIHRoZXJlJ3MgYW55IHdoaXRlc3BhY2UgZnJvbSB0aGUgbmV3IHRleHQgdGhhdCBIQVNOJ1QgYWxyZWFkeSBiZWVuXG4gICAgLy8gYXNzaWduZWQsIGFzc2lnbiBpdCB0byB0aGUgc3RhcnQ6XG4gICAgc3RhcnRLZWVwLnZhbHVlID0gcmVwbGFjZVN1ZmZpeChzdGFydEtlZXAudmFsdWUsIG5ld1dzRnVsbCwgbmV3V3NGdWxsLnNsaWNlKDAsIG5ld1dzRnVsbC5sZW5ndGggLSBuZXdXc0VuZC5sZW5ndGgpKTtcbiAgfSBlbHNlIGlmIChlbmRLZWVwKSB7XG4gICAgLy8gV2UgYXJlIGF0IHRoZSBzdGFydCBvZiB0aGUgdGV4dC4gUHJlc2VydmUgYWxsIHRoZSB3aGl0ZXNwYWNlIG9uXG4gICAgLy8gZW5kS2VlcCwgYW5kIGp1c3QgcmVtb3ZlIHdoaXRlc3BhY2UgZnJvbSB0aGUgZW5kIG9mIGRlbGV0aW9uIHRvIHRoZVxuICAgIC8vIGV4dGVudCB0aGF0IGl0IG92ZXJsYXBzIHdpdGggdGhlIHN0YXJ0IG9mIGVuZEtlZXAuXG4gICAgdmFyIGVuZEtlZXBXc1ByZWZpeCA9IGVuZEtlZXAudmFsdWUubWF0Y2goL15cXHMqLylbMF07XG4gICAgdmFyIGRlbGV0aW9uV3NTdWZmaXggPSBkZWxldGlvbi52YWx1ZS5tYXRjaCgvXFxzKiQvKVswXTtcbiAgICB2YXIgb3ZlcmxhcCA9IG1heGltdW1PdmVybGFwKGRlbGV0aW9uV3NTdWZmaXgsIGVuZEtlZXBXc1ByZWZpeCk7XG4gICAgZGVsZXRpb24udmFsdWUgPSByZW1vdmVTdWZmaXgoZGVsZXRpb24udmFsdWUsIG92ZXJsYXApO1xuICB9IGVsc2UgaWYgKHN0YXJ0S2VlcCkge1xuICAgIC8vIFdlIGFyZSBhdCB0aGUgRU5EIG9mIHRoZSB0ZXh0LiBQcmVzZXJ2ZSBhbGwgdGhlIHdoaXRlc3BhY2Ugb25cbiAgICAvLyBzdGFydEtlZXAsIGFuZCBqdXN0IHJlbW92ZSB3aGl0ZXNwYWNlIGZyb20gdGhlIHN0YXJ0IG9mIGRlbGV0aW9uIHRvXG4gICAgLy8gdGhlIGV4dGVudCB0aGF0IGl0IG92ZXJsYXBzIHdpdGggdGhlIGVuZCBvZiBzdGFydEtlZXAuXG4gICAgdmFyIHN0YXJ0S2VlcFdzU3VmZml4ID0gc3RhcnRLZWVwLnZhbHVlLm1hdGNoKC9cXHMqJC8pWzBdO1xuICAgIHZhciBkZWxldGlvbldzUHJlZml4ID0gZGVsZXRpb24udmFsdWUubWF0Y2goL15cXHMqLylbMF07XG4gICAgdmFyIF9vdmVybGFwID0gbWF4aW11bU92ZXJsYXAoc3RhcnRLZWVwV3NTdWZmaXgsIGRlbGV0aW9uV3NQcmVmaXgpO1xuICAgIGRlbGV0aW9uLnZhbHVlID0gcmVtb3ZlUHJlZml4KGRlbGV0aW9uLnZhbHVlLCBfb3ZlcmxhcCk7XG4gIH1cbn1cbnZhciB3b3JkV2l0aFNwYWNlRGlmZiA9IG5ldyBEaWZmKCk7XG53b3JkV2l0aFNwYWNlRGlmZi50b2tlbml6ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAvLyBTbGlnaHRseSBkaWZmZXJlbnQgdG8gdGhlIHRva2VuaXplSW5jbHVkaW5nV2hpdGVzcGFjZSByZWdleCB1c2VkIGFib3ZlIGluXG4gIC8vIHRoYXQgdGhpcyBvbmUgdHJlYXRzIGVhY2ggaW5kaXZpZHVhbCBuZXdsaW5lIGFzIGEgZGlzdGluY3QgdG9rZW5zLCByYXRoZXJcbiAgLy8gdGhhbiBtZXJnaW5nIHRoZW0gaW50byBvdGhlciBzdXJyb3VuZGluZyB3aGl0ZXNwYWNlLiBUaGlzIHdhcyByZXF1ZXN0ZWRcbiAgLy8gaW4gaHR0cHM6Ly9naXRodWIuY29tL2twZGVja2VyL2pzZGlmZi9pc3N1ZXMvMTgwICZcbiAgLy8gICAgaHR0cHM6Ly9naXRodWIuY29tL2twZGVja2VyL2pzZGlmZi9pc3N1ZXMvMjExXG4gIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCIoXFxcXHI/XFxcXG4pfFtcIi5jb25jYXQoZXh0ZW5kZWRXb3JkQ2hhcnMsIFwiXSt8W15cXFxcU1xcXFxuXFxcXHJdK3xbXlwiKS5jb25jYXQoZXh0ZW5kZWRXb3JkQ2hhcnMsIFwiXVwiKSwgJ3VnJyk7XG4gIHJldHVybiB2YWx1ZS5tYXRjaChyZWdleCkgfHwgW107XG59O1xuZnVuY3Rpb24gZGlmZldvcmRzV2l0aFNwYWNlKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKSB7XG4gIHJldHVybiB3b3JkV2l0aFNwYWNlRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIGRlZmF1bHRzKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlZmF1bHRzLmNhbGxiYWNrID0gb3B0aW9ucztcbiAgfSBlbHNlIGlmIChvcHRpb25zKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgZGVmYXVsdHNbbmFtZV0gPSBvcHRpb25zW25hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gZGVmYXVsdHM7XG59XG5cbnZhciBsaW5lRGlmZiA9IG5ldyBEaWZmKCk7XG5saW5lRGlmZi50b2tlbml6ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucy5zdHJpcFRyYWlsaW5nQ3IpIHtcbiAgICAvLyByZW1vdmUgb25lIFxcciBiZWZvcmUgXFxuIHRvIG1hdGNoIEdOVSBkaWZmJ3MgLS1zdHJpcC10cmFpbGluZy1jciBiZWhhdmlvclxuICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxyXFxuL2csICdcXG4nKTtcbiAgfVxuICB2YXIgcmV0TGluZXMgPSBbXSxcbiAgICBsaW5lc0FuZE5ld2xpbmVzID0gdmFsdWUuc3BsaXQoLyhcXG58XFxyXFxuKS8pO1xuXG4gIC8vIElnbm9yZSB0aGUgZmluYWwgZW1wdHkgdG9rZW4gdGhhdCBvY2N1cnMgaWYgdGhlIHN0cmluZyBlbmRzIHdpdGggYSBuZXcgbGluZVxuICBpZiAoIWxpbmVzQW5kTmV3bGluZXNbbGluZXNBbmROZXdsaW5lcy5sZW5ndGggLSAxXSkge1xuICAgIGxpbmVzQW5kTmV3bGluZXMucG9wKCk7XG4gIH1cblxuICAvLyBNZXJnZSB0aGUgY29udGVudCBhbmQgbGluZSBzZXBhcmF0b3JzIGludG8gc2luZ2xlIHRva2Vuc1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzQW5kTmV3bGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbGluZSA9IGxpbmVzQW5kTmV3bGluZXNbaV07XG4gICAgaWYgKGkgJSAyICYmICFvcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgICByZXRMaW5lc1tyZXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXRMaW5lcy5wdXNoKGxpbmUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0TGluZXM7XG59O1xubGluZURpZmYuZXF1YWxzID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0LCBvcHRpb25zKSB7XG4gIC8vIElmIHdlJ3JlIGlnbm9yaW5nIHdoaXRlc3BhY2UsIHdlIG5lZWQgdG8gbm9ybWFsaXNlIGxpbmVzIGJ5IHN0cmlwcGluZ1xuICAvLyB3aGl0ZXNwYWNlIGJlZm9yZSBjaGVja2luZyBlcXVhbGl0eS4gKFRoaXMgaGFzIGFuIGFubm95aW5nIGludGVyYWN0aW9uXG4gIC8vIHdpdGggbmV3bGluZUlzVG9rZW4gdGhhdCByZXF1aXJlcyBzcGVjaWFsIGhhbmRsaW5nOiBpZiBuZXdsaW5lcyBnZXQgdGhlaXJcbiAgLy8gb3duIHRva2VuLCB0aGVuIHdlIERPTidUIHdhbnQgdG8gdHJpbSB0aGUgKm5ld2xpbmUqIHRva2VucyBkb3duIHRvIGVtcHR5XG4gIC8vIHN0cmluZ3MsIHNpbmNlIHRoaXMgd291bGQgY2F1c2UgdXMgdG8gdHJlYXQgd2hpdGVzcGFjZS1vbmx5IGxpbmUgY29udGVudFxuICAvLyBhcyBlcXVhbCB0byBhIHNlcGFyYXRvciBiZXR3ZWVuIGxpbmVzLCB3aGljaCB3b3VsZCBiZSB3ZWlyZCBhbmRcbiAgLy8gaW5jb25zaXN0ZW50IHdpdGggdGhlIGRvY3VtZW50ZWQgYmVoYXZpb3Igb2YgdGhlIG9wdGlvbnMuKVxuICBpZiAob3B0aW9ucy5pZ25vcmVXaGl0ZXNwYWNlKSB7XG4gICAgaWYgKCFvcHRpb25zLm5ld2xpbmVJc1Rva2VuIHx8ICFsZWZ0LmluY2x1ZGVzKCdcXG4nKSkge1xuICAgICAgbGVmdCA9IGxlZnQudHJpbSgpO1xuICAgIH1cbiAgICBpZiAoIW9wdGlvbnMubmV3bGluZUlzVG9rZW4gfHwgIXJpZ2h0LmluY2x1ZGVzKCdcXG4nKSkge1xuICAgICAgcmlnaHQgPSByaWdodC50cmltKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKG9wdGlvbnMuaWdub3JlTmV3bGluZUF0RW9mICYmICFvcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgaWYgKGxlZnQuZW5kc1dpdGgoJ1xcbicpKSB7XG4gICAgICBsZWZ0ID0gbGVmdC5zbGljZSgwLCAtMSk7XG4gICAgfVxuICAgIGlmIChyaWdodC5lbmRzV2l0aCgnXFxuJykpIHtcbiAgICAgIHJpZ2h0ID0gcmlnaHQuc2xpY2UoMCwgLTEpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gRGlmZi5wcm90b3R5cGUuZXF1YWxzLmNhbGwodGhpcywgbGVmdCwgcmlnaHQsIG9wdGlvbnMpO1xufTtcbmZ1bmN0aW9uIGRpZmZMaW5lcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHtcbiAgcmV0dXJuIGxpbmVEaWZmLmRpZmYob2xkU3RyLCBuZXdTdHIsIGNhbGxiYWNrKTtcbn1cblxuLy8gS2VwdCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuIFRoaXMgaXMgYSByYXRoZXIgYXJiaXRyYXJ5IHdyYXBwZXIgbWV0aG9kXG4vLyB0aGF0IGp1c3QgY2FsbHMgYGRpZmZMaW5lc2Agd2l0aCBgaWdub3JlV2hpdGVzcGFjZTogdHJ1ZWAuIEl0J3MgY29uZnVzaW5nIHRvXG4vLyBoYXZlIHR3byB3YXlzIHRvIGRvIGV4YWN0bHkgdGhlIHNhbWUgdGhpbmcgaW4gdGhlIEFQSSwgc28gd2Ugbm8gbG9uZ2VyXG4vLyBkb2N1bWVudCB0aGlzIG9uZSAobGlicmFyeSB1c2VycyBzaG91bGQgZXhwbGljaXRseSB1c2UgYGRpZmZMaW5lc2Agd2l0aFxuLy8gYGlnbm9yZVdoaXRlc3BhY2U6IHRydWVgIGluc3RlYWQpIGJ1dCB3ZSBrZWVwIGl0IGFyb3VuZCB0byBtYWludGFpblxuLy8gY29tcGF0aWJpbGl0eSB3aXRoIGNvZGUgdGhhdCB1c2VkIG9sZCB2ZXJzaW9ucy5cbmZ1bmN0aW9uIGRpZmZUcmltbWVkTGluZXMob2xkU3RyLCBuZXdTdHIsIGNhbGxiYWNrKSB7XG4gIHZhciBvcHRpb25zID0gZ2VuZXJhdGVPcHRpb25zKGNhbGxiYWNrLCB7XG4gICAgaWdub3JlV2hpdGVzcGFjZTogdHJ1ZVxuICB9KTtcbiAgcmV0dXJuIGxpbmVEaWZmLmRpZmYob2xkU3RyLCBuZXdTdHIsIG9wdGlvbnMpO1xufVxuXG52YXIgc2VudGVuY2VEaWZmID0gbmV3IERpZmYoKTtcbnNlbnRlbmNlRGlmZi50b2tlbml6ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhcXFMuKz9bLiE/XSkoPz1cXHMrfCQpLyk7XG59O1xuZnVuY3Rpb24gZGlmZlNlbnRlbmNlcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHtcbiAgcmV0dXJuIHNlbnRlbmNlRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjayk7XG59XG5cbnZhciBjc3NEaWZmID0gbmV3IERpZmYoKTtcbmNzc0RpZmYudG9rZW5pemUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLnNwbGl0KC8oW3t9OjssXXxcXHMrKS8pO1xufTtcbmZ1bmN0aW9uIGRpZmZDc3Mob2xkU3RyLCBuZXdTdHIsIGNhbGxiYWNrKSB7XG4gIHJldHVybiBjc3NEaWZmLmRpZmYob2xkU3RyLCBuZXdTdHIsIGNhbGxiYWNrKTtcbn1cblxuZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7XG4gIHZhciB0ID0gT2JqZWN0LmtleXMoZSk7XG4gIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO1xuICAgIHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikge1xuICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTtcbiAgICB9KSksIHQucHVzaC5hcHBseSh0LCBvKTtcbiAgfVxuICByZXR1cm4gdDtcbn1cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKGUpIHtcbiAgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHtcbiAgICB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307XG4gICAgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTtcbiAgICB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gZTtcbn1cbmZ1bmN0aW9uIF90b1ByaW1pdGl2ZSh0LCByKSB7XG4gIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiB0IHx8ICF0KSByZXR1cm4gdDtcbiAgdmFyIGUgPSB0W1N5bWJvbC50b1ByaW1pdGl2ZV07XG4gIGlmICh2b2lkIDAgIT09IGUpIHtcbiAgICB2YXIgaSA9IGUuY2FsbCh0LCByIHx8IFwiZGVmYXVsdFwiKTtcbiAgICBpZiAoXCJvYmplY3RcIiAhPSB0eXBlb2YgaSkgcmV0dXJuIGk7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpO1xuICB9XG4gIHJldHVybiAoXCJzdHJpbmdcIiA9PT0gciA/IFN0cmluZyA6IE51bWJlcikodCk7XG59XG5mdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleSh0KSB7XG4gIHZhciBpID0gX3RvUHJpbWl0aXZlKHQsIFwic3RyaW5nXCIpO1xuICByZXR1cm4gXCJzeW1ib2xcIiA9PSB0eXBlb2YgaSA/IGkgOiBpICsgXCJcIjtcbn1cbmZ1bmN0aW9uIF90eXBlb2Yobykge1xuICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cbiAgcmV0dXJuIF90eXBlb2YgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBcInN5bWJvbFwiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiB0eXBlb2YgbztcbiAgfSA6IGZ1bmN0aW9uIChvKSB7XG4gICAgcmV0dXJuIG8gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG87XG4gIH0sIF90eXBlb2Yobyk7XG59XG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gIGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7XG4gIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7XG4gIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7XG59XG5mdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpO1xufVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xufVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuICBpZiAoIW8pIHJldHVybjtcbiAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHtcbiAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTtcbiAgcmV0dXJuIGFycjI7XG59XG5mdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuXG52YXIganNvbkRpZmYgPSBuZXcgRGlmZigpO1xuLy8gRGlzY3JpbWluYXRlIGJldHdlZW4gdHdvIGxpbmVzIG9mIHByZXR0eS1wcmludGVkLCBzZXJpYWxpemVkIEpTT04gd2hlcmUgb25lIG9mIHRoZW0gaGFzIGFcbi8vIGRhbmdsaW5nIGNvbW1hIGFuZCB0aGUgb3RoZXIgZG9lc24ndC4gVHVybnMgb3V0IGluY2x1ZGluZyB0aGUgZGFuZ2xpbmcgY29tbWEgeWllbGRzIHRoZSBuaWNlc3Qgb3V0cHV0OlxuanNvbkRpZmYudXNlTG9uZ2VzdFRva2VuID0gdHJ1ZTtcbmpzb25EaWZmLnRva2VuaXplID0gbGluZURpZmYudG9rZW5pemU7XG5qc29uRGlmZi5jYXN0SW5wdXQgPSBmdW5jdGlvbiAodmFsdWUsIG9wdGlvbnMpIHtcbiAgdmFyIHVuZGVmaW5lZFJlcGxhY2VtZW50ID0gb3B0aW9ucy51bmRlZmluZWRSZXBsYWNlbWVudCxcbiAgICBfb3B0aW9ucyRzdHJpbmdpZnlSZXAgPSBvcHRpb25zLnN0cmluZ2lmeVJlcGxhY2VyLFxuICAgIHN0cmluZ2lmeVJlcGxhY2VyID0gX29wdGlvbnMkc3RyaW5naWZ5UmVwID09PSB2b2lkIDAgPyBmdW5jdGlvbiAoaywgdikge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZFJlcGxhY2VtZW50IDogdjtcbiAgICB9IDogX29wdGlvbnMkc3RyaW5naWZ5UmVwO1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkoY2Fub25pY2FsaXplKHZhbHVlLCBudWxsLCBudWxsLCBzdHJpbmdpZnlSZXBsYWNlciksIHN0cmluZ2lmeVJlcGxhY2VyLCAnICAnKTtcbn07XG5qc29uRGlmZi5lcXVhbHMgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIERpZmYucHJvdG90eXBlLmVxdWFscy5jYWxsKGpzb25EaWZmLCBsZWZ0LnJlcGxhY2UoLywoW1xcclxcbl0pL2csICckMScpLCByaWdodC5yZXBsYWNlKC8sKFtcXHJcXG5dKS9nLCAnJDEnKSwgb3B0aW9ucyk7XG59O1xuZnVuY3Rpb24gZGlmZkpzb24ob2xkT2JqLCBuZXdPYmosIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGpzb25EaWZmLmRpZmYob2xkT2JqLCBuZXdPYmosIG9wdGlvbnMpO1xufVxuXG4vLyBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgdGhlIHByZXNlbmNlIG9mIGNpcmN1bGFyIHJlZmVyZW5jZXMgYnkgYmFpbGluZyBvdXQgd2hlbiBlbmNvdW50ZXJpbmcgYW5cbi8vIG9iamVjdCB0aGF0IGlzIGFscmVhZHkgb24gdGhlIFwic3RhY2tcIiBvZiBpdGVtcyBiZWluZyBwcm9jZXNzZWQuIEFjY2VwdHMgYW4gb3B0aW9uYWwgcmVwbGFjZXJcbmZ1bmN0aW9uIGNhbm9uaWNhbGl6ZShvYmosIHN0YWNrLCByZXBsYWNlbWVudFN0YWNrLCByZXBsYWNlciwga2V5KSB7XG4gIHN0YWNrID0gc3RhY2sgfHwgW107XG4gIHJlcGxhY2VtZW50U3RhY2sgPSByZXBsYWNlbWVudFN0YWNrIHx8IFtdO1xuICBpZiAocmVwbGFjZXIpIHtcbiAgICBvYmogPSByZXBsYWNlcihrZXksIG9iaik7XG4gIH1cbiAgdmFyIGk7XG4gIGZvciAoaSA9IDA7IGkgPCBzdGFjay5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmIChzdGFja1tpXSA9PT0gb2JqKSB7XG4gICAgICByZXR1cm4gcmVwbGFjZW1lbnRTdGFja1tpXTtcbiAgICB9XG4gIH1cbiAgdmFyIGNhbm9uaWNhbGl6ZWRPYmo7XG4gIGlmICgnW29iamVjdCBBcnJheV0nID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSkge1xuICAgIHN0YWNrLnB1c2gob2JqKTtcbiAgICBjYW5vbmljYWxpemVkT2JqID0gbmV3IEFycmF5KG9iai5sZW5ndGgpO1xuICAgIHJlcGxhY2VtZW50U3RhY2sucHVzaChjYW5vbmljYWxpemVkT2JqKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgb2JqLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICBjYW5vbmljYWxpemVkT2JqW2ldID0gY2Fub25pY2FsaXplKG9ialtpXSwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpO1xuICAgIH1cbiAgICBzdGFjay5wb3AoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnBvcCgpO1xuICAgIHJldHVybiBjYW5vbmljYWxpemVkT2JqO1xuICB9XG4gIGlmIChvYmogJiYgb2JqLnRvSlNPTikge1xuICAgIG9iaiA9IG9iai50b0pTT04oKTtcbiAgfVxuICBpZiAoX3R5cGVvZihvYmopID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IHt9O1xuICAgIHJlcGxhY2VtZW50U3RhY2sucHVzaChjYW5vbmljYWxpemVkT2JqKTtcbiAgICB2YXIgc29ydGVkS2V5cyA9IFtdLFxuICAgICAgX2tleTtcbiAgICBmb3IgKF9rZXkgaW4gb2JqKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIF9rZXkpKSB7XG4gICAgICAgIHNvcnRlZEtleXMucHVzaChfa2V5KTtcbiAgICAgIH1cbiAgICB9XG4gICAgc29ydGVkS2V5cy5zb3J0KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IHNvcnRlZEtleXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIF9rZXkgPSBzb3J0ZWRLZXlzW2ldO1xuICAgICAgY2Fub25pY2FsaXplZE9ialtfa2V5XSA9IGNhbm9uaWNhbGl6ZShvYmpbX2tleV0sIHN0YWNrLCByZXBsYWNlbWVudFN0YWNrLCByZXBsYWNlciwgX2tleSk7XG4gICAgfVxuICAgIHN0YWNrLnBvcCgpO1xuICAgIHJlcGxhY2VtZW50U3RhY2sucG9wKCk7XG4gIH0gZWxzZSB7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IG9iajtcbiAgfVxuICByZXR1cm4gY2Fub25pY2FsaXplZE9iajtcbn1cblxudmFyIGFycmF5RGlmZiA9IG5ldyBEaWZmKCk7XG5hcnJheURpZmYudG9rZW5pemUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLnNsaWNlKCk7XG59O1xuYXJyYXlEaWZmLmpvaW4gPSBhcnJheURpZmYucmVtb3ZlRW1wdHkgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlO1xufTtcbmZ1bmN0aW9uIGRpZmZBcnJheXMob2xkQXJyLCBuZXdBcnIsIGNhbGxiYWNrKSB7XG4gIHJldHVybiBhcnJheURpZmYuZGlmZihvbGRBcnIsIG5ld0FyciwgY2FsbGJhY2spO1xufVxuXG5mdW5jdGlvbiB1bml4VG9XaW4ocGF0Y2gpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkocGF0Y2gpKSB7XG4gICAgcmV0dXJuIHBhdGNoLm1hcCh1bml4VG9XaW4pO1xuICB9XG4gIHJldHVybiBfb2JqZWN0U3ByZWFkMihfb2JqZWN0U3ByZWFkMih7fSwgcGF0Y2gpLCB7fSwge1xuICAgIGh1bmtzOiBwYXRjaC5odW5rcy5tYXAoZnVuY3Rpb24gKGh1bmspIHtcbiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkMihfb2JqZWN0U3ByZWFkMih7fSwgaHVuayksIHt9LCB7XG4gICAgICAgIGxpbmVzOiBodW5rLmxpbmVzLm1hcChmdW5jdGlvbiAobGluZSwgaSkge1xuICAgICAgICAgIHZhciBfaHVuayRsaW5lcztcbiAgICAgICAgICByZXR1cm4gbGluZS5zdGFydHNXaXRoKCdcXFxcJykgfHwgbGluZS5lbmRzV2l0aCgnXFxyJykgfHwgKF9odW5rJGxpbmVzID0gaHVuay5saW5lc1tpICsgMV0pICE9PSBudWxsICYmIF9odW5rJGxpbmVzICE9PSB2b2lkIDAgJiYgX2h1bmskbGluZXMuc3RhcnRzV2l0aCgnXFxcXCcpID8gbGluZSA6IGxpbmUgKyAnXFxyJztcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xufVxuZnVuY3Rpb24gd2luVG9Vbml4KHBhdGNoKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHBhdGNoKSkge1xuICAgIHJldHVybiBwYXRjaC5tYXAod2luVG9Vbml4KTtcbiAgfVxuICByZXR1cm4gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIHBhdGNoKSwge30sIHtcbiAgICBodW5rczogcGF0Y2guaHVua3MubWFwKGZ1bmN0aW9uIChodW5rKSB7XG4gICAgICByZXR1cm4gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIGh1bmspLCB7fSwge1xuICAgICAgICBsaW5lczogaHVuay5saW5lcy5tYXAoZnVuY3Rpb24gKGxpbmUpIHtcbiAgICAgICAgICByZXR1cm4gbGluZS5lbmRzV2l0aCgnXFxyJykgPyBsaW5lLnN1YnN0cmluZygwLCBsaW5lLmxlbmd0aCAtIDEpIDogbGluZTtcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGF0Y2ggY29uc2lzdGVudGx5IHVzZXMgVW5peCBsaW5lIGVuZGluZ3MgKG9yIG9ubHkgaW52b2x2ZXMgb25lIGxpbmUgYW5kIGhhc1xuICogbm8gbGluZSBlbmRpbmdzKS5cbiAqL1xuZnVuY3Rpb24gaXNVbml4KHBhdGNoKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShwYXRjaCkpIHtcbiAgICBwYXRjaCA9IFtwYXRjaF07XG4gIH1cbiAgcmV0dXJuICFwYXRjaC5zb21lKGZ1bmN0aW9uIChpbmRleCkge1xuICAgIHJldHVybiBpbmRleC5odW5rcy5zb21lKGZ1bmN0aW9uIChodW5rKSB7XG4gICAgICByZXR1cm4gaHVuay5saW5lcy5zb21lKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgIHJldHVybiAhbGluZS5zdGFydHNXaXRoKCdcXFxcJykgJiYgbGluZS5lbmRzV2l0aCgnXFxyJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwYXRjaCB1c2VzIFdpbmRvd3MgbGluZSBlbmRpbmdzIGFuZCBvbmx5IFdpbmRvd3MgbGluZSBlbmRpbmdzLlxuICovXG5mdW5jdGlvbiBpc1dpbihwYXRjaCkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkocGF0Y2gpKSB7XG4gICAgcGF0Y2ggPSBbcGF0Y2hdO1xuICB9XG4gIHJldHVybiBwYXRjaC5zb21lKGZ1bmN0aW9uIChpbmRleCkge1xuICAgIHJldHVybiBpbmRleC5odW5rcy5zb21lKGZ1bmN0aW9uIChodW5rKSB7XG4gICAgICByZXR1cm4gaHVuay5saW5lcy5zb21lKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgIHJldHVybiBsaW5lLmVuZHNXaXRoKCdcXHInKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KSAmJiBwYXRjaC5ldmVyeShmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXguaHVua3MuZXZlcnkoZnVuY3Rpb24gKGh1bmspIHtcbiAgICAgIHJldHVybiBodW5rLmxpbmVzLmV2ZXJ5KGZ1bmN0aW9uIChsaW5lLCBpKSB7XG4gICAgICAgIHZhciBfaHVuayRsaW5lczI7XG4gICAgICAgIHJldHVybiBsaW5lLnN0YXJ0c1dpdGgoJ1xcXFwnKSB8fCBsaW5lLmVuZHNXaXRoKCdcXHInKSB8fCAoKF9odW5rJGxpbmVzMiA9IGh1bmsubGluZXNbaSArIDFdKSA9PT0gbnVsbCB8fCBfaHVuayRsaW5lczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9odW5rJGxpbmVzMi5zdGFydHNXaXRoKCdcXFxcJykpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBwYXJzZVBhdGNoKHVuaURpZmYpIHtcbiAgdmFyIGRpZmZzdHIgPSB1bmlEaWZmLnNwbGl0KC9cXG4vKSxcbiAgICBsaXN0ID0gW10sXG4gICAgaSA9IDA7XG4gIGZ1bmN0aW9uIHBhcnNlSW5kZXgoKSB7XG4gICAgdmFyIGluZGV4ID0ge307XG4gICAgbGlzdC5wdXNoKGluZGV4KTtcblxuICAgIC8vIFBhcnNlIGRpZmYgbWV0YWRhdGFcbiAgICB3aGlsZSAoaSA8IGRpZmZzdHIubGVuZ3RoKSB7XG4gICAgICB2YXIgbGluZSA9IGRpZmZzdHJbaV07XG5cbiAgICAgIC8vIEZpbGUgaGVhZGVyIGZvdW5kLCBlbmQgcGFyc2luZyBkaWZmIG1ldGFkYXRhXG4gICAgICBpZiAoL14oXFwtXFwtXFwtfFxcK1xcK1xcK3xAQClcXHMvLnRlc3QobGluZSkpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIERpZmYgaW5kZXhcbiAgICAgIHZhciBoZWFkZXIgPSAvXig/OkluZGV4OnxkaWZmKD86IC1yIFxcdyspKylcXHMrKC4rPylcXHMqJC8uZXhlYyhsaW5lKTtcbiAgICAgIGlmIChoZWFkZXIpIHtcbiAgICAgICAgaW5kZXguaW5kZXggPSBoZWFkZXJbMV07XG4gICAgICB9XG4gICAgICBpKys7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgZmlsZSBoZWFkZXJzIGlmIHRoZXkgYXJlIGRlZmluZWQuIFVuaWZpZWQgZGlmZiByZXF1aXJlcyB0aGVtLCBidXRcbiAgICAvLyB0aGVyZSdzIG5vIHRlY2huaWNhbCBpc3N1ZXMgdG8gaGF2ZSBhbiBpc29sYXRlZCBodW5rIHdpdGhvdXQgZmlsZSBoZWFkZXJcbiAgICBwYXJzZUZpbGVIZWFkZXIoaW5kZXgpO1xuICAgIHBhcnNlRmlsZUhlYWRlcihpbmRleCk7XG5cbiAgICAvLyBQYXJzZSBodW5rc1xuICAgIGluZGV4Lmh1bmtzID0gW107XG4gICAgd2hpbGUgKGkgPCBkaWZmc3RyLmxlbmd0aCkge1xuICAgICAgdmFyIF9saW5lID0gZGlmZnN0cltpXTtcbiAgICAgIGlmICgvXihJbmRleDpcXHN8ZGlmZlxcc3xcXC1cXC1cXC1cXHN8XFwrXFwrXFwrXFxzfD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0pLy50ZXN0KF9saW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoL15AQC8udGVzdChfbGluZSkpIHtcbiAgICAgICAgaW5kZXguaHVua3MucHVzaChwYXJzZUh1bmsoKSk7XG4gICAgICB9IGVsc2UgaWYgKF9saW5lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBsaW5lICcgKyAoaSArIDEpICsgJyAnICsgSlNPTi5zdHJpbmdpZnkoX2xpbmUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQYXJzZXMgdGhlIC0tLSBhbmQgKysrIGhlYWRlcnMsIGlmIG5vbmUgYXJlIGZvdW5kLCBubyBsaW5lc1xuICAvLyBhcmUgY29uc3VtZWQuXG4gIGZ1bmN0aW9uIHBhcnNlRmlsZUhlYWRlcihpbmRleCkge1xuICAgIHZhciBmaWxlSGVhZGVyID0gL14oLS0tfFxcK1xcK1xcKylcXHMrKC4qKVxccj8kLy5leGVjKGRpZmZzdHJbaV0pO1xuICAgIGlmIChmaWxlSGVhZGVyKSB7XG4gICAgICB2YXIga2V5UHJlZml4ID0gZmlsZUhlYWRlclsxXSA9PT0gJy0tLScgPyAnb2xkJyA6ICduZXcnO1xuICAgICAgdmFyIGRhdGEgPSBmaWxlSGVhZGVyWzJdLnNwbGl0KCdcXHQnLCAyKTtcbiAgICAgIHZhciBmaWxlTmFtZSA9IGRhdGFbMF0ucmVwbGFjZSgvXFxcXFxcXFwvZywgJ1xcXFwnKTtcbiAgICAgIGlmICgvXlwiLipcIiQvLnRlc3QoZmlsZU5hbWUpKSB7XG4gICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyKDEsIGZpbGVOYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgfVxuICAgICAgaW5kZXhba2V5UHJlZml4ICsgJ0ZpbGVOYW1lJ10gPSBmaWxlTmFtZTtcbiAgICAgIGluZGV4W2tleVByZWZpeCArICdIZWFkZXInXSA9IChkYXRhWzFdIHx8ICcnKS50cmltKCk7XG4gICAgICBpKys7XG4gICAgfVxuICB9XG5cbiAgLy8gUGFyc2VzIGEgaHVua1xuICAvLyBUaGlzIGFzc3VtZXMgdGhhdCB3ZSBhcmUgYXQgdGhlIHN0YXJ0IG9mIGEgaHVuay5cbiAgZnVuY3Rpb24gcGFyc2VIdW5rKCkge1xuICAgIHZhciBjaHVua0hlYWRlckluZGV4ID0gaSxcbiAgICAgIGNodW5rSGVhZGVyTGluZSA9IGRpZmZzdHJbaSsrXSxcbiAgICAgIGNodW5rSGVhZGVyID0gY2h1bmtIZWFkZXJMaW5lLnNwbGl0KC9AQCAtKFxcZCspKD86LChcXGQrKSk/IFxcKyhcXGQrKSg/OiwoXFxkKykpPyBAQC8pO1xuICAgIHZhciBodW5rID0ge1xuICAgICAgb2xkU3RhcnQ6ICtjaHVua0hlYWRlclsxXSxcbiAgICAgIG9sZExpbmVzOiB0eXBlb2YgY2h1bmtIZWFkZXJbMl0gPT09ICd1bmRlZmluZWQnID8gMSA6ICtjaHVua0hlYWRlclsyXSxcbiAgICAgIG5ld1N0YXJ0OiArY2h1bmtIZWFkZXJbM10sXG4gICAgICBuZXdMaW5lczogdHlwZW9mIGNodW5rSGVhZGVyWzRdID09PSAndW5kZWZpbmVkJyA/IDEgOiArY2h1bmtIZWFkZXJbNF0sXG4gICAgICBsaW5lczogW11cbiAgICB9O1xuXG4gICAgLy8gVW5pZmllZCBEaWZmIEZvcm1hdCBxdWlyazogSWYgdGhlIGNodW5rIHNpemUgaXMgMCxcbiAgICAvLyB0aGUgZmlyc3QgbnVtYmVyIGlzIG9uZSBsb3dlciB0aGFuIG9uZSB3b3VsZCBleHBlY3QuXG4gICAgLy8gaHR0cHM6Ly93d3cuYXJ0aW1hLmNvbS93ZWJsb2dzL3ZpZXdwb3N0LmpzcD90aHJlYWQ9MTY0MjkzXG4gICAgaWYgKGh1bmsub2xkTGluZXMgPT09IDApIHtcbiAgICAgIGh1bmsub2xkU3RhcnQgKz0gMTtcbiAgICB9XG4gICAgaWYgKGh1bmsubmV3TGluZXMgPT09IDApIHtcbiAgICAgIGh1bmsubmV3U3RhcnQgKz0gMTtcbiAgICB9XG4gICAgdmFyIGFkZENvdW50ID0gMCxcbiAgICAgIHJlbW92ZUNvdW50ID0gMDtcbiAgICBmb3IgKDsgaSA8IGRpZmZzdHIubGVuZ3RoICYmIChyZW1vdmVDb3VudCA8IGh1bmsub2xkTGluZXMgfHwgYWRkQ291bnQgPCBodW5rLm5ld0xpbmVzIHx8IChfZGlmZnN0ciRpID0gZGlmZnN0cltpXSkgIT09IG51bGwgJiYgX2RpZmZzdHIkaSAhPT0gdm9pZCAwICYmIF9kaWZmc3RyJGkuc3RhcnRzV2l0aCgnXFxcXCcpKTsgaSsrKSB7XG4gICAgICB2YXIgX2RpZmZzdHIkaTtcbiAgICAgIHZhciBvcGVyYXRpb24gPSBkaWZmc3RyW2ldLmxlbmd0aCA9PSAwICYmIGkgIT0gZGlmZnN0ci5sZW5ndGggLSAxID8gJyAnIDogZGlmZnN0cltpXVswXTtcbiAgICAgIGlmIChvcGVyYXRpb24gPT09ICcrJyB8fCBvcGVyYXRpb24gPT09ICctJyB8fCBvcGVyYXRpb24gPT09ICcgJyB8fCBvcGVyYXRpb24gPT09ICdcXFxcJykge1xuICAgICAgICBodW5rLmxpbmVzLnB1c2goZGlmZnN0cltpXSk7XG4gICAgICAgIGlmIChvcGVyYXRpb24gPT09ICcrJykge1xuICAgICAgICAgIGFkZENvdW50Kys7XG4gICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09PSAnLScpIHtcbiAgICAgICAgICByZW1vdmVDb3VudCsrO1xuICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJyAnKSB7XG4gICAgICAgICAgYWRkQ291bnQrKztcbiAgICAgICAgICByZW1vdmVDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIdW5rIGF0IGxpbmUgXCIuY29uY2F0KGNodW5rSGVhZGVySW5kZXggKyAxLCBcIiBjb250YWluZWQgaW52YWxpZCBsaW5lIFwiKS5jb25jYXQoZGlmZnN0cltpXSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgZW1wdHkgYmxvY2sgY291bnQgY2FzZVxuICAgIGlmICghYWRkQ291bnQgJiYgaHVuay5uZXdMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5uZXdMaW5lcyA9IDA7XG4gICAgfVxuICAgIGlmICghcmVtb3ZlQ291bnQgJiYgaHVuay5vbGRMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5vbGRMaW5lcyA9IDA7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSBzYW5pdHkgY2hlY2tpbmdcbiAgICBpZiAoYWRkQ291bnQgIT09IGh1bmsubmV3TGluZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQWRkZWQgbGluZSBjb3VudCBkaWQgbm90IG1hdGNoIGZvciBodW5rIGF0IGxpbmUgJyArIChjaHVua0hlYWRlckluZGV4ICsgMSkpO1xuICAgIH1cbiAgICBpZiAocmVtb3ZlQ291bnQgIT09IGh1bmsub2xkTGluZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVtb3ZlZCBsaW5lIGNvdW50IGRpZCBub3QgbWF0Y2ggZm9yIGh1bmsgYXQgbGluZSAnICsgKGNodW5rSGVhZGVySW5kZXggKyAxKSk7XG4gICAgfVxuICAgIHJldHVybiBodW5rO1xuICB9XG4gIHdoaWxlIChpIDwgZGlmZnN0ci5sZW5ndGgpIHtcbiAgICBwYXJzZUluZGV4KCk7XG4gIH1cbiAgcmV0dXJuIGxpc3Q7XG59XG5cbi8vIEl0ZXJhdG9yIHRoYXQgdHJhdmVyc2VzIGluIHRoZSByYW5nZSBvZiBbbWluLCBtYXhdLCBzdGVwcGluZ1xuLy8gYnkgZGlzdGFuY2UgZnJvbSBhIGdpdmVuIHN0YXJ0IHBvc2l0aW9uLiBJLmUuIGZvciBbMCwgNF0sIHdpdGhcbi8vIHN0YXJ0IG9mIDIsIHRoaXMgd2lsbCBpdGVyYXRlIDIsIDMsIDEsIDQsIDAuXG5mdW5jdGlvbiBkaXN0YW5jZUl0ZXJhdG9yIChzdGFydCwgbWluTGluZSwgbWF4TGluZSkge1xuICB2YXIgd2FudEZvcndhcmQgPSB0cnVlLFxuICAgIGJhY2t3YXJkRXhoYXVzdGVkID0gZmFsc2UsXG4gICAgZm9yd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgIGxvY2FsT2Zmc2V0ID0gMTtcbiAgcmV0dXJuIGZ1bmN0aW9uIGl0ZXJhdG9yKCkge1xuICAgIGlmICh3YW50Rm9yd2FyZCAmJiAhZm9yd2FyZEV4aGF1c3RlZCkge1xuICAgICAgaWYgKGJhY2t3YXJkRXhoYXVzdGVkKSB7XG4gICAgICAgIGxvY2FsT2Zmc2V0Kys7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3YW50Rm9yd2FyZCA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB0cnlpbmcgdG8gZml0IGJleW9uZCB0ZXh0IGxlbmd0aCwgYW5kIGlmIG5vdCwgY2hlY2sgaXQgZml0c1xuICAgICAgLy8gYWZ0ZXIgb2Zmc2V0IGxvY2F0aW9uIChvciBkZXNpcmVkIGxvY2F0aW9uIG9uIGZpcnN0IGl0ZXJhdGlvbilcbiAgICAgIGlmIChzdGFydCArIGxvY2FsT2Zmc2V0IDw9IG1heExpbmUpIHtcbiAgICAgICAgcmV0dXJuIHN0YXJ0ICsgbG9jYWxPZmZzZXQ7XG4gICAgICB9XG4gICAgICBmb3J3YXJkRXhoYXVzdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKCFiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgaWYgKCFmb3J3YXJkRXhoYXVzdGVkKSB7XG4gICAgICAgIHdhbnRGb3J3YXJkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZWZvcmUgdGV4dCBiZWdpbm5pbmcsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGJlZm9yZSBvZmZzZXQgbG9jYXRpb25cbiAgICAgIGlmIChtaW5MaW5lIDw9IHN0YXJ0IC0gbG9jYWxPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIHN0YXJ0IC0gbG9jYWxPZmZzZXQrKztcbiAgICAgIH1cbiAgICAgIGJhY2t3YXJkRXhoYXVzdGVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiBpdGVyYXRvcigpO1xuICAgIH1cblxuICAgIC8vIFdlIHRyaWVkIHRvIGZpdCBodW5rIGJlZm9yZSB0ZXh0IGJlZ2lubmluZyBhbmQgYmV5b25kIHRleHQgbGVuZ3RoLCB0aGVuXG4gICAgLy8gaHVuayBjYW4ndCBmaXQgb24gdGhlIHRleHQuIFJldHVybiB1bmRlZmluZWRcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXBwbHlQYXRjaChzb3VyY2UsIHVuaURpZmYpIHtcbiAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICBpZiAodHlwZW9mIHVuaURpZmYgPT09ICdzdHJpbmcnKSB7XG4gICAgdW5pRGlmZiA9IHBhcnNlUGF0Y2godW5pRGlmZik7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkodW5pRGlmZikpIHtcbiAgICBpZiAodW5pRGlmZi5sZW5ndGggPiAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FwcGx5UGF0Y2ggb25seSB3b3JrcyB3aXRoIGEgc2luZ2xlIGlucHV0LicpO1xuICAgIH1cbiAgICB1bmlEaWZmID0gdW5pRGlmZlswXTtcbiAgfVxuICBpZiAob3B0aW9ucy5hdXRvQ29udmVydExpbmVFbmRpbmdzIHx8IG9wdGlvbnMuYXV0b0NvbnZlcnRMaW5lRW5kaW5ncyA9PSBudWxsKSB7XG4gICAgaWYgKGhhc09ubHlXaW5MaW5lRW5kaW5ncyhzb3VyY2UpICYmIGlzVW5peCh1bmlEaWZmKSkge1xuICAgICAgdW5pRGlmZiA9IHVuaXhUb1dpbih1bmlEaWZmKTtcbiAgICB9IGVsc2UgaWYgKGhhc09ubHlVbml4TGluZUVuZGluZ3Moc291cmNlKSAmJiBpc1dpbih1bmlEaWZmKSkge1xuICAgICAgdW5pRGlmZiA9IHdpblRvVW5peCh1bmlEaWZmKTtcbiAgICB9XG4gIH1cblxuICAvLyBBcHBseSB0aGUgZGlmZiB0byB0aGUgaW5wdXRcbiAgdmFyIGxpbmVzID0gc291cmNlLnNwbGl0KCdcXG4nKSxcbiAgICBodW5rcyA9IHVuaURpZmYuaHVua3MsXG4gICAgY29tcGFyZUxpbmUgPSBvcHRpb25zLmNvbXBhcmVMaW5lIHx8IGZ1bmN0aW9uIChsaW5lTnVtYmVyLCBsaW5lLCBvcGVyYXRpb24sIHBhdGNoQ29udGVudCkge1xuICAgICAgcmV0dXJuIGxpbmUgPT09IHBhdGNoQ29udGVudDtcbiAgICB9LFxuICAgIGZ1enpGYWN0b3IgPSBvcHRpb25zLmZ1enpGYWN0b3IgfHwgMCxcbiAgICBtaW5MaW5lID0gMDtcbiAgaWYgKGZ1enpGYWN0b3IgPCAwIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGZ1enpGYWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmdXp6RmFjdG9yIG11c3QgYmUgYSBub24tbmVnYXRpdmUgaW50ZWdlcicpO1xuICB9XG5cbiAgLy8gU3BlY2lhbCBjYXNlIGZvciBlbXB0eSBwYXRjaC5cbiAgaWYgKCFodW5rcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gc291cmNlO1xuICB9XG5cbiAgLy8gQmVmb3JlIGFueXRoaW5nIGVsc2UsIGhhbmRsZSBFT0ZOTCBpbnNlcnRpb24vcmVtb3ZhbC4gSWYgdGhlIHBhdGNoIHRlbGxzIHVzIHRvIG1ha2UgYSBjaGFuZ2VcbiAgLy8gdG8gdGhlIEVPRk5MIHRoYXQgaXMgcmVkdW5kYW50L2ltcG9zc2libGUgLSBpLmUuIHRvIHJlbW92ZSBhIG5ld2xpbmUgdGhhdCdzIG5vdCB0aGVyZSwgb3IgYWRkIGFcbiAgLy8gbmV3bGluZSB0aGF0IGFscmVhZHkgZXhpc3RzIC0gdGhlbiB3ZSBlaXRoZXIgcmV0dXJuIGZhbHNlIGFuZCBmYWlsIHRvIGFwcGx5IHRoZSBwYXRjaCAoaWZcbiAgLy8gZnV6ekZhY3RvciBpcyAwKSBvciBzaW1wbHkgaWdub3JlIHRoZSBwcm9ibGVtIGFuZCBkbyBub3RoaW5nIChpZiBmdXp6RmFjdG9yIGlzID4wKS5cbiAgLy8gSWYgd2UgZG8gbmVlZCB0byByZW1vdmUvYWRkIGEgbmV3bGluZSBhdCBFT0YsIHRoaXMgd2lsbCBhbHdheXMgYmUgaW4gdGhlIGZpbmFsIGh1bms6XG4gIHZhciBwcmV2TGluZSA9ICcnLFxuICAgIHJlbW92ZUVPRk5MID0gZmFsc2UsXG4gICAgYWRkRU9GTkwgPSBmYWxzZTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBodW5rc1todW5rcy5sZW5ndGggLSAxXS5saW5lcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBsaW5lID0gaHVua3NbaHVua3MubGVuZ3RoIC0gMV0ubGluZXNbaV07XG4gICAgaWYgKGxpbmVbMF0gPT0gJ1xcXFwnKSB7XG4gICAgICBpZiAocHJldkxpbmVbMF0gPT0gJysnKSB7XG4gICAgICAgIHJlbW92ZUVPRk5MID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAocHJldkxpbmVbMF0gPT0gJy0nKSB7XG4gICAgICAgIGFkZEVPRk5MID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcHJldkxpbmUgPSBsaW5lO1xuICB9XG4gIGlmIChyZW1vdmVFT0ZOTCkge1xuICAgIGlmIChhZGRFT0ZOTCkge1xuICAgICAgLy8gVGhpcyBtZWFucyB0aGUgZmluYWwgbGluZSBnZXRzIGNoYW5nZWQgYnV0IGRvZXNuJ3QgaGF2ZSBhIHRyYWlsaW5nIG5ld2xpbmUgaW4gZWl0aGVyIHRoZVxuICAgICAgLy8gb3JpZ2luYWwgb3IgcGF0Y2hlZCB2ZXJzaW9uLiBJbiB0aGF0IGNhc2UsIHdlIGRvIG5vdGhpbmcgaWYgZnV6ekZhY3RvciA+IDAsIGFuZCBpZlxuICAgICAgLy8gZnV6ekZhY3RvciBpcyAwLCB3ZSBzaW1wbHkgdmFsaWRhdGUgdGhhdCB0aGUgc291cmNlIGZpbGUgaGFzIG5vIHRyYWlsaW5nIG5ld2xpbmUuXG4gICAgICBpZiAoIWZ1enpGYWN0b3IgJiYgbGluZXNbbGluZXMubGVuZ3RoIC0gMV0gPT0gJycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobGluZXNbbGluZXMubGVuZ3RoIC0gMV0gPT0gJycpIHtcbiAgICAgIGxpbmVzLnBvcCgpO1xuICAgIH0gZWxzZSBpZiAoIWZ1enpGYWN0b3IpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoYWRkRU9GTkwpIHtcbiAgICBpZiAobGluZXNbbGluZXMubGVuZ3RoIC0gMV0gIT0gJycpIHtcbiAgICAgIGxpbmVzLnB1c2goJycpO1xuICAgIH0gZWxzZSBpZiAoIWZ1enpGYWN0b3IpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBodW5rIGNhbiBiZSBtYWRlIHRvIGZpdCBhdCB0aGUgcHJvdmlkZWQgbG9jYXRpb24gd2l0aCBhdCBtb3N0IGBtYXhFcnJvcnNgXG4gICAqIGluc2VydGlvbnMsIHN1YnN0aXR1dGlvbnMsIG9yIGRlbGV0aW9ucywgd2hpbGUgZW5zdXJpbmcgYWxzbyB0aGF0OlxuICAgKiAtIGxpbmVzIGRlbGV0ZWQgaW4gdGhlIGh1bmsgbWF0Y2ggZXhhY3RseSwgYW5kXG4gICAqIC0gd2hlcmV2ZXIgYW4gaW5zZXJ0aW9uIG9wZXJhdGlvbiBvciBibG9jayBvZiBpbnNlcnRpb24gb3BlcmF0aW9ucyBhcHBlYXJzIGluIHRoZSBodW5rLCB0aGVcbiAgICogICBpbW1lZGlhdGVseSBwcmVjZWRpbmcgYW5kIGZvbGxvd2luZyBsaW5lcyBvZiBjb250ZXh0IG1hdGNoIGV4YWN0bHlcbiAgICpcbiAgICogYHRvUG9zYCBzaG91bGQgYmUgc2V0IHN1Y2ggdGhhdCBsaW5lc1t0b1Bvc10gaXMgbWVhbnQgdG8gbWF0Y2ggaHVua0xpbmVzWzBdLlxuICAgKlxuICAgKiBJZiB0aGUgaHVuayBjYW4gYmUgYXBwbGllZCwgcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBwcm9wZXJ0aWVzIGBvbGRMaW5lTGFzdElgIGFuZFxuICAgKiBgcmVwbGFjZW1lbnRMaW5lc2AuIE90aGVyd2lzZSwgcmV0dXJucyBudWxsLlxuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHlIdW5rKGh1bmtMaW5lcywgdG9Qb3MsIG1heEVycm9ycykge1xuICAgIHZhciBodW5rTGluZXNJID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAwO1xuICAgIHZhciBsYXN0Q29udGV4dExpbmVNYXRjaGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlO1xuICAgIHZhciBwYXRjaGVkTGluZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gNSAmJiBhcmd1bWVudHNbNV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s1XSA6IFtdO1xuICAgIHZhciBwYXRjaGVkTGluZXNMZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoID4gNiAmJiBhcmd1bWVudHNbNl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s2XSA6IDA7XG4gICAgdmFyIG5Db25zZWN1dGl2ZU9sZENvbnRleHRMaW5lcyA9IDA7XG4gICAgdmFyIG5leHRDb250ZXh0TGluZU11c3RNYXRjaCA9IGZhbHNlO1xuICAgIGZvciAoOyBodW5rTGluZXNJIDwgaHVua0xpbmVzLmxlbmd0aDsgaHVua0xpbmVzSSsrKSB7XG4gICAgICB2YXIgaHVua0xpbmUgPSBodW5rTGluZXNbaHVua0xpbmVzSV0sXG4gICAgICAgIG9wZXJhdGlvbiA9IGh1bmtMaW5lLmxlbmd0aCA+IDAgPyBodW5rTGluZVswXSA6ICcgJyxcbiAgICAgICAgY29udGVudCA9IGh1bmtMaW5lLmxlbmd0aCA+IDAgPyBodW5rTGluZS5zdWJzdHIoMSkgOiBodW5rTGluZTtcbiAgICAgIGlmIChvcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICBpZiAoY29tcGFyZUxpbmUodG9Qb3MgKyAxLCBsaW5lc1t0b1Bvc10sIG9wZXJhdGlvbiwgY29udGVudCkpIHtcbiAgICAgICAgICB0b1BvcysrO1xuICAgICAgICAgIG5Db25zZWN1dGl2ZU9sZENvbnRleHRMaW5lcyA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCFtYXhFcnJvcnMgfHwgbGluZXNbdG9Qb3NdID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwYXRjaGVkTGluZXNbcGF0Y2hlZExpbmVzTGVuZ3RoXSA9IGxpbmVzW3RvUG9zXTtcbiAgICAgICAgICByZXR1cm4gYXBwbHlIdW5rKGh1bmtMaW5lcywgdG9Qb3MgKyAxLCBtYXhFcnJvcnMgLSAxLCBodW5rTGluZXNJLCBmYWxzZSwgcGF0Y2hlZExpbmVzLCBwYXRjaGVkTGluZXNMZW5ndGggKyAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgIGlmICghbGFzdENvbnRleHRMaW5lTWF0Y2hlZCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHBhdGNoZWRMaW5lc1twYXRjaGVkTGluZXNMZW5ndGhdID0gY29udGVudDtcbiAgICAgICAgcGF0Y2hlZExpbmVzTGVuZ3RoKys7XG4gICAgICAgIG5Db25zZWN1dGl2ZU9sZENvbnRleHRMaW5lcyA9IDA7XG4gICAgICAgIG5leHRDb250ZXh0TGluZU11c3RNYXRjaCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnICcpIHtcbiAgICAgICAgbkNvbnNlY3V0aXZlT2xkQ29udGV4dExpbmVzKys7XG4gICAgICAgIHBhdGNoZWRMaW5lc1twYXRjaGVkTGluZXNMZW5ndGhdID0gbGluZXNbdG9Qb3NdO1xuICAgICAgICBpZiAoY29tcGFyZUxpbmUodG9Qb3MgKyAxLCBsaW5lc1t0b1Bvc10sIG9wZXJhdGlvbiwgY29udGVudCkpIHtcbiAgICAgICAgICBwYXRjaGVkTGluZXNMZW5ndGgrKztcbiAgICAgICAgICBsYXN0Q29udGV4dExpbmVNYXRjaGVkID0gdHJ1ZTtcbiAgICAgICAgICBuZXh0Q29udGV4dExpbmVNdXN0TWF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICB0b1BvcysrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChuZXh0Q29udGV4dExpbmVNdXN0TWF0Y2ggfHwgIW1heEVycm9ycykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQ29uc2lkZXIgMyBwb3NzaWJpbGl0aWVzIGluIHNlcXVlbmNlOlxuICAgICAgICAgIC8vIDEuIGxpbmVzIGNvbnRhaW5zIGEgKnN1YnN0aXR1dGlvbiogbm90IGluY2x1ZGVkIGluIHRoZSBwYXRjaCBjb250ZXh0LCBvclxuICAgICAgICAgIC8vIDIuIGxpbmVzIGNvbnRhaW5zIGFuICppbnNlcnRpb24qIG5vdCBpbmNsdWRlZCBpbiB0aGUgcGF0Y2ggY29udGV4dCwgb3JcbiAgICAgICAgICAvLyAzLiBsaW5lcyBjb250YWlucyBhICpkZWxldGlvbiogbm90IGluY2x1ZGVkIGluIHRoZSBwYXRjaCBjb250ZXh0XG4gICAgICAgICAgLy8gVGhlIGZpcnN0IHR3byBvcHRpb25zIGFyZSBvZiBjb3Vyc2Ugb25seSBwb3NzaWJsZSBpZiB0aGUgbGluZSBmcm9tIGxpbmVzIGlzIG5vbi1udWxsIC1cbiAgICAgICAgICAvLyBpLmUuIG9ubHkgb3B0aW9uIDMgaXMgcG9zc2libGUgaWYgd2UndmUgb3ZlcnJ1biB0aGUgZW5kIG9mIHRoZSBvbGQgZmlsZS5cbiAgICAgICAgICByZXR1cm4gbGluZXNbdG9Qb3NdICYmIChhcHBseUh1bmsoaHVua0xpbmVzLCB0b1BvcyArIDEsIG1heEVycm9ycyAtIDEsIGh1bmtMaW5lc0kgKyAxLCBmYWxzZSwgcGF0Y2hlZExpbmVzLCBwYXRjaGVkTGluZXNMZW5ndGggKyAxKSB8fCBhcHBseUh1bmsoaHVua0xpbmVzLCB0b1BvcyArIDEsIG1heEVycm9ycyAtIDEsIGh1bmtMaW5lc0ksIGZhbHNlLCBwYXRjaGVkTGluZXMsIHBhdGNoZWRMaW5lc0xlbmd0aCArIDEpKSB8fCBhcHBseUh1bmsoaHVua0xpbmVzLCB0b1BvcywgbWF4RXJyb3JzIC0gMSwgaHVua0xpbmVzSSArIDEsIGZhbHNlLCBwYXRjaGVkTGluZXMsIHBhdGNoZWRMaW5lc0xlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBCZWZvcmUgcmV0dXJuaW5nLCB0cmltIGFueSB1bm1vZGlmaWVkIGNvbnRleHQgbGluZXMgb2ZmIHRoZSBlbmQgb2YgcGF0Y2hlZExpbmVzIGFuZCByZWR1Y2VcbiAgICAvLyB0b1BvcyAoYW5kIHRodXMgb2xkTGluZUxhc3RJKSBhY2NvcmRpbmdseS4gVGhpcyBhbGxvd3MgbGF0ZXIgaHVua3MgdG8gYmUgYXBwbGllZCB0byBhIHJlZ2lvblxuICAgIC8vIHRoYXQgc3RhcnRzIGluIHRoaXMgaHVuaydzIHRyYWlsaW5nIGNvbnRleHQuXG4gICAgcGF0Y2hlZExpbmVzTGVuZ3RoIC09IG5Db25zZWN1dGl2ZU9sZENvbnRleHRMaW5lcztcbiAgICB0b1BvcyAtPSBuQ29uc2VjdXRpdmVPbGRDb250ZXh0TGluZXM7XG4gICAgcGF0Y2hlZExpbmVzLmxlbmd0aCA9IHBhdGNoZWRMaW5lc0xlbmd0aDtcbiAgICByZXR1cm4ge1xuICAgICAgcGF0Y2hlZExpbmVzOiBwYXRjaGVkTGluZXMsXG4gICAgICBvbGRMaW5lTGFzdEk6IHRvUG9zIC0gMVxuICAgIH07XG4gIH1cbiAgdmFyIHJlc3VsdExpbmVzID0gW107XG5cbiAgLy8gU2VhcmNoIGJlc3QgZml0IG9mZnNldHMgZm9yIGVhY2ggaHVuayBiYXNlZCBvbiB0aGUgcHJldmlvdXMgb25lc1xuICB2YXIgcHJldkh1bmtPZmZzZXQgPSAwO1xuICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgaHVua3MubGVuZ3RoOyBfaSsrKSB7XG4gICAgdmFyIGh1bmsgPSBodW5rc1tfaV07XG4gICAgdmFyIGh1bmtSZXN1bHQgPSB2b2lkIDA7XG4gICAgdmFyIG1heExpbmUgPSBsaW5lcy5sZW5ndGggLSBodW5rLm9sZExpbmVzICsgZnV6ekZhY3RvcjtcbiAgICB2YXIgdG9Qb3MgPSB2b2lkIDA7XG4gICAgZm9yICh2YXIgbWF4RXJyb3JzID0gMDsgbWF4RXJyb3JzIDw9IGZ1enpGYWN0b3I7IG1heEVycm9ycysrKSB7XG4gICAgICB0b1BvcyA9IGh1bmsub2xkU3RhcnQgKyBwcmV2SHVua09mZnNldCAtIDE7XG4gICAgICB2YXIgaXRlcmF0b3IgPSBkaXN0YW5jZUl0ZXJhdG9yKHRvUG9zLCBtaW5MaW5lLCBtYXhMaW5lKTtcbiAgICAgIGZvciAoOyB0b1BvcyAhPT0gdW5kZWZpbmVkOyB0b1BvcyA9IGl0ZXJhdG9yKCkpIHtcbiAgICAgICAgaHVua1Jlc3VsdCA9IGFwcGx5SHVuayhodW5rLmxpbmVzLCB0b1BvcywgbWF4RXJyb3JzKTtcbiAgICAgICAgaWYgKGh1bmtSZXN1bHQpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGh1bmtSZXN1bHQpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghaHVua1Jlc3VsdCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENvcHkgZXZlcnl0aGluZyBmcm9tIHRoZSBlbmQgb2Ygd2hlcmUgd2UgYXBwbGllZCB0aGUgbGFzdCBodW5rIHRvIHRoZSBzdGFydCBvZiB0aGlzIGh1bmtcbiAgICBmb3IgKHZhciBfaTIgPSBtaW5MaW5lOyBfaTIgPCB0b1BvczsgX2kyKyspIHtcbiAgICAgIHJlc3VsdExpbmVzLnB1c2gobGluZXNbX2kyXSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHRoZSBsaW5lcyBwcm9kdWNlZCBieSBhcHBseWluZyB0aGUgaHVuazpcbiAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBodW5rUmVzdWx0LnBhdGNoZWRMaW5lcy5sZW5ndGg7IF9pMysrKSB7XG4gICAgICB2YXIgX2xpbmUgPSBodW5rUmVzdWx0LnBhdGNoZWRMaW5lc1tfaTNdO1xuICAgICAgcmVzdWx0TGluZXMucHVzaChfbGluZSk7XG4gICAgfVxuXG4gICAgLy8gU2V0IGxvd2VyIHRleHQgbGltaXQgdG8gZW5kIG9mIHRoZSBjdXJyZW50IGh1bmssIHNvIG5leHQgb25lcyBkb24ndCB0cnlcbiAgICAvLyB0byBmaXQgb3ZlciBhbHJlYWR5IHBhdGNoZWQgdGV4dFxuICAgIG1pbkxpbmUgPSBodW5rUmVzdWx0Lm9sZExpbmVMYXN0SSArIDE7XG5cbiAgICAvLyBOb3RlIHRoZSBvZmZzZXQgYmV0d2VlbiB3aGVyZSB0aGUgcGF0Y2ggc2FpZCB0aGUgaHVuayBzaG91bGQndmUgYXBwbGllZCBhbmQgd2hlcmUgd2VcbiAgICAvLyBhcHBsaWVkIGl0LCBzbyB3ZSBjYW4gYWRqdXN0IGZ1dHVyZSBodW5rcyBhY2NvcmRpbmdseTpcbiAgICBwcmV2SHVua09mZnNldCA9IHRvUG9zICsgMSAtIGh1bmsub2xkU3RhcnQ7XG4gIH1cblxuICAvLyBDb3B5IG92ZXIgdGhlIHJlc3Qgb2YgdGhlIGxpbmVzIGZyb20gdGhlIG9sZCB0ZXh0XG4gIGZvciAodmFyIF9pNCA9IG1pbkxpbmU7IF9pNCA8IGxpbmVzLmxlbmd0aDsgX2k0KyspIHtcbiAgICByZXN1bHRMaW5lcy5wdXNoKGxpbmVzW19pNF0pO1xuICB9XG4gIHJldHVybiByZXN1bHRMaW5lcy5qb2luKCdcXG4nKTtcbn1cblxuLy8gV3JhcHBlciB0aGF0IHN1cHBvcnRzIG11bHRpcGxlIGZpbGUgcGF0Y2hlcyB2aWEgY2FsbGJhY2tzLlxuZnVuY3Rpb24gYXBwbHlQYXRjaGVzKHVuaURpZmYsIG9wdGlvbnMpIHtcbiAgaWYgKHR5cGVvZiB1bmlEaWZmID09PSAnc3RyaW5nJykge1xuICAgIHVuaURpZmYgPSBwYXJzZVBhdGNoKHVuaURpZmYpO1xuICB9XG4gIHZhciBjdXJyZW50SW5kZXggPSAwO1xuICBmdW5jdGlvbiBwcm9jZXNzSW5kZXgoKSB7XG4gICAgdmFyIGluZGV4ID0gdW5pRGlmZltjdXJyZW50SW5kZXgrK107XG4gICAgaWYgKCFpbmRleCkge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoKTtcbiAgICB9XG4gICAgb3B0aW9ucy5sb2FkRmlsZShpbmRleCwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5jb21wbGV0ZShlcnIpO1xuICAgICAgfVxuICAgICAgdmFyIHVwZGF0ZWRDb250ZW50ID0gYXBwbHlQYXRjaChkYXRhLCBpbmRleCwgb3B0aW9ucyk7XG4gICAgICBvcHRpb25zLnBhdGNoZWQoaW5kZXgsIHVwZGF0ZWRDb250ZW50LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gb3B0aW9ucy5jb21wbGV0ZShlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHByb2Nlc3NJbmRleCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgcHJvY2Vzc0luZGV4KCk7XG59XG5cbmZ1bmN0aW9uIHN0cnVjdHVyZWRQYXRjaChvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgIGNhbGxiYWNrOiBvcHRpb25zXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZW9mIG9wdGlvbnMuY29udGV4dCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBvcHRpb25zLmNvbnRleHQgPSA0O1xuICB9XG4gIGlmIChvcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCduZXdsaW5lSXNUb2tlbiBtYXkgbm90IGJlIHVzZWQgd2l0aCBwYXRjaC1nZW5lcmF0aW9uIGZ1bmN0aW9ucywgb25seSB3aXRoIGRpZmZpbmcgZnVuY3Rpb25zJyk7XG4gIH1cbiAgaWYgKCFvcHRpb25zLmNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGRpZmZMaW5lc1Jlc3VsdFRvUGF0Y2goZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIF9vcHRpb25zID0gb3B0aW9ucyxcbiAgICAgIF9jYWxsYmFjayA9IF9vcHRpb25zLmNhbGxiYWNrO1xuICAgIGRpZmZMaW5lcyhvbGRTdHIsIG5ld1N0ciwgX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIG9wdGlvbnMpLCB7fSwge1xuICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGRpZmYpIHtcbiAgICAgICAgdmFyIHBhdGNoID0gZGlmZkxpbmVzUmVzdWx0VG9QYXRjaChkaWZmKTtcbiAgICAgICAgX2NhbGxiYWNrKHBhdGNoKTtcbiAgICAgIH1cbiAgICB9KSk7XG4gIH1cbiAgZnVuY3Rpb24gZGlmZkxpbmVzUmVzdWx0VG9QYXRjaChkaWZmKSB7XG4gICAgLy8gU1RFUCAxOiBCdWlsZCB1cCB0aGUgcGF0Y2ggd2l0aCBubyBcIlxcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGVcIiBsaW5lcyBhbmQgd2l0aCB0aGUgYXJyYXlzXG4gICAgLy8gICAgICAgICBvZiBsaW5lcyBjb250YWluaW5nIHRyYWlsaW5nIG5ld2xpbmUgY2hhcmFjdGVycy4gV2UnbGwgdGlkeSB1cCBsYXRlci4uLlxuXG4gICAgaWYgKCFkaWZmKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGRpZmYucHVzaCh7XG4gICAgICB2YWx1ZTogJycsXG4gICAgICBsaW5lczogW11cbiAgICB9KTsgLy8gQXBwZW5kIGFuIGVtcHR5IHZhbHVlIHRvIG1ha2UgY2xlYW51cCBlYXNpZXJcblxuICAgIGZ1bmN0aW9uIGNvbnRleHRMaW5lcyhsaW5lcykge1xuICAgICAgcmV0dXJuIGxpbmVzLm1hcChmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgcmV0dXJuICcgJyArIGVudHJ5O1xuICAgICAgfSk7XG4gICAgfVxuICAgIHZhciBodW5rcyA9IFtdO1xuICAgIHZhciBvbGRSYW5nZVN0YXJ0ID0gMCxcbiAgICAgIG5ld1JhbmdlU3RhcnQgPSAwLFxuICAgICAgY3VyUmFuZ2UgPSBbXSxcbiAgICAgIG9sZExpbmUgPSAxLFxuICAgICAgbmV3TGluZSA9IDE7XG4gICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7XG4gICAgICB2YXIgY3VycmVudCA9IGRpZmZbaV0sXG4gICAgICAgIGxpbmVzID0gY3VycmVudC5saW5lcyB8fCBzcGxpdExpbmVzKGN1cnJlbnQudmFsdWUpO1xuICAgICAgY3VycmVudC5saW5lcyA9IGxpbmVzO1xuICAgICAgaWYgKGN1cnJlbnQuYWRkZWQgfHwgY3VycmVudC5yZW1vdmVkKSB7XG4gICAgICAgIHZhciBfY3VyUmFuZ2U7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgcHJldmlvdXMgY29udGV4dCwgc3RhcnQgd2l0aCB0aGF0XG4gICAgICAgIGlmICghb2xkUmFuZ2VTdGFydCkge1xuICAgICAgICAgIHZhciBwcmV2ID0gZGlmZltpIC0gMV07XG4gICAgICAgICAgb2xkUmFuZ2VTdGFydCA9IG9sZExpbmU7XG4gICAgICAgICAgbmV3UmFuZ2VTdGFydCA9IG5ld0xpbmU7XG4gICAgICAgICAgaWYgKHByZXYpIHtcbiAgICAgICAgICAgIGN1clJhbmdlID0gb3B0aW9ucy5jb250ZXh0ID4gMCA/IGNvbnRleHRMaW5lcyhwcmV2LmxpbmVzLnNsaWNlKC1vcHRpb25zLmNvbnRleHQpKSA6IFtdO1xuICAgICAgICAgICAgb2xkUmFuZ2VTdGFydCAtPSBjdXJSYW5nZS5sZW5ndGg7XG4gICAgICAgICAgICBuZXdSYW5nZVN0YXJ0IC09IGN1clJhbmdlLmxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPdXRwdXQgb3VyIGNoYW5nZXNcbiAgICAgICAgKF9jdXJSYW5nZSA9IGN1clJhbmdlKS5wdXNoLmFwcGx5KF9jdXJSYW5nZSwgX3RvQ29uc3VtYWJsZUFycmF5KGxpbmVzLm1hcChmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgICByZXR1cm4gKGN1cnJlbnQuYWRkZWQgPyAnKycgOiAnLScpICsgZW50cnk7XG4gICAgICAgIH0pKSk7XG5cbiAgICAgICAgLy8gVHJhY2sgdGhlIHVwZGF0ZWQgZmlsZSBwb3NpdGlvblxuICAgICAgICBpZiAoY3VycmVudC5hZGRlZCkge1xuICAgICAgICAgIG5ld0xpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZExpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJZGVudGljYWwgY29udGV4dCBsaW5lcy4gVHJhY2sgbGluZSBjaGFuZ2VzXG4gICAgICAgIGlmIChvbGRSYW5nZVN0YXJ0KSB7XG4gICAgICAgICAgLy8gQ2xvc2Ugb3V0IGFueSBjaGFuZ2VzIHRoYXQgaGF2ZSBiZWVuIG91dHB1dCAob3Igam9pbiBvdmVybGFwcGluZylcbiAgICAgICAgICBpZiAobGluZXMubGVuZ3RoIDw9IG9wdGlvbnMuY29udGV4dCAqIDIgJiYgaSA8IGRpZmYubGVuZ3RoIC0gMikge1xuICAgICAgICAgICAgdmFyIF9jdXJSYW5nZTI7XG4gICAgICAgICAgICAvLyBPdmVybGFwcGluZ1xuICAgICAgICAgICAgKF9jdXJSYW5nZTIgPSBjdXJSYW5nZSkucHVzaC5hcHBseShfY3VyUmFuZ2UyLCBfdG9Db25zdW1hYmxlQXJyYXkoY29udGV4dExpbmVzKGxpbmVzKSkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgX2N1clJhbmdlMztcbiAgICAgICAgICAgIC8vIGVuZCB0aGUgcmFuZ2UgYW5kIG91dHB1dFxuICAgICAgICAgICAgdmFyIGNvbnRleHRTaXplID0gTWF0aC5taW4obGluZXMubGVuZ3RoLCBvcHRpb25zLmNvbnRleHQpO1xuICAgICAgICAgICAgKF9jdXJSYW5nZTMgPSBjdXJSYW5nZSkucHVzaC5hcHBseShfY3VyUmFuZ2UzLCBfdG9Db25zdW1hYmxlQXJyYXkoY29udGV4dExpbmVzKGxpbmVzLnNsaWNlKDAsIGNvbnRleHRTaXplKSkpKTtcbiAgICAgICAgICAgIHZhciBfaHVuayA9IHtcbiAgICAgICAgICAgICAgb2xkU3RhcnQ6IG9sZFJhbmdlU3RhcnQsXG4gICAgICAgICAgICAgIG9sZExpbmVzOiBvbGRMaW5lIC0gb2xkUmFuZ2VTdGFydCArIGNvbnRleHRTaXplLFxuICAgICAgICAgICAgICBuZXdTdGFydDogbmV3UmFuZ2VTdGFydCxcbiAgICAgICAgICAgICAgbmV3TGluZXM6IG5ld0xpbmUgLSBuZXdSYW5nZVN0YXJ0ICsgY29udGV4dFNpemUsXG4gICAgICAgICAgICAgIGxpbmVzOiBjdXJSYW5nZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGh1bmtzLnB1c2goX2h1bmspO1xuICAgICAgICAgICAgb2xkUmFuZ2VTdGFydCA9IDA7XG4gICAgICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgIGN1clJhbmdlID0gW107XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG9sZExpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgICAgICBuZXdMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGlmZi5sZW5ndGg7IGkrKykge1xuICAgICAgX2xvb3AoKTtcbiAgICB9XG5cbiAgICAvLyBTdGVwIDI6IGVsaW1pbmF0ZSB0aGUgdHJhaWxpbmcgYFxcbmAgZnJvbSBlYWNoIGxpbmUgb2YgZWFjaCBodW5rLCBhbmQsIHdoZXJlIG5lZWRlZCwgYWRkXG4gICAgLy8gICAgICAgICBcIlxcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGVcIi5cbiAgICBmb3IgKHZhciBfaSA9IDAsIF9odW5rcyA9IGh1bmtzOyBfaSA8IF9odW5rcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBodW5rID0gX2h1bmtzW19pXTtcbiAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IGh1bmsubGluZXMubGVuZ3RoOyBfaTIrKykge1xuICAgICAgICBpZiAoaHVuay5saW5lc1tfaTJdLmVuZHNXaXRoKCdcXG4nKSkge1xuICAgICAgICAgIGh1bmsubGluZXNbX2kyXSA9IGh1bmsubGluZXNbX2kyXS5zbGljZSgwLCAtMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaHVuay5saW5lcy5zcGxpY2UoX2kyICsgMSwgMCwgJ1xcXFwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZScpO1xuICAgICAgICAgIF9pMisrOyAvLyBTa2lwIHRoZSBsaW5lIHdlIGp1c3QgYWRkZWQsIHRoZW4gY29udGludWUgaXRlcmF0aW5nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIG9sZEZpbGVOYW1lOiBvbGRGaWxlTmFtZSxcbiAgICAgIG5ld0ZpbGVOYW1lOiBuZXdGaWxlTmFtZSxcbiAgICAgIG9sZEhlYWRlcjogb2xkSGVhZGVyLFxuICAgICAgbmV3SGVhZGVyOiBuZXdIZWFkZXIsXG4gICAgICBodW5rczogaHVua3NcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBmb3JtYXRQYXRjaChkaWZmKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGRpZmYpKSB7XG4gICAgcmV0dXJuIGRpZmYubWFwKGZvcm1hdFBhdGNoKS5qb2luKCdcXG4nKTtcbiAgfVxuICB2YXIgcmV0ID0gW107XG4gIGlmIChkaWZmLm9sZEZpbGVOYW1lID09IGRpZmYubmV3RmlsZU5hbWUpIHtcbiAgICByZXQucHVzaCgnSW5kZXg6ICcgKyBkaWZmLm9sZEZpbGVOYW1lKTtcbiAgfVxuICByZXQucHVzaCgnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xuICByZXQucHVzaCgnLS0tICcgKyBkaWZmLm9sZEZpbGVOYW1lICsgKHR5cGVvZiBkaWZmLm9sZEhlYWRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnJyA6ICdcXHQnICsgZGlmZi5vbGRIZWFkZXIpKTtcbiAgcmV0LnB1c2goJysrKyAnICsgZGlmZi5uZXdGaWxlTmFtZSArICh0eXBlb2YgZGlmZi5uZXdIZWFkZXIgPT09ICd1bmRlZmluZWQnID8gJycgOiAnXFx0JyArIGRpZmYubmV3SGVhZGVyKSk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZGlmZi5odW5rcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBodW5rID0gZGlmZi5odW5rc1tpXTtcbiAgICAvLyBVbmlmaWVkIERpZmYgRm9ybWF0IHF1aXJrOiBJZiB0aGUgY2h1bmsgc2l6ZSBpcyAwLFxuICAgIC8vIHRoZSBmaXJzdCBudW1iZXIgaXMgb25lIGxvd2VyIHRoYW4gb25lIHdvdWxkIGV4cGVjdC5cbiAgICAvLyBodHRwczovL3d3dy5hcnRpbWEuY29tL3dlYmxvZ3Mvdmlld3Bvc3QuanNwP3RocmVhZD0xNjQyOTNcbiAgICBpZiAoaHVuay5vbGRMaW5lcyA9PT0gMCkge1xuICAgICAgaHVuay5vbGRTdGFydCAtPSAxO1xuICAgIH1cbiAgICBpZiAoaHVuay5uZXdMaW5lcyA9PT0gMCkge1xuICAgICAgaHVuay5uZXdTdGFydCAtPSAxO1xuICAgIH1cbiAgICByZXQucHVzaCgnQEAgLScgKyBodW5rLm9sZFN0YXJ0ICsgJywnICsgaHVuay5vbGRMaW5lcyArICcgKycgKyBodW5rLm5ld1N0YXJ0ICsgJywnICsgaHVuay5uZXdMaW5lcyArICcgQEAnKTtcbiAgICByZXQucHVzaC5hcHBseShyZXQsIGh1bmsubGluZXMpO1xuICB9XG4gIHJldHVybiByZXQuam9pbignXFxuJykgKyAnXFxuJztcbn1cbmZ1bmN0aW9uIGNyZWF0ZVR3b0ZpbGVzUGF0Y2gob2xkRmlsZU5hbWUsIG5ld0ZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgdmFyIF9vcHRpb25zMjtcbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgIGNhbGxiYWNrOiBvcHRpb25zXG4gICAgfTtcbiAgfVxuICBpZiAoISgoX29wdGlvbnMyID0gb3B0aW9ucykgIT09IG51bGwgJiYgX29wdGlvbnMyICE9PSB2b2lkIDAgJiYgX29wdGlvbnMyLmNhbGxiYWNrKSkge1xuICAgIHZhciBwYXRjaE9iaiA9IHN0cnVjdHVyZWRQYXRjaChvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucyk7XG4gICAgaWYgKCFwYXRjaE9iaikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0UGF0Y2gocGF0Y2hPYmopO1xuICB9IGVsc2Uge1xuICAgIHZhciBfb3B0aW9uczMgPSBvcHRpb25zLFxuICAgICAgX2NhbGxiYWNrMiA9IF9vcHRpb25zMy5jYWxsYmFjaztcbiAgICBzdHJ1Y3R1cmVkUGF0Y2gob2xkRmlsZU5hbWUsIG5ld0ZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCBvcHRpb25zKSwge30sIHtcbiAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhwYXRjaE9iaikge1xuICAgICAgICBpZiAoIXBhdGNoT2JqKSB7XG4gICAgICAgICAgX2NhbGxiYWNrMigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9jYWxsYmFjazIoZm9ybWF0UGF0Y2gocGF0Y2hPYmopKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pKTtcbiAgfVxufVxuZnVuY3Rpb24gY3JlYXRlUGF0Y2goZmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucykge1xuICByZXR1cm4gY3JlYXRlVHdvRmlsZXNQYXRjaChmaWxlTmFtZSwgZmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucyk7XG59XG5cbi8qKlxuICogU3BsaXQgYHRleHRgIGludG8gYW4gYXJyYXkgb2YgbGluZXMsIGluY2x1ZGluZyB0aGUgdHJhaWxpbmcgbmV3bGluZSBjaGFyYWN0ZXIgKHdoZXJlIHByZXNlbnQpXG4gKi9cbmZ1bmN0aW9uIHNwbGl0TGluZXModGV4dCkge1xuICB2YXIgaGFzVHJhaWxpbmdObCA9IHRleHQuZW5kc1dpdGgoJ1xcbicpO1xuICB2YXIgcmVzdWx0ID0gdGV4dC5zcGxpdCgnXFxuJykubWFwKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgcmV0dXJuIGxpbmUgKyAnXFxuJztcbiAgfSk7XG4gIGlmIChoYXNUcmFpbGluZ05sKSB7XG4gICAgcmVzdWx0LnBvcCgpO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5wdXNoKHJlc3VsdC5wb3AoKS5zbGljZSgwLCAtMSkpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGFycmF5RXF1YWwoYSwgYikge1xuICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiBhcnJheVN0YXJ0c1dpdGgoYSwgYik7XG59XG5mdW5jdGlvbiBhcnJheVN0YXJ0c1dpdGgoYXJyYXksIHN0YXJ0KSB7XG4gIGlmIChzdGFydC5sZW5ndGggPiBhcnJheS5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGFydC5sZW5ndGg7IGkrKykge1xuICAgIGlmIChzdGFydFtpXSAhPT0gYXJyYXlbaV0pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGNhbGNMaW5lQ291bnQoaHVuaykge1xuICB2YXIgX2NhbGNPbGROZXdMaW5lQ291bnQgPSBjYWxjT2xkTmV3TGluZUNvdW50KGh1bmsubGluZXMpLFxuICAgIG9sZExpbmVzID0gX2NhbGNPbGROZXdMaW5lQ291bnQub2xkTGluZXMsXG4gICAgbmV3TGluZXMgPSBfY2FsY09sZE5ld0xpbmVDb3VudC5uZXdMaW5lcztcbiAgaWYgKG9sZExpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICBodW5rLm9sZExpbmVzID0gb2xkTGluZXM7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlIGh1bmsub2xkTGluZXM7XG4gIH1cbiAgaWYgKG5ld0xpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICBodW5rLm5ld0xpbmVzID0gbmV3TGluZXM7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlIGh1bmsubmV3TGluZXM7XG4gIH1cbn1cbmZ1bmN0aW9uIG1lcmdlKG1pbmUsIHRoZWlycywgYmFzZSkge1xuICBtaW5lID0gbG9hZFBhdGNoKG1pbmUsIGJhc2UpO1xuICB0aGVpcnMgPSBsb2FkUGF0Y2godGhlaXJzLCBiYXNlKTtcbiAgdmFyIHJldCA9IHt9O1xuXG4gIC8vIEZvciBpbmRleCB3ZSBqdXN0IGxldCBpdCBwYXNzIHRocm91Z2ggYXMgaXQgZG9lc24ndCBoYXZlIGFueSBuZWNlc3NhcnkgbWVhbmluZy5cbiAgLy8gTGVhdmluZyBzYW5pdHkgY2hlY2tzIG9uIHRoaXMgdG8gdGhlIEFQSSBjb25zdW1lciB0aGF0IG1heSBrbm93IG1vcmUgYWJvdXQgdGhlXG4gIC8vIG1lYW5pbmcgaW4gdGhlaXIgb3duIGNvbnRleHQuXG4gIGlmIChtaW5lLmluZGV4IHx8IHRoZWlycy5pbmRleCkge1xuICAgIHJldC5pbmRleCA9IG1pbmUuaW5kZXggfHwgdGhlaXJzLmluZGV4O1xuICB9XG4gIGlmIChtaW5lLm5ld0ZpbGVOYW1lIHx8IHRoZWlycy5uZXdGaWxlTmFtZSkge1xuICAgIGlmICghZmlsZU5hbWVDaGFuZ2VkKG1pbmUpKSB7XG4gICAgICAvLyBObyBoZWFkZXIgb3Igbm8gY2hhbmdlIGluIG91cnMsIHVzZSB0aGVpcnMgKGFuZCBvdXJzIGlmIHRoZWlycyBkb2VzIG5vdCBleGlzdClcbiAgICAgIHJldC5vbGRGaWxlTmFtZSA9IHRoZWlycy5vbGRGaWxlTmFtZSB8fCBtaW5lLm9sZEZpbGVOYW1lO1xuICAgICAgcmV0Lm5ld0ZpbGVOYW1lID0gdGhlaXJzLm5ld0ZpbGVOYW1lIHx8IG1pbmUubmV3RmlsZU5hbWU7XG4gICAgICByZXQub2xkSGVhZGVyID0gdGhlaXJzLm9sZEhlYWRlciB8fCBtaW5lLm9sZEhlYWRlcjtcbiAgICAgIHJldC5uZXdIZWFkZXIgPSB0aGVpcnMubmV3SGVhZGVyIHx8IG1pbmUubmV3SGVhZGVyO1xuICAgIH0gZWxzZSBpZiAoIWZpbGVOYW1lQ2hhbmdlZCh0aGVpcnMpKSB7XG4gICAgICAvLyBObyBoZWFkZXIgb3Igbm8gY2hhbmdlIGluIHRoZWlycywgdXNlIG91cnNcbiAgICAgIHJldC5vbGRGaWxlTmFtZSA9IG1pbmUub2xkRmlsZU5hbWU7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSBtaW5lLm5ld0ZpbGVOYW1lO1xuICAgICAgcmV0Lm9sZEhlYWRlciA9IG1pbmUub2xkSGVhZGVyO1xuICAgICAgcmV0Lm5ld0hlYWRlciA9IG1pbmUubmV3SGVhZGVyO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBCb3RoIGNoYW5nZWQuLi4gZmlndXJlIGl0IG91dFxuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm9sZEZpbGVOYW1lLCB0aGVpcnMub2xkRmlsZU5hbWUpO1xuICAgICAgcmV0Lm5ld0ZpbGVOYW1lID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm5ld0ZpbGVOYW1lLCB0aGVpcnMubmV3RmlsZU5hbWUpO1xuICAgICAgcmV0Lm9sZEhlYWRlciA9IHNlbGVjdEZpZWxkKHJldCwgbWluZS5vbGRIZWFkZXIsIHRoZWlycy5vbGRIZWFkZXIpO1xuICAgICAgcmV0Lm5ld0hlYWRlciA9IHNlbGVjdEZpZWxkKHJldCwgbWluZS5uZXdIZWFkZXIsIHRoZWlycy5uZXdIZWFkZXIpO1xuICAgIH1cbiAgfVxuICByZXQuaHVua3MgPSBbXTtcbiAgdmFyIG1pbmVJbmRleCA9IDAsXG4gICAgdGhlaXJzSW5kZXggPSAwLFxuICAgIG1pbmVPZmZzZXQgPSAwLFxuICAgIHRoZWlyc09mZnNldCA9IDA7XG4gIHdoaWxlIChtaW5lSW5kZXggPCBtaW5lLmh1bmtzLmxlbmd0aCB8fCB0aGVpcnNJbmRleCA8IHRoZWlycy5odW5rcy5sZW5ndGgpIHtcbiAgICB2YXIgbWluZUN1cnJlbnQgPSBtaW5lLmh1bmtzW21pbmVJbmRleF0gfHwge1xuICAgICAgICBvbGRTdGFydDogSW5maW5pdHlcbiAgICAgIH0sXG4gICAgICB0aGVpcnNDdXJyZW50ID0gdGhlaXJzLmh1bmtzW3RoZWlyc0luZGV4XSB8fCB7XG4gICAgICAgIG9sZFN0YXJ0OiBJbmZpbml0eVxuICAgICAgfTtcbiAgICBpZiAoaHVua0JlZm9yZShtaW5lQ3VycmVudCwgdGhlaXJzQ3VycmVudCkpIHtcbiAgICAgIC8vIFRoaXMgcGF0Y2ggZG9lcyBub3Qgb3ZlcmxhcCB3aXRoIGFueSBvZiB0aGUgb3RoZXJzLCB5YXkuXG4gICAgICByZXQuaHVua3MucHVzaChjbG9uZUh1bmsobWluZUN1cnJlbnQsIG1pbmVPZmZzZXQpKTtcbiAgICAgIG1pbmVJbmRleCsrO1xuICAgICAgdGhlaXJzT2Zmc2V0ICs9IG1pbmVDdXJyZW50Lm5ld0xpbmVzIC0gbWluZUN1cnJlbnQub2xkTGluZXM7XG4gICAgfSBlbHNlIGlmIChodW5rQmVmb3JlKHRoZWlyc0N1cnJlbnQsIG1pbmVDdXJyZW50KSkge1xuICAgICAgLy8gVGhpcyBwYXRjaCBkb2VzIG5vdCBvdmVybGFwIHdpdGggYW55IG9mIHRoZSBvdGhlcnMsIHlheS5cbiAgICAgIHJldC5odW5rcy5wdXNoKGNsb25lSHVuayh0aGVpcnNDdXJyZW50LCB0aGVpcnNPZmZzZXQpKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lT2Zmc2V0ICs9IHRoZWlyc0N1cnJlbnQubmV3TGluZXMgLSB0aGVpcnNDdXJyZW50Lm9sZExpbmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdmVybGFwLCBtZXJnZSBhcyBiZXN0IHdlIGNhblxuICAgICAgdmFyIG1lcmdlZEh1bmsgPSB7XG4gICAgICAgIG9sZFN0YXJ0OiBNYXRoLm1pbihtaW5lQ3VycmVudC5vbGRTdGFydCwgdGhlaXJzQ3VycmVudC5vbGRTdGFydCksXG4gICAgICAgIG9sZExpbmVzOiAwLFxuICAgICAgICBuZXdTdGFydDogTWF0aC5taW4obWluZUN1cnJlbnQubmV3U3RhcnQgKyBtaW5lT2Zmc2V0LCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0ICsgdGhlaXJzT2Zmc2V0KSxcbiAgICAgICAgbmV3TGluZXM6IDAsXG4gICAgICAgIGxpbmVzOiBbXVxuICAgICAgfTtcbiAgICAgIG1lcmdlTGluZXMobWVyZ2VkSHVuaywgbWluZUN1cnJlbnQub2xkU3RhcnQsIG1pbmVDdXJyZW50LmxpbmVzLCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0LCB0aGVpcnNDdXJyZW50LmxpbmVzKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lSW5kZXgrKztcbiAgICAgIHJldC5odW5rcy5wdXNoKG1lcmdlZEh1bmspO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gbG9hZFBhdGNoKHBhcmFtLCBiYXNlKSB7XG4gIGlmICh0eXBlb2YgcGFyYW0gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKC9eQEAvbS50ZXN0KHBhcmFtKSB8fCAvXkluZGV4Oi9tLnRlc3QocGFyYW0pKSB7XG4gICAgICByZXR1cm4gcGFyc2VQYXRjaChwYXJhbSlbMF07XG4gICAgfVxuICAgIGlmICghYmFzZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHByb3ZpZGUgYSBiYXNlIHJlZmVyZW5jZSBvciBwYXNzIGluIGEgcGF0Y2gnKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cnVjdHVyZWRQYXRjaCh1bmRlZmluZWQsIHVuZGVmaW5lZCwgYmFzZSwgcGFyYW0pO1xuICB9XG4gIHJldHVybiBwYXJhbTtcbn1cbmZ1bmN0aW9uIGZpbGVOYW1lQ2hhbmdlZChwYXRjaCkge1xuICByZXR1cm4gcGF0Y2gubmV3RmlsZU5hbWUgJiYgcGF0Y2gubmV3RmlsZU5hbWUgIT09IHBhdGNoLm9sZEZpbGVOYW1lO1xufVxuZnVuY3Rpb24gc2VsZWN0RmllbGQoaW5kZXgsIG1pbmUsIHRoZWlycykge1xuICBpZiAobWluZSA9PT0gdGhlaXJzKSB7XG4gICAgcmV0dXJuIG1pbmU7XG4gIH0gZWxzZSB7XG4gICAgaW5kZXguY29uZmxpY3QgPSB0cnVlO1xuICAgIHJldHVybiB7XG4gICAgICBtaW5lOiBtaW5lLFxuICAgICAgdGhlaXJzOiB0aGVpcnNcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBodW5rQmVmb3JlKHRlc3QsIGNoZWNrKSB7XG4gIHJldHVybiB0ZXN0Lm9sZFN0YXJ0IDwgY2hlY2sub2xkU3RhcnQgJiYgdGVzdC5vbGRTdGFydCArIHRlc3Qub2xkTGluZXMgPCBjaGVjay5vbGRTdGFydDtcbn1cbmZ1bmN0aW9uIGNsb25lSHVuayhodW5rLCBvZmZzZXQpIHtcbiAgcmV0dXJuIHtcbiAgICBvbGRTdGFydDogaHVuay5vbGRTdGFydCxcbiAgICBvbGRMaW5lczogaHVuay5vbGRMaW5lcyxcbiAgICBuZXdTdGFydDogaHVuay5uZXdTdGFydCArIG9mZnNldCxcbiAgICBuZXdMaW5lczogaHVuay5uZXdMaW5lcyxcbiAgICBsaW5lczogaHVuay5saW5lc1xuICB9O1xufVxuZnVuY3Rpb24gbWVyZ2VMaW5lcyhodW5rLCBtaW5lT2Zmc2V0LCBtaW5lTGluZXMsIHRoZWlyT2Zmc2V0LCB0aGVpckxpbmVzKSB7XG4gIC8vIFRoaXMgd2lsbCBnZW5lcmFsbHkgcmVzdWx0IGluIGEgY29uZmxpY3RlZCBodW5rLCBidXQgdGhlcmUgYXJlIGNhc2VzIHdoZXJlIHRoZSBjb250ZXh0XG4gIC8vIGlzIHRoZSBvbmx5IG92ZXJsYXAgd2hlcmUgd2UgY2FuIHN1Y2Nlc3NmdWxseSBtZXJnZSB0aGUgY29udGVudCBoZXJlLlxuICB2YXIgbWluZSA9IHtcbiAgICAgIG9mZnNldDogbWluZU9mZnNldCxcbiAgICAgIGxpbmVzOiBtaW5lTGluZXMsXG4gICAgICBpbmRleDogMFxuICAgIH0sXG4gICAgdGhlaXIgPSB7XG4gICAgICBvZmZzZXQ6IHRoZWlyT2Zmc2V0LFxuICAgICAgbGluZXM6IHRoZWlyTGluZXMsXG4gICAgICBpbmRleDogMFxuICAgIH07XG5cbiAgLy8gSGFuZGxlIGFueSBsZWFkaW5nIGNvbnRlbnRcbiAgaW5zZXJ0TGVhZGluZyhodW5rLCBtaW5lLCB0aGVpcik7XG4gIGluc2VydExlYWRpbmcoaHVuaywgdGhlaXIsIG1pbmUpO1xuXG4gIC8vIE5vdyBpbiB0aGUgb3ZlcmxhcCBjb250ZW50LiBTY2FuIHRocm91Z2ggYW5kIHNlbGVjdCB0aGUgYmVzdCBjaGFuZ2VzIGZyb20gZWFjaC5cbiAgd2hpbGUgKG1pbmUuaW5kZXggPCBtaW5lLmxpbmVzLmxlbmd0aCAmJiB0aGVpci5pbmRleCA8IHRoZWlyLmxpbmVzLmxlbmd0aCkge1xuICAgIHZhciBtaW5lQ3VycmVudCA9IG1pbmUubGluZXNbbWluZS5pbmRleF0sXG4gICAgICB0aGVpckN1cnJlbnQgPSB0aGVpci5saW5lc1t0aGVpci5pbmRleF07XG4gICAgaWYgKChtaW5lQ3VycmVudFswXSA9PT0gJy0nIHx8IG1pbmVDdXJyZW50WzBdID09PSAnKycpICYmICh0aGVpckN1cnJlbnRbMF0gPT09ICctJyB8fCB0aGVpckN1cnJlbnRbMF0gPT09ICcrJykpIHtcbiAgICAgIC8vIEJvdGggbW9kaWZpZWQgLi4uXG4gICAgICBtdXR1YWxDaGFuZ2UoaHVuaywgbWluZSwgdGhlaXIpO1xuICAgIH0gZWxzZSBpZiAobWluZUN1cnJlbnRbMF0gPT09ICcrJyAmJiB0aGVpckN1cnJlbnRbMF0gPT09ICcgJykge1xuICAgICAgdmFyIF9odW5rJGxpbmVzO1xuICAgICAgLy8gTWluZSBpbnNlcnRlZFxuICAgICAgKF9odW5rJGxpbmVzID0gaHVuay5saW5lcykucHVzaC5hcHBseShfaHVuayRsaW5lcywgX3RvQ29uc3VtYWJsZUFycmF5KGNvbGxlY3RDaGFuZ2UobWluZSkpKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJysnICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIHZhciBfaHVuayRsaW5lczI7XG4gICAgICAvLyBUaGVpcnMgaW5zZXJ0ZWRcbiAgICAgIChfaHVuayRsaW5lczIgPSBodW5rLmxpbmVzKS5wdXNoLmFwcGx5KF9odW5rJGxpbmVzMiwgX3RvQ29uc3VtYWJsZUFycmF5KGNvbGxlY3RDaGFuZ2UodGhlaXIpKSk7XG4gICAgfSBlbHNlIGlmIChtaW5lQ3VycmVudFswXSA9PT0gJy0nICYmIHRoZWlyQ3VycmVudFswXSA9PT0gJyAnKSB7XG4gICAgICAvLyBNaW5lIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJy0nICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlyIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIHRoZWlyLCBtaW5lLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKG1pbmVDdXJyZW50ID09PSB0aGVpckN1cnJlbnQpIHtcbiAgICAgIC8vIENvbnRleHQgaWRlbnRpdHlcbiAgICAgIGh1bmsubGluZXMucHVzaChtaW5lQ3VycmVudCk7XG4gICAgICBtaW5lLmluZGV4Kys7XG4gICAgICB0aGVpci5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb250ZXh0IG1pc21hdGNoXG4gICAgICBjb25mbGljdChodW5rLCBjb2xsZWN0Q2hhbmdlKG1pbmUpLCBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gTm93IHB1c2ggYW55dGhpbmcgdGhhdCBtYXkgYmUgcmVtYWluaW5nXG4gIGluc2VydFRyYWlsaW5nKGh1bmssIG1pbmUpO1xuICBpbnNlcnRUcmFpbGluZyhodW5rLCB0aGVpcik7XG4gIGNhbGNMaW5lQ291bnQoaHVuayk7XG59XG5mdW5jdGlvbiBtdXR1YWxDaGFuZ2UoaHVuaywgbWluZSwgdGhlaXIpIHtcbiAgdmFyIG15Q2hhbmdlcyA9IGNvbGxlY3RDaGFuZ2UobWluZSksXG4gICAgdGhlaXJDaGFuZ2VzID0gY29sbGVjdENoYW5nZSh0aGVpcik7XG4gIGlmIChhbGxSZW1vdmVzKG15Q2hhbmdlcykgJiYgYWxsUmVtb3Zlcyh0aGVpckNoYW5nZXMpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlIGZvciByZW1vdmUgY2hhbmdlcyB0aGF0IGFyZSBzdXBlcnNldHMgb2Ygb25lIGFub3RoZXJcbiAgICBpZiAoYXJyYXlTdGFydHNXaXRoKG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKSAmJiBza2lwUmVtb3ZlU3VwZXJzZXQodGhlaXIsIG15Q2hhbmdlcywgbXlDaGFuZ2VzLmxlbmd0aCAtIHRoZWlyQ2hhbmdlcy5sZW5ndGgpKSB7XG4gICAgICB2YXIgX2h1bmskbGluZXMzO1xuICAgICAgKF9odW5rJGxpbmVzMyA9IGh1bmsubGluZXMpLnB1c2guYXBwbHkoX2h1bmskbGluZXMzLCBfdG9Db25zdW1hYmxlQXJyYXkobXlDaGFuZ2VzKSk7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChhcnJheVN0YXJ0c1dpdGgodGhlaXJDaGFuZ2VzLCBteUNoYW5nZXMpICYmIHNraXBSZW1vdmVTdXBlcnNldChtaW5lLCB0aGVpckNoYW5nZXMsIHRoZWlyQ2hhbmdlcy5sZW5ndGggLSBteUNoYW5nZXMubGVuZ3RoKSkge1xuICAgICAgdmFyIF9odW5rJGxpbmVzNDtcbiAgICAgIChfaHVuayRsaW5lczQgPSBodW5rLmxpbmVzKS5wdXNoLmFwcGx5KF9odW5rJGxpbmVzNCwgX3RvQ29uc3VtYWJsZUFycmF5KHRoZWlyQ2hhbmdlcykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSBlbHNlIGlmIChhcnJheUVxdWFsKG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKSkge1xuICAgIHZhciBfaHVuayRsaW5lczU7XG4gICAgKF9odW5rJGxpbmVzNSA9IGh1bmsubGluZXMpLnB1c2guYXBwbHkoX2h1bmskbGluZXM1LCBfdG9Db25zdW1hYmxlQXJyYXkobXlDaGFuZ2VzKSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbmZsaWN0KGh1bmssIG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKTtcbn1cbmZ1bmN0aW9uIHJlbW92YWwoaHVuaywgbWluZSwgdGhlaXIsIHN3YXApIHtcbiAgdmFyIG15Q2hhbmdlcyA9IGNvbGxlY3RDaGFuZ2UobWluZSksXG4gICAgdGhlaXJDaGFuZ2VzID0gY29sbGVjdENvbnRleHQodGhlaXIsIG15Q2hhbmdlcyk7XG4gIGlmICh0aGVpckNoYW5nZXMubWVyZ2VkKSB7XG4gICAgdmFyIF9odW5rJGxpbmVzNjtcbiAgICAoX2h1bmskbGluZXM2ID0gaHVuay5saW5lcykucHVzaC5hcHBseShfaHVuayRsaW5lczYsIF90b0NvbnN1bWFibGVBcnJheSh0aGVpckNoYW5nZXMubWVyZ2VkKSk7XG4gIH0gZWxzZSB7XG4gICAgY29uZmxpY3QoaHVuaywgc3dhcCA/IHRoZWlyQ2hhbmdlcyA6IG15Q2hhbmdlcywgc3dhcCA/IG15Q2hhbmdlcyA6IHRoZWlyQ2hhbmdlcyk7XG4gIH1cbn1cbmZ1bmN0aW9uIGNvbmZsaWN0KGh1bmssIG1pbmUsIHRoZWlyKSB7XG4gIGh1bmsuY29uZmxpY3QgPSB0cnVlO1xuICBodW5rLmxpbmVzLnB1c2goe1xuICAgIGNvbmZsaWN0OiB0cnVlLFxuICAgIG1pbmU6IG1pbmUsXG4gICAgdGhlaXJzOiB0aGVpclxuICB9KTtcbn1cbmZ1bmN0aW9uIGluc2VydExlYWRpbmcoaHVuaywgaW5zZXJ0LCB0aGVpcikge1xuICB3aGlsZSAoaW5zZXJ0Lm9mZnNldCA8IHRoZWlyLm9mZnNldCAmJiBpbnNlcnQuaW5kZXggPCBpbnNlcnQubGluZXMubGVuZ3RoKSB7XG4gICAgdmFyIGxpbmUgPSBpbnNlcnQubGluZXNbaW5zZXJ0LmluZGV4KytdO1xuICAgIGh1bmsubGluZXMucHVzaChsaW5lKTtcbiAgICBpbnNlcnQub2Zmc2V0Kys7XG4gIH1cbn1cbmZ1bmN0aW9uIGluc2VydFRyYWlsaW5nKGh1bmssIGluc2VydCkge1xuICB3aGlsZSAoaW5zZXJ0LmluZGV4IDwgaW5zZXJ0LmxpbmVzLmxlbmd0aCkge1xuICAgIHZhciBsaW5lID0gaW5zZXJ0LmxpbmVzW2luc2VydC5pbmRleCsrXTtcbiAgICBodW5rLmxpbmVzLnB1c2gobGluZSk7XG4gIH1cbn1cbmZ1bmN0aW9uIGNvbGxlY3RDaGFuZ2Uoc3RhdGUpIHtcbiAgdmFyIHJldCA9IFtdLFxuICAgIG9wZXJhdGlvbiA9IHN0YXRlLmxpbmVzW3N0YXRlLmluZGV4XVswXTtcbiAgd2hpbGUgKHN0YXRlLmluZGV4IDwgc3RhdGUubGluZXMubGVuZ3RoKSB7XG4gICAgdmFyIGxpbmUgPSBzdGF0ZS5saW5lc1tzdGF0ZS5pbmRleF07XG5cbiAgICAvLyBHcm91cCBhZGRpdGlvbnMgdGhhdCBhcmUgaW1tZWRpYXRlbHkgYWZ0ZXIgc3VidHJhY3Rpb25zIGFuZCB0cmVhdCB0aGVtIGFzIG9uZSBcImF0b21pY1wiIG1vZGlmeSBjaGFuZ2UuXG4gICAgaWYgKG9wZXJhdGlvbiA9PT0gJy0nICYmIGxpbmVbMF0gPT09ICcrJykge1xuICAgICAgb3BlcmF0aW9uID0gJysnO1xuICAgIH1cbiAgICBpZiAob3BlcmF0aW9uID09PSBsaW5lWzBdKSB7XG4gICAgICByZXQucHVzaChsaW5lKTtcbiAgICAgIHN0YXRlLmluZGV4Kys7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gY29sbGVjdENvbnRleHQoc3RhdGUsIG1hdGNoQ2hhbmdlcykge1xuICB2YXIgY2hhbmdlcyA9IFtdLFxuICAgIG1lcmdlZCA9IFtdLFxuICAgIG1hdGNoSW5kZXggPSAwLFxuICAgIGNvbnRleHRDaGFuZ2VzID0gZmFsc2UsXG4gICAgY29uZmxpY3RlZCA9IGZhbHNlO1xuICB3aGlsZSAobWF0Y2hJbmRleCA8IG1hdGNoQ2hhbmdlcy5sZW5ndGggJiYgc3RhdGUuaW5kZXggPCBzdGF0ZS5saW5lcy5sZW5ndGgpIHtcbiAgICB2YXIgY2hhbmdlID0gc3RhdGUubGluZXNbc3RhdGUuaW5kZXhdLFxuICAgICAgbWF0Y2ggPSBtYXRjaENoYW5nZXNbbWF0Y2hJbmRleF07XG5cbiAgICAvLyBPbmNlIHdlJ3ZlIGhpdCBvdXIgYWRkLCB0aGVuIHdlIGFyZSBkb25lXG4gICAgaWYgKG1hdGNoWzBdID09PSAnKycpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjb250ZXh0Q2hhbmdlcyA9IGNvbnRleHRDaGFuZ2VzIHx8IGNoYW5nZVswXSAhPT0gJyAnO1xuICAgIG1lcmdlZC5wdXNoKG1hdGNoKTtcbiAgICBtYXRjaEluZGV4Kys7XG5cbiAgICAvLyBDb25zdW1lIGFueSBhZGRpdGlvbnMgaW4gdGhlIG90aGVyIGJsb2NrIGFzIGEgY29uZmxpY3QgdG8gYXR0ZW1wdFxuICAgIC8vIHRvIHB1bGwgaW4gdGhlIHJlbWFpbmluZyBjb250ZXh0IGFmdGVyIHRoaXNcbiAgICBpZiAoY2hhbmdlWzBdID09PSAnKycpIHtcbiAgICAgIGNvbmZsaWN0ZWQgPSB0cnVlO1xuICAgICAgd2hpbGUgKGNoYW5nZVswXSA9PT0gJysnKSB7XG4gICAgICAgIGNoYW5nZXMucHVzaChjaGFuZ2UpO1xuICAgICAgICBjaGFuZ2UgPSBzdGF0ZS5saW5lc1srK3N0YXRlLmluZGV4XTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1hdGNoLnN1YnN0cigxKSA9PT0gY2hhbmdlLnN1YnN0cigxKSkge1xuICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgaWYgKChtYXRjaENoYW5nZXNbbWF0Y2hJbmRleF0gfHwgJycpWzBdID09PSAnKycgJiYgY29udGV4dENoYW5nZXMpIHtcbiAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgfVxuICBpZiAoY29uZmxpY3RlZCkge1xuICAgIHJldHVybiBjaGFuZ2VzO1xuICB9XG4gIHdoaWxlIChtYXRjaEluZGV4IDwgbWF0Y2hDaGFuZ2VzLmxlbmd0aCkge1xuICAgIG1lcmdlZC5wdXNoKG1hdGNoQ2hhbmdlc1ttYXRjaEluZGV4KytdKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIG1lcmdlZDogbWVyZ2VkLFxuICAgIGNoYW5nZXM6IGNoYW5nZXNcbiAgfTtcbn1cbmZ1bmN0aW9uIGFsbFJlbW92ZXMoY2hhbmdlcykge1xuICByZXR1cm4gY2hhbmdlcy5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGNoYW5nZSkge1xuICAgIHJldHVybiBwcmV2ICYmIGNoYW5nZVswXSA9PT0gJy0nO1xuICB9LCB0cnVlKTtcbn1cbmZ1bmN0aW9uIHNraXBSZW1vdmVTdXBlcnNldChzdGF0ZSwgcmVtb3ZlQ2hhbmdlcywgZGVsdGEpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWx0YTsgaSsrKSB7XG4gICAgdmFyIGNoYW5nZUNvbnRlbnQgPSByZW1vdmVDaGFuZ2VzW3JlbW92ZUNoYW5nZXMubGVuZ3RoIC0gZGVsdGEgKyBpXS5zdWJzdHIoMSk7XG4gICAgaWYgKHN0YXRlLmxpbmVzW3N0YXRlLmluZGV4ICsgaV0gIT09ICcgJyArIGNoYW5nZUNvbnRlbnQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgc3RhdGUuaW5kZXggKz0gZGVsdGE7XG4gIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lcykge1xuICB2YXIgb2xkTGluZXMgPSAwO1xuICB2YXIgbmV3TGluZXMgPSAwO1xuICBsaW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgaWYgKHR5cGVvZiBsaW5lICE9PSAnc3RyaW5nJykge1xuICAgICAgdmFyIG15Q291bnQgPSBjYWxjT2xkTmV3TGluZUNvdW50KGxpbmUubWluZSk7XG4gICAgICB2YXIgdGhlaXJDb3VudCA9IGNhbGNPbGROZXdMaW5lQ291bnQobGluZS50aGVpcnMpO1xuICAgICAgaWYgKG9sZExpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKG15Q291bnQub2xkTGluZXMgPT09IHRoZWlyQ291bnQub2xkTGluZXMpIHtcbiAgICAgICAgICBvbGRMaW5lcyArPSBteUNvdW50Lm9sZExpbmVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZExpbmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAobmV3TGluZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAobXlDb3VudC5uZXdMaW5lcyA9PT0gdGhlaXJDb3VudC5uZXdMaW5lcykge1xuICAgICAgICAgIG5ld0xpbmVzICs9IG15Q291bnQubmV3TGluZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3TGluZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG5ld0xpbmVzICE9PSB1bmRlZmluZWQgJiYgKGxpbmVbMF0gPT09ICcrJyB8fCBsaW5lWzBdID09PSAnICcpKSB7XG4gICAgICAgIG5ld0xpbmVzKys7XG4gICAgICB9XG4gICAgICBpZiAob2xkTGluZXMgIT09IHVuZGVmaW5lZCAmJiAobGluZVswXSA9PT0gJy0nIHx8IGxpbmVbMF0gPT09ICcgJykpIHtcbiAgICAgICAgb2xkTGluZXMrKztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIG9sZExpbmVzOiBvbGRMaW5lcyxcbiAgICBuZXdMaW5lczogbmV3TGluZXNcbiAgfTtcbn1cblxuZnVuY3Rpb24gcmV2ZXJzZVBhdGNoKHN0cnVjdHVyZWRQYXRjaCkge1xuICBpZiAoQXJyYXkuaXNBcnJheShzdHJ1Y3R1cmVkUGF0Y2gpKSB7XG4gICAgcmV0dXJuIHN0cnVjdHVyZWRQYXRjaC5tYXAocmV2ZXJzZVBhdGNoKS5yZXZlcnNlKCk7XG4gIH1cbiAgcmV0dXJuIF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCBzdHJ1Y3R1cmVkUGF0Y2gpLCB7fSwge1xuICAgIG9sZEZpbGVOYW1lOiBzdHJ1Y3R1cmVkUGF0Y2gubmV3RmlsZU5hbWUsXG4gICAgb2xkSGVhZGVyOiBzdHJ1Y3R1cmVkUGF0Y2gubmV3SGVhZGVyLFxuICAgIG5ld0ZpbGVOYW1lOiBzdHJ1Y3R1cmVkUGF0Y2gub2xkRmlsZU5hbWUsXG4gICAgbmV3SGVhZGVyOiBzdHJ1Y3R1cmVkUGF0Y2gub2xkSGVhZGVyLFxuICAgIGh1bmtzOiBzdHJ1Y3R1cmVkUGF0Y2guaHVua3MubWFwKGZ1bmN0aW9uIChodW5rKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvbGRMaW5lczogaHVuay5uZXdMaW5lcyxcbiAgICAgICAgb2xkU3RhcnQ6IGh1bmsubmV3U3RhcnQsXG4gICAgICAgIG5ld0xpbmVzOiBodW5rLm9sZExpbmVzLFxuICAgICAgICBuZXdTdGFydDogaHVuay5vbGRTdGFydCxcbiAgICAgICAgbGluZXM6IGh1bmsubGluZXMubWFwKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgaWYgKGwuc3RhcnRzV2l0aCgnLScpKSB7XG4gICAgICAgICAgICByZXR1cm4gXCIrXCIuY29uY2F0KGwuc2xpY2UoMSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobC5zdGFydHNXaXRoKCcrJykpIHtcbiAgICAgICAgICAgIHJldHVybiBcIi1cIi5jb25jYXQobC5zbGljZSgxKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsO1xuICAgICAgICB9KVxuICAgICAgfTtcbiAgICB9KVxuICB9KTtcbn1cblxuLy8gU2VlOiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2gvd2lraS9BUElcbmZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9ETVAoY2hhbmdlcykge1xuICB2YXIgcmV0ID0gW10sXG4gICAgY2hhbmdlLFxuICAgIG9wZXJhdGlvbjtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgY2hhbmdlID0gY2hhbmdlc1tpXTtcbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICBvcGVyYXRpb24gPSAxO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLnJlbW92ZWQpIHtcbiAgICAgIG9wZXJhdGlvbiA9IC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcGVyYXRpb24gPSAwO1xuICAgIH1cbiAgICByZXQucHVzaChbb3BlcmF0aW9uLCBjaGFuZ2UudmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBjb252ZXJ0Q2hhbmdlc1RvWE1MKGNoYW5nZXMpIHtcbiAgdmFyIHJldCA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgY2hhbmdlID0gY2hhbmdlc1tpXTtcbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICByZXQucHVzaCgnPGlucz4nKTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZS5yZW1vdmVkKSB7XG4gICAgICByZXQucHVzaCgnPGRlbD4nKTtcbiAgICB9XG4gICAgcmV0LnB1c2goZXNjYXBlSFRNTChjaGFuZ2UudmFsdWUpKTtcbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICByZXQucHVzaCgnPC9pbnM+Jyk7XG4gICAgfSBlbHNlIGlmIChjaGFuZ2UucmVtb3ZlZCkge1xuICAgICAgcmV0LnB1c2goJzwvZGVsPicpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0LmpvaW4oJycpO1xufVxuZnVuY3Rpb24gZXNjYXBlSFRNTChzKSB7XG4gIHZhciBuID0gcztcbiAgbiA9IG4ucmVwbGFjZSgvJi9nLCAnJmFtcDsnKTtcbiAgbiA9IG4ucmVwbGFjZSgvPC9nLCAnJmx0OycpO1xuICBuID0gbi5yZXBsYWNlKC8+L2csICcmZ3Q7Jyk7XG4gIG4gPSBuLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKTtcbiAgcmV0dXJuIG47XG59XG5cbmV4cG9ydCB7IERpZmYsIGFwcGx5UGF0Y2gsIGFwcGx5UGF0Y2hlcywgY2Fub25pY2FsaXplLCBjb252ZXJ0Q2hhbmdlc1RvRE1QLCBjb252ZXJ0Q2hhbmdlc1RvWE1MLCBjcmVhdGVQYXRjaCwgY3JlYXRlVHdvRmlsZXNQYXRjaCwgZGlmZkFycmF5cywgZGlmZkNoYXJzLCBkaWZmQ3NzLCBkaWZmSnNvbiwgZGlmZkxpbmVzLCBkaWZmU2VudGVuY2VzLCBkaWZmVHJpbW1lZExpbmVzLCBkaWZmV29yZHMsIGRpZmZXb3Jkc1dpdGhTcGFjZSwgZm9ybWF0UGF0Y2gsIG1lcmdlLCBwYXJzZVBhdGNoLCByZXZlcnNlUGF0Y2gsIHN0cnVjdHVyZWRQYXRjaCB9O1xuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUE2SDs7O0FDQTdILHNCQUE0QztBQUVyQyxJQUFNLFlBQVksQ0FBQyxLQUFhLFNBQWlCLGVBQStGO0FBQ3JKLFFBQU0sT0FBTyxLQUFLLFVBQVU7QUFBQSxJQUMxQixXQUFXO0FBQUEsSUFDWCxtQkFBbUIsV0FBVztBQUFBLElBQzlCLHFCQUFxQixXQUFXO0FBQUEsSUFDaEMsa0JB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T0FBTyxVQUFVO0FBQzFCLFdBQUssT0FBTyxTQUFTLG9CQUFvQjtBQUN6QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDaEMsQ0FBQyxDQUFDO0FBRUwsUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEsZ0JBQWdCLEVBQ3hCLFFBQVEsMEJBQU0sRUFDZCxZQUFZLGNBQ1osU0FDRSxXQUFXO0FBQUEsTUFDWCxTQUFTO0FBQUEsTUFDVCxhQUFhO0FBQUEsTUFDYixTQUFTO0FBQUEsSUFDVixDQUFDLEVBQ0EsU0FBUyxLQUFLLE9BQU8sU0FBUyxxQkFBcUIsT0FBTyxFQUMxRCxTQUFTLE9BQU8sVUFBVTtBQUMxQixXQUFLLE9BQU8sU0FBUyxvQkFBb0I7QUFDekMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ2hDLENBQUMsQ0FBQztBQUFBLEVBQ047QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImRpZmYiLCAidmFsdWUiLCAibyIsICJub3RlSWQiLCAiYnRuIl0KfQo=
